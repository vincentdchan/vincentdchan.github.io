{"data":{"markdownRemark":{"html":"<p>上文中，提到如果解析一个数学表达式，并把它变成一棵树，我们把这个程序称为解释器，这次我要为这个解释器加一个功能：赋值操作</p>\n<pre><code class=\"language-javascript\">let a = 3 * 4\n</code></pre>\n<p>这里我们要区分左值(left-value)和右值（right-value) 右值是临时结果，而左值是一个变量。至于右面是一个表达式，表达式如何解析在上一篇文章已经详细说了，所以这里就不多说。</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ebf402bbe50f54bc85cfda5122c0d625/115c7/parseLet.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 483px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 87.37060041407868%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACn0lEQVQ4y2NgQANv374F02fOnIGL/f//n2HOnDlg9q1btxhIBsiGzZgxQwTGXrBgAemGHT58GM5++PDh0s+fP/+/fft2A9SljHv37iXeMENDQ4ZLly4xgtjLli2T+vnz538QePPmzVOgEFj8woULYLVGRka4DQJJggwDgdLSUnCYgcCNGzf6nz59+hloSC4sLD08PBjCw8MZ2trawGpaWlrgesFg6dKlyN5lgrEVFBT4gBSflJQUP5DmNTY2FtLW1maDeR2ImSZPngxWizUYfv/+DTOM2dnZWQpoKy9yLOvq6rJbWlqKgixB1tfV1YVqkKKiItyLGzdutCsuLoa7n4uLi6G9vZ0xOTkZrn727NkqwKDY9ODBgw5bW1uwi5csWcKAksZAABgZxT9+/Pj/6dOnJ/v27bMDiX358oUxKysLHMbv3r1jAYk9evRo2n8oAOoJB4ldv36dGcPAa9euNf779+//hw8fPh88eNALJPb371/GmpoacKADEzxY082bN9NBhgEt/nj06FETkNi5c+eY4LGemJgIN/zQoUNu69evV4NaxIQcNFZWVoww9syZM0MmTJhgC81ZcHFPT08Ur8MNeP78OTOy6/fs2cMEYru7u3NYWFhIQpWxOjk5iYHEv379irB81apVcDbQ20ynT58G2/jt2zew2N27d+EuEBUVFZ40aRITzCIdHR1QSmCBJSWUhA2jkXPA/fv3wTYDw1QfmLjn9vb2gpINw6JFi+CRAAy/vlOnTgViGIoOgIaADVu+fLkxMJzAefDZs2c3gEkIXlgAS56NsBgHhn8s3ny9fft2MB0UFMQOdGk7MNm8AgZJMrJLTp486QTM53eB2XM1sCQSJ1hYrFy5Es4GukwYxtbU1IRHWEREBD+S9xkBv6xm4ZI7NxcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"parseLet\"\n        title=\"\"\n        src=\"/static/ebf402bbe50f54bc85cfda5122c0d625/115c7/parseLet.png\"\n        srcset=\"/static/ebf402bbe50f54bc85cfda5122c0d625/aa027/parseLet.png 175w,\n/static/ebf402bbe50f54bc85cfda5122c0d625/e4a2b/parseLet.png 350w,\n/static/ebf402bbe50f54bc85cfda5122c0d625/115c7/parseLet.png 483w\"\n        sizes=\"(max-width: 483px) 100vw, 483px\"\n      />\n  </span>\n  </a></p>\n<p>解析（parsing)后，得到的是这样一棵树，那么我们要如何实现赋值(Assign)操作呢？</p>\n<p>在这里我们使用Environment实现，我们只需要一个map哈希表就可以了</p>\n<p>把3 + 4计算的结果放到a里面就行了，eval函数里面可以这样写：</p>\n<!-- HTML generated using hilite.me -->\n<div style=\"background: #ffffff; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;\">\n<pre style=\"margin: 0; line-height: 125%;\">\t\t<span style=\"color: #008800; font-weight: bold;\">else</span> <span style=\"color: #0066bb; font-weight: bold;\">if</span> (root<span style=\"color: #333333;\">-&gt;</span>asAssignment())\n\t\t{\n\t\t\t<span style=\"color: #008800; font-weight: bold;\">auto</span> _node <span style=\"color: #333333;\">=</span> root<span style=\"color: #333333;\">-&gt;</span>asAssignment();\n\t\t\tenv.setValue(_node<span style=\"color: #333333;\">-&gt;</span>Identifier(), _node<span style=\"color: #333333;\">-&gt;</span>Expression());\n\t\t\t<span style=\"color: #008800; font-weight: bold;\">return</span> <span style=\"color: #0000dd; font-weight: bold;\">0</span>;\n\t\t\n</pre>\n</div>\n&nbsp;\n<p>这里的env里面其实是一个Map而已。</p>\n<p>在这里附上这个程序的源码：<a href=\"https://github.com/vincentdchan/CalculatorParser\">https://github.com/vincentdchan/CalculatorParser</a></p>","frontmatter":{"date":"2016-07-14T11:04:00.000Z","path":null,"title":"编译原理学习笔记 2：赋值操作","permalink":"assign-operation","headerImage":null}},"headerImage":null},"pageContext":{"title":"编译原理学习笔记 2：赋值操作","headerImage":null}}