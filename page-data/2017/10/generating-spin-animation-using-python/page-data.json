{"componentChunkName":"component---src-templates-blog-template-js","path":"/2017/10/generating-spin-animation-using-python","result":{"data":{"markdownRemark":{"html":"<p>在写一个小游戏过程中，打算做一个饼状旋转的动画，于是打算用 Python 来生成这个动画，假设我们有这样一张图片</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 128px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/38af76d5aae29e7a83399b6046f7f4d3/750d2/red-circle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAACi0lEQVQ4y6VUz0uUURS9M9FCWor9GKeGoqISomgsMJGaydFmmpxCVKKxNhqm6KKFVAt3bQJdVPsIWtXCKWhRlLUOok0tWvUHZLUqasZ7uue+mVJBbHRx4eN77x3uufecI5gaEkxPCh7MRCAiGGwXnXvSiLH8OAaOPkOh5RP6k7/Rd+Qneg58QPF4CaNnigo04EqXYItE8fa1YPa+4OEdCWD3pqL4Pi8OOHFuDL2H5tG1E0jHrZqBk9usYuGb/7rtrD/5GdeLfUg2CADBq1IEzx9L6IxgwEYMZx6he1d4fGp7GZ07WAtWqlbV77KfpexObg8wUZj2Rgj68Z14V8ofBMskoOnmX+hM8CFBCbK0wj/YnYqBlpUNjBduGXVBVKI+M6dpBwHMH2ERCJaVLr6jqVgFub3AzctZjJw21LlSo8+MNNnZPzCsUg5qo6g4/YHW90bbOuQ2uYAws/8Fw5K76XgF2d2wJWXFpcHNhWFr3YB8U2vmUsddcZ1RDtVt1gH2F9RpE+P8wRfioqXOVl7C6oCZhKKjCXo190PcAbYQXSsgKTvgZphzvorbaZ2Uw/zj0J6Wp+LeXN9SoFyKmcLMMSMYzRfdm2uUjY8qHV9w2dwYbBNPDRo9FQt2qlPYzoxvL7a9oY3FI4ipQaObN+uznjVAhZzdD9y+dsxwxPNMGUGWGm5086brank41L6D3cIiCJbfB528MKK9hwUntm4QD0dGD7tlatDoRkFpJ5urg1MWLAPxBXBmpMnODAybPLUixBFl0lo4KkEZQUwNGp1Ddp+apEy0rjOThm+TZ5yZ0fTOqmD49kU8tpm0DEfmmVoEMTVodHqTdqIDKFrqjNLgNp2RzYw0a2B4OSt/AC5XlvxnHl0iAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"red circle\"\n        title=\"red circle\"\n        src=\"/static/38af76d5aae29e7a83399b6046f7f4d3/750d2/red-circle.png\"\n        srcset=\"/static/38af76d5aae29e7a83399b6046f7f4d3/750d2/red-circle.png 128w\"\n        sizes=\"(max-width: 128px) 100vw, 128px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>最后生成的动画是这个样子的</p>\n<p><img src=\"/images/red-ani2.gif\"></p>\n<p>当然，中间会生成很多帧的动画</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/41eb5fcf99a8e3f6b23642b5889142e3/712f7/red-circle2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.71428571428571%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABYlAAAWJQFJUiTwAAACVklEQVQozxWRW0hTcRzHDxRE7z0E66WXohcJk+gpiAVBYD5ESiAFEthFogeLSAi8hIqCJZKubeTKWcPN266K1nKBOaXmlmzGmtO527ns7Jyz0zn/c/t1ztuXL7+Hz/fzw8BthYbjstumjTwHs0kO+6CzWb1nVtYC0NKgDj9VfFPQXK+4rdpEL9y/Jq8FtBd3oKedjG9hYB+Ak5hsH9S67sJpTPI74Va9ajYpyzNw/qjScUN1TcAZTBnt0gafQN0Red6htV2BqyY8GsH4Up6wDbO5LJOMk+9HOI5jwn5ixs4jVHFZ6XCA51jC0s+k4rX9NPm2t0YR1fUv1ORIuVjE5MSmGAnxgsiE5krxLZJDUtD1j8IloogCnwQAKflL/Loo6iESEpIxBIAWPyK8gLMcBrZ+uHBM+GxBz1rBfIpdWoDWS+rD68rKLFw+oVr61OkxI4S9Wne7Pl5OxeD2RXjZVinmMR4vUpZ+Ov3nILGTedN3WCDooLvsGK0Joo5dCc1yDEO9G6jGouxBhhzrYfK5anSNtA4xFInJsXXxx6qOJ4Y8e7HNRDa3R1WLAHK5gHxOnRbt/BRXFwzsb34htW008w6xdFiTFQzGu6HxrJLPwuMmqaOR2t/jux/IXqe6s2XQHmZU1zjcrFMBtM4WePVIAYCmc7Di4QEwDi+R1kE69buaTlG2oRpdYZbniOkJVkSUZ5KOLLEsS06+rqR3uf2/hHOcYbnqRhgPehhB1G1HUSRoUC25UTJmBO+UoNumKWnhg+5W2o2jZbfey99D4vaGcaD3+az+lv+0hc/XeLV3MAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"red circle2\"\n        title=\"red circle2\"\n        src=\"/static/41eb5fcf99a8e3f6b23642b5889142e3/8c557/red-circle2.png\"\n        srcset=\"/static/41eb5fcf99a8e3f6b23642b5889142e3/4edbd/red-circle2.png 175w,\n/static/41eb5fcf99a8e3f6b23642b5889142e3/13ae7/red-circle2.png 350w,\n/static/41eb5fcf99a8e3f6b23642b5889142e3/8c557/red-circle2.png 700w,\n/static/41eb5fcf99a8e3f6b23642b5889142e3/e996b/red-circle2.png 1050w,\n/static/41eb5fcf99a8e3f6b23642b5889142e3/712f7/red-circle2.png 1181w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>怎么去生成每一帧动画呢？其实关键就在于挖去一个饼状图形里面的像素</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 128px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a236b82cf5500f6f0b887cbfd78a486d/750d2/red-ani3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADKUlEQVQ4y4WUTUhUURTHz4xEyEgEkpbOR0VGZUShKVlJ43xoI+YUYkOpRWBhiS4ipFq4i0DQRbWPIFrUQitaFGrthCDcNItMCoJWWa36cJ7n3zn3vTcfora43Pvevfd3z/mfD8JwL2F0iPBgzAMiQs8R4umnpehvG0Cq7jmSe7+gsybNvdESXAjL/lFC81YPYkFCX4JQQl7MTBHG7xMe3iEbdm/Yi58LZICDJ/vRsX8BzduAiB9oqgSHK+bRuMmHxjJCstqLs4cIqYNVuJbqQk0xASBMTXjw8gnZlikMWIeL8cdo2Q6EK4BoIMOx4KJYAhlziId8Mkj+Fck+Iep/hEQVxIARY4hC0+/IWMX6Q2HxEDhS+Rex0JIBRQNmFshHmX3yTcbVaCBi9psqMsaAgeQtlAvDS16jmXFTNmxYkOUCzBwL2uBYQIElBihDHphxzmQEaqF1J3DzfAJ9x4U6PVFqNFM31bIcTEG2hdHAnMwb5Vst7JXZhtlnLYFCNJ0Vt8VCjaYGQDRz9HJgLtBcmher1st6g6y/OvtL2bMRv4XEDuB6t4Q9VffCRNN+kQuBQRf4SbUT6G22vxezj+sd15hzjXc1DT4gUln4Ym5Yzjwro17gf9RNgeY/zKznlHFq3yvC6dpFhLe4ri4HOhYG0rKedGSwlknDHA+x5Cn4cusvkir4rQHhlYHLNM1Bsv/UZQMsAy41fye073m/hsv5l109eYVHRH8/uL36GaH78MQaQWEnbWQO2GtnzguK7me0KKQ4xghX2rrRslra/HewkSriXzJpc6OngRgolsB8NskZC1mFib02LK9agK6GN1rGJEKSJGQnWqvs2iwsvdU0dc6IAZohJ3YDI1frhSPAcvJyrbSgweQoa6FLbbKbfzlNObs2eegEQmFtu8BDZ/q44wDh2OYiwtvXdutRa7VraKGLC6zlZLcwy6SFDoGYAKhm6qZaJjD4TNfyKIdYO600R1aotiDtGlroKrKpU0kpSVqTZ5IaJpq6p5qJm8YyB4Yf38i0be202hy1n7G0IO0aWuham1pOWgGatJpnmhoaTeORaKZuujBMjtM/yXB6NXqay7AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"red ani3\"\n        title=\"red ani3\"\n        src=\"/static/a236b82cf5500f6f0b887cbfd78a486d/750d2/red-ani3.png\"\n        srcset=\"/static/a236b82cf5500f6f0b887cbfd78a486d/750d2/red-ani3.png 128w\"\n        sizes=\"(max-width: 128px) 100vw, 128px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>那我们只要遍历这张图片的所有元素，然后挖去在这个饼状范围内的像素即可，从这个思路出发，我们可以很容易想到使用极坐标。假设我们有两条极坐标空间里面的直线 <code class=\"language-text\">p = Theta1</code> 和 <code class=\"language-text\">p = Theta2</code> 那我们只要把这两条直线中间的像素挖掉即可。当我们遍历所有元素的时候，我们需要判断这个像素点在极坐标空间中的位置。当然，我们坐标的圆心是整个图片的中心，所以对于每个像素点，我们要减去整张图片中点坐标，求出的相对坐标再作 atan2 计算。</p>\n<p><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/86ad33236e019c6a82a8dd674f266fb70f51ac57\"></p>\n<p>用 math.atan2 求出 theta 之后若在 theta1 和 theta2 之内，则删去即可，所以说核心代码其实很简单：</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>SIZE<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">for</span> y <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>SIZE<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            relative_point <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">-</span> CENTER_POINT<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">-</span> CENTER_POINT<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            theta <span class=\"token operator\">=</span> math<span class=\"token punctuation\">.</span>atan2<span class=\"token punctuation\">(</span>relative_point<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> relative_point<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n            theta <span class=\"token operator\">=</span> theta <span class=\"token operator\">*</span> <span class=\"token number\">180</span> <span class=\"token operator\">/</span> math<span class=\"token punctuation\">.</span>pi <span class=\"token operator\">+</span> <span class=\"token number\">180</span>\n\n            <span class=\"token keyword\">if</span> theta <span class=\"token operator\">>=</span> theta1 <span class=\"token keyword\">and</span> theta <span class=\"token operator\">&lt;</span> theta2<span class=\"token punctuation\">:</span>\n                draw <span class=\"token operator\">=</span> ImageDraw<span class=\"token punctuation\">.</span>Draw<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> <span class=\"token string\">'RGBA'</span><span class=\"token punctuation\">)</span>\n                draw<span class=\"token punctuation\">.</span>point<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\"># write null pixel</span></code></pre></div>\n<p>最后附上源码 gist 地址:\n<a href=\"https://gist.github.com/vincentdchan/e120f3cacf88efbba3e51fa1b0084086\">https://gist.github.com/vincentdchan/e120f3cacf88efbba3e51fa1b0084086</a></p>","excerpt":"在写一个小游戏过程中，打算做一个饼状旋转的动画，于是打算用 Python 来生成这个动画，假设我们有这样一张图片  最后生成的动画是这个样子的  当然，中间会生成很多帧的动画  怎么去生成每一帧动画呢？其实关键就在于挖去一个饼状图形里面的像素  那我们只要遍历这张图片的所有元素，然后挖去在这个饼状范围内的像素即可，从…","frontmatter":{"date":"2017-10-29T01:53:48.000Z","path":null,"title":"用 Python 生成饼状旋转动画","permalink":"generating-spin-animation-using-python","headerImage":null,"tags":["python","pie animation"]}}},"pageContext":{"title":"用 Python 生成饼状旋转动画"}},"staticQueryHashes":["3128451518","3159585216","3649515864"]}