{"componentChunkName":"component---src-templates-blog-template-js","path":"/2016/07/assign-operation","result":{"data":{"markdownRemark":{"html":"<p>上文中，提到如果解析一个数学表达式，并把它变成一棵树，我们把这个程序称为解释器，这次我要为这个解释器加一个功能：赋值操作</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> a <span class=\"token operator\">=</span> <span class=\"token number\">3</span> <span class=\"token operator\">*</span> <span class=\"token number\">4</span></code></pre></div>\n<p>这里我们要区分左值(left-value)和右值（right-value) 右值是临时结果，而左值是一个变量。至于右面是一个表达式，表达式如何解析在上一篇文章已经详细说了，所以这里就不多说。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 483px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ebf402bbe50f54bc85cfda5122c0d625/77a9e/parseLet.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 87.42857142857143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADFklEQVQ4y5WUX0jaURTHz/3ZNpFCNsakjYEPPaxNRgqNXjIY/WUvET7ECITBHnrZwx6C6CUNBUcseimioIKI/sAaQvRvoyhC+2N/0MpKo7CSMiVKKjP47ZyLP1uDYl24eL2e87nnfr/nCvDPEEURfD4feL1e1tLSAh6PB2w2G7hcLlhYWOC/32ucn5/DxsYGI1BjY2Pa3NxcrslkUiSA7N7Aqakpacn29vZ+nZ2diYFAYIBANB0Ox//DtFotv1pTUxNUVVWlHR8fRxEiRiKRYHFxsby6uhpmZmZAp9PxeeuQAghYWFjIKyEwVvsJr+8aHx//GAqFeKxCoYCKigpWU1MDVqsVLBYLz7thQnl5OWRlZcHu7q5AexkZGbLs7OynuJQnNHuUk5PzTKPRpHZ0dAhS3sjICBsbG4P19fVrIEJAJpNRAEOtaEuWn5+fnpmZKU8kMvpUKpUsLy9PSUucqQQk2OjoKMOOuAaim4IkuNPpNPb39xuCwSAkIPw6JAeBW1tbCfIGD/YcHBz8xtjndrsdJicnWRLY3d3NYW63+1ssFhMvLi5EBH9OHCJUVlZy4MnJScrl5SVsb29/J6Ourq5ErOzL5uYm9W1K0iRqXkqen58vDYfDqH3IOzEx8Q4TeFW1tbW8Sr/fLyAMlpaW9BgXPjo62kLTXmMeLC4uMslULiwBSb/29vaX2MSPV1dXOYz26+vr+cFqtTppotFofGswGF5JUtHAtoKysjKAoaEhvolNLENNoKGhARAo/B2MVXBnS0pK0vR6fTrF4BDQvBeJg5nZbGbNzc0APT09PDEajcL09DTDnmMrKys3+pTeMI6H5C4t8LVIJtCnkvJJOpq3jt7e3uS1UbcPqJ9zdnY2d39/H/BAAU2Evr6+J6jtABpjpXa78xkODw8LnZ2d0NbWpkGj4uTs4eFhpK6uTl1QUMBvtba29iMej/POwCf59c4/DnrPko7Ly8ulWJkDK3xP309PTwVyt6urS4Vm/sQqbSqV6kFRUdHtQBJYLuePBbBLOHhnZyfpNF6ZDQ4OJg+leOwS+ANyQhT/y43AAAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"parseLet\"\n        title=\"parseLet\"\n        src=\"/static/ebf402bbe50f54bc85cfda5122c0d625/77a9e/parseLet.png\"\n        srcset=\"/static/ebf402bbe50f54bc85cfda5122c0d625/4edbd/parseLet.png 175w,\n/static/ebf402bbe50f54bc85cfda5122c0d625/13ae7/parseLet.png 350w,\n/static/ebf402bbe50f54bc85cfda5122c0d625/77a9e/parseLet.png 483w\"\n        sizes=\"(max-width: 483px) 100vw, 483px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>解析（parsing)后，得到的是这样一棵树，那么我们要如何实现赋值(Assign)操作呢？</p>\n<p>在这里我们使用Environment实现，我们只需要一个map哈希表就可以了</p>\n<p>把3 + 4计算的结果放到a里面就行了，eval函数里面可以这样写：</p>\n<!-- HTML generated using hilite.me -->\n<div style=\"background: #ffffff; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;\">\n<pre style=\"margin: 0; line-height: 125%;\">\t\t<span style=\"color: #008800; font-weight: bold;\">else</span> <span style=\"color: #0066bb; font-weight: bold;\">if</span> (root<span style=\"color: #333333;\">-&gt;</span>asAssignment())\n\t\t{\n\t\t\t<span style=\"color: #008800; font-weight: bold;\">auto</span> _node <span style=\"color: #333333;\">=</span> root<span style=\"color: #333333;\">-&gt;</span>asAssignment();\n\t\t\tenv.setValue(_node<span style=\"color: #333333;\">-&gt;</span>Identifier(), _node<span style=\"color: #333333;\">-&gt;</span>Expression());\n\t\t\t<span style=\"color: #008800; font-weight: bold;\">return</span> <span style=\"color: #0000dd; font-weight: bold;\">0</span>;\n\t\t\n</pre>\n</div>\n&nbsp;\n<p>这里的env里面其实是一个Map而已。</p>\n<p>在这里附上这个程序的源码：<a href=\"https://github.com/vincentdchan/CalculatorParser\">https://github.com/vincentdchan/CalculatorParser</a></p>","frontmatter":{"date":"2016-07-14T11:04:00.000Z","path":null,"title":"编译原理学习笔记 2：赋值操作","permalink":"assign-operation","headerImage":null,"tags":["compiler"]}}},"pageContext":{"title":"编译原理学习笔记 2：赋值操作"}},"staticQueryHashes":["3128451518","3159585216","3649515864"]}