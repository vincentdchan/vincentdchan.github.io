<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Vincent Chan çš„å·´å£«ç«™ ğŸš‰]]></title><description><![CDATA[Vincent Chan's Bus Station. Blog of Vincent.]]></description><link>https://diverse.space</link><generator>RSS for Node</generator><lastBuildDate>Tue, 27 Aug 2019 16:46:57 GMT</lastBuildDate><item><title><![CDATA[QuickJS æºç è§£è¯»ï¼ˆä¸€ï¼‰]]></title><link>https://diverse.space/2019/08/understanding-source-code-of-quickjs-1</link><guid isPermaLink="false">https://diverse.space/2019/08/understanding-source-code-of-quickjs-1</guid><pubDate>Mon, 26 Aug 2019 23:55:00 GMT</pubDate><content:encoded>&lt;h2&gt;ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;Quick JS æ˜¯ Fabrice Bellard ä»Šå¹´å‘å¸ƒçš„ä¸€æ¬¾ JavaScript å¼•æ“ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è½»é‡è€Œä¸”æ˜“äºåµŒå…¥ï¼šåªéœ€å‡ ä¸ªCæ–‡ä»¶ï¼Œæ²¡æœ‰å¤–éƒ¨ä¾èµ–ï¼Œä¸€ä¸ªx86ä¸‹çš„ç®€å•çš„â€œhello worldâ€ç¨‹åºåªè¦180 KiBã€‚&lt;/li&gt;
&lt;li&gt;å…·æœ‰æä½å¯åŠ¨æ—¶é—´çš„å¿«é€Ÿè§£é‡Šå™¨ï¼š åœ¨ä¸€å°å•æ ¸çš„å°å¼PCä¸Šï¼Œå¤§çº¦åœ¨100ç§’å†…è¿è¡ŒECMAScript æµ‹è¯•å¥—ä»¶1Â 56000æ¬¡ã€‚è¿è¡Œæ—¶å®ä¾‹çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸåœ¨ä¸åˆ°300å¾®ç§’çš„æ—¶é—´å†…å®Œæˆã€‚&lt;/li&gt;
&lt;li&gt;å‡ ä¹å®Œæ•´å®ç°ES2019æ”¯æŒï¼ŒåŒ…æ‹¬ï¼š æ¨¡å—ï¼Œå¼‚æ­¥ç”Ÿæˆå™¨å’Œå’Œå®Œæ•´Annex Bæ”¯æŒ (ä¼ ç»Ÿçš„Webå…¼å®¹æ€§)ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡100ï¼…çš„ECMAScript Test Suiteæµ‹è¯•ã€‚&lt;/li&gt;
&lt;li&gt;å¯ä»¥å°†Javascriptæºç¼–è¯‘ä¸ºæ²¡æœ‰å¤–éƒ¨ä¾èµ–çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å¼•ç”¨è®¡æ•°ï¼ˆä»¥å‡å°‘å†…å­˜ä½¿ç”¨å¹¶å…·æœ‰ç¡®å®šæ€§è¡Œä¸ºï¼‰çš„åƒåœ¾æ”¶é›†ä¸å¾ªç¯åˆ é™¤ã€‚&lt;/li&gt;
&lt;li&gt;æ•°å­¦æ‰©å±•ï¼šBigInt, BigFloat, è¿ç®—ç¬¦é‡è½½, bigintæ¨¡å¼, mathæ¨¡å¼.&lt;/li&gt;
&lt;li&gt;åœ¨Javascriptä¸­å®ç°çš„å…·æœ‰ä¸Šä¸‹æ–‡ç€è‰²å’Œå®Œæˆçš„å‘½ä»¤è¡Œè§£é‡Šå™¨ã€‚&lt;/li&gt;
&lt;li&gt;é‡‡ç”¨CåŒ…è£…åº“æ„å»ºçš„å†…ç½®æ ‡å‡†åº“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦è®°å½•æˆ‘é˜…è¯» QuickJS æºç æ—¶è®°å½•çš„ä¸€äº›å¿ƒå¾—ï¼Œä¸»è¦ç”¨äºå­¦ä¹ ç”¨é€”ã€‚&lt;/p&gt;
&lt;h2&gt;ç¼–è¯‘&lt;/h2&gt;
&lt;p&gt;æºç ä¸‹è½½åœ°å€ï¼š&lt;a href=&quot;https://bellard.org/quickjs/&quot;&gt;https://bellard.org/quickjs/&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;ç¼–è¯‘ qjs å¼•æ“æœ¬èº«&lt;/h3&gt;
&lt;p&gt;qjs æœ¬èº«ç”¨äºç›´æ¥æ‰§è¡Œ JavaScript ä»£ç ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ make qjs
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;ç¼–è¯‘ qjsc ç¼–è¯‘å™¨&lt;/h3&gt;
&lt;p&gt;qjsc ç¼–è¯‘å™¨å¯ä»¥æŠŠ JavaScript ä»£ç ç¼–è¯‘æˆ QuickJS è™šæ‹Ÿæœºçš„å­—èŠ‚ç ï¼ˆå¯ç›´æ¥é€šè¿‡ QuickJs è™šæ‹Ÿæœºæ‰§è¡Œï¼‰ã€‚ ä¹Ÿå¯ä»¥æŠŠ JavaScript ä»£ç ç¼–è¯‘æˆä¸€ä¸ª C è¯­è¨€çš„ .c æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†å­—èŠ‚ç ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/e55cbce2ab1591c58a3346e75b42ca95/a79cf/qjs-bytecodes.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 79.79214780600462%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADZUlEQVQ4y6VTzW8bRRRfCfXIAW0PyHAokNjOej9mv2dnZr1r78Z2vE7atAIJIfXSE1ckDvRQVXy01E1oYsqXSqoUCYTEga4Efwn/AJIlroAPHGq8jzcb0UbkyEo/vY+Z+c17vzer/HLt+Lm3dpKe3WfbxGZjjQSF4bLCdoLCspzC51kR8H7Be6OCJ4OCuFGh27SwA4F7wsIg4dhwoonti8E77753TpnemL6QDYrfSJRCy4wADwNxGbxmx/Cqk4BueqA7EbQNFy60Cax3XNAsH15p6nBBD0Gzab22tkH+uvn+rReV6b1P1W5+aW6HfWha7O+Ab1ZO2KtaJq2aiJbuVS3Dr5odr1rT3KqJcRvjdfTXdR/9YIV7YMMM/tz7ZPaScjD7QhX9SU3Y1r1Vx+1XBh1VHSusdJtXHYJAq9ui0h3pM8wx9DG2peUrjTDw2Obi4Tc/NJTD+1+pvFfMiZ9AS/dXG0YIjpUAQXS8EHSfgo5WcwJs16vRPAU8I6sFh2aLR9/92FA+uv622ptcnQfDa9DUyEpDHR2SgoM6ugEFQijGCIuChXBdKklOoyYkQbr4+vj7hvLxdF9Nh5fnLhvIG1dtrLBjcMDpgWkjMLZMJEPxZfWSZF3zaqxpdZWorw+aGS6m+4cNZf/gMzXOduY4CGhiyzpWkbIUUiEQHBLKocdEHceRAEYZ0CCCEMHRl1pLGTSLLu5Kwg9v76nZ6MrcYzm0jHCFGyAKKSICJkFPIA/HEQOBVpLKtS5joP+XcFYPZTK3cChtk6KGIYR+BDTESvBQgL4klxWd+M8qlPkzFX7+5ZEaJeO56XVhw4pWOg4gi7FNbDfl2DLj0Ec/i0Ud511R+zI3TGOpbSX1fEr44OiRGojh3HBifJxYId6It1e+T6sAgVWcAZXrHq1QhupMy3fuHqj90ZVf3SiThE+whSVqg+DLLufLnhDLlItlgn7MTuLTvkHoE/yDsHX6+969WUO5+cHt86Jf/GHXUw7AcDh0uxkIkQKNYuCsCwwheIo2qfPS0kjm8AdAqTTC6+d0687+y8rRw+Pn+8PtB/no0s9pXjye7L5Z7rx+tcy2dstAZGUYb5ahyMt8fLlMBztlsrlddvNJyXtbpcgKzO8+Hl9846d86+K3h7P7qgIAivyk/T/4l+Mf5HIPuwzWvGQAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;QuickJS æŠŠ JavaScript ç¼–è¯‘æˆå­—èŠ‚ç &quot;
        title=&quot;&quot;
        src=&quot;/static/e55cbce2ab1591c58a3346e75b42ca95/84ad3/qjs-bytecodes.png&quot;
        srcset=&quot;/static/e55cbce2ab1591c58a3346e75b42ca95/687da/qjs-bytecodes.png 175w,
/static/e55cbce2ab1591c58a3346e75b42ca95/0ab4d/qjs-bytecodes.png 350w,
/static/e55cbce2ab1591c58a3346e75b42ca95/84ad3/qjs-bytecodes.png 700w,
/static/e55cbce2ab1591c58a3346e75b42ca95/a79cf/qjs-bytecodes.png 866w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ç¼–è¯‘ qjsc ç¼–è¯‘å™¨é¦–å…ˆéœ€è¦ç¼–è¯‘ libquickjs åº“ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ make libquickjs.a
$ make qjsc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ qjsc ç¼–è¯‘å™¨æŠŠ &lt;code&gt;my_test.js&lt;/code&gt; æ–‡ä»¶ç¼–è¯‘æˆ &lt;code&gt;my_test.c&lt;/code&gt; æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ ./qjsc -e -o my_test.c my_test.js
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;ä½¿ç”¨ XCode è¿›è¡Œ Debug&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ æƒ³å¾ˆæ¸…æ¥šåœ°äº†è§£æ•´ä¸ªè™šæ‹Ÿæœºçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå¯èƒ½ä½ éœ€è¦ XCode æ¥è¿›è¡Œå•æ­¥è°ƒè¯•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d5d570bd15780631e08356203da540ad/2b917/xcode-debug.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 61.1671469740634%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACSklEQVQoz42TyW7UQBCG/UyICxLPAyMlAglxjS95gfiWJ+HIiUOQQCIkmfF4Mpsdr91te7x1293TlWoPSYYTlFQqu13+/Ndiazm9fuN5d5ez2ezC8zzHnaO7U2exmKPfO6v1yvF931mv16Mvl0tnOp06t7e3Dr7jfL+6cq5/31xMvfXlnbt4a93cuR9rISHOW8irDowpyUHwFv7HBOfAWAF7DeD7wWfrfhO8i0gJ6CIh+aD1fmiadpBSDZj/T+ecD4xS0bYNUEpPrK+/wsm3WQ5ffqbqx4JpBEJTN5AkCex2O+BcgBA9cCGg7wfAhGc3Vje1zrJMdagU46m1DdPJfOnDzX2oElaNQIGQ7WYLeV6AUuoA2L9Ajq1t2hHIn4BhnE5oUQLJS4VR17yDMIkh35UwILzfK+iVBHHk5r6TPTCeAy2ppoS+AGOSTxocSkILxcpKG0VZQiAjBLCR2GxUdqRIP0cNSqux5DiOVdM0QAg5tZI/wJSVKqZMZ4xBlmYQRTEQyrDsHIqiGPtZVxW0bQsVXhtAj73F80MPu+5vYMZ26oGm2t3MocQWSFQ3rgUOw8Bc1wXc0xG+Wq1wVdhhKHWtEfRSMgLflw03wN4nsXQ3rozCSGKCIY4Rl1kGQSDxBYkKJS64xBWRxlCpOe+NYownBvhhnFa/h0J0EOXxONFjM18/nnCFpT9VYKzrDj8BAj9ZUZK+SjNyHmf0zNtGdhAFNqPMLneljX2xUYkdRXgeBDY238ZSR0co5tS2HxE7DB/OwjA8x+evHwEh23HvrI2NowAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;ä½¿ç”¨ XCode è¿›è¡Œ Debug&quot;
        title=&quot;&quot;
        src=&quot;/static/d5d570bd15780631e08356203da540ad/84ad3/xcode-debug.png&quot;
        srcset=&quot;/static/d5d570bd15780631e08356203da540ad/687da/xcode-debug.png 175w,
/static/d5d570bd15780631e08356203da540ad/0ab4d/xcode-debug.png 350w,
/static/d5d570bd15780631e08356203da540ad/84ad3/xcode-debug.png 700w,
/static/d5d570bd15780631e08356203da540ad/ef8d3/xcode-debug.png 1050w,
/static/d5d570bd15780631e08356203da540ad/2b917/xcode-debug.png 1388w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºäº†èƒ½åœ¨ XCode ä¸‹è¿›è¡Œè°ƒè¯•ï¼Œä½ å¯èƒ½éœ€è¦å…ˆåœ¨ Makefile é‡Œé¢æŠŠä¼˜åŒ–ç»™å»æ‰ã€‚
æ‰“å¼€ Makefileï¼Œ åœ¨é‡Œé¢æ‰¾åˆ°è¿™ä¸€å¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;CFLAGS_OPT=$(CFLAGS) -O2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ”¹æˆï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;CFLAGS_OPT=$(CFLAGS) -O0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±å¥½åŠäº†ï¼Œæˆ‘ä»¬ç…§ç€ &lt;a href=&quot;https://blog.csdn.net/u011577874/article/details/73000207&quot;&gt;è¿™ç¯‡æ•™ç¨‹&lt;/a&gt; èµ°å°±å¯ä»¥åœ¨
XCode é‡Œé¢ debug äº†ã€‚&lt;/p&gt;
&lt;h2&gt;OPCode&lt;/h2&gt;
&lt;p&gt;QuickJs çš„è™šæ‹Ÿæœºä½¿ç”¨æ ˆå¼è™šæ‹Ÿæœºã€‚å¯¹äºä»€ä¹ˆå¼æ ˆè™šæ‹Ÿæœºæ¨èé˜…è¯» &lt;a href=&quot;https://www.iteye.com/blog/rednaxelafx-492667&quot;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt; äº†è§£ã€‚&lt;/p&gt;
&lt;p&gt;QuickJS çš„ OPCode ååˆ†ç®€æ´å’Œç´§å‡‘ã€‚æ‰€æœ‰ OP ç çš„å®šä¹‰éƒ½æ”¾åœ¨ &lt;code&gt;quickjs-opcode.h&lt;/code&gt; æ–‡ä»¶é‡Œé¢ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/75f622fd7f08e5fa7bc3eaa3a6a2913f/ef8d3/quickjs-opcode.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 79.71428571428572%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADTElEQVQ4y6VTS2sbVxQe2kJ3hRLRbavGljSa9+POzL2ah0YaaRxZntgli5RQsumi0E0pwQluSBOblloxTRonRrS4j30E+QX9MyWCUiJol2ZmTs8dRSbdBbr4OGfu4zvf+c4d4ferT968thUmZkIvt2Wy1VLsTEQohpcZNsvcIMkIizMvHGR+N800i2WKSTPddDPZcDH3tlSLXtZsll67/unbwsPDx+/2ktGfshuBTiJw/T4QGoOoM/jQCEDWXZAQDcmEi20L2pivtVT4QPehqTrQUiyEzff/+ezzL94XHj6Z1sJk+7lkhiDbQe7Qful0BqVidso1yS4bklVhXTTLNUQD19bbmEukynEvX8dCouK8uLG7VxcenZxeYNGl50iAldzCNZJSt3qlqNOyJa8ucZCyKdvn383zdbtAgGSwF7fuTerCZH+3Fo0+metsjISk0FQfWwygoTjAD74GCq5QI9Hi3uRxXbg/OaxF6ZW55vRBVN3C0rtg2ANoGT4vwNfOgR1AS/Uw5945q/WC57LpL/a+eVAXHjya1qJBNlftADe9gpkpGAaSm1wpXcJgICPaOCjRDKqcr3ObFJMV8nJ/8eXu7bpwfPJjrTvcnmt2yKsXIipTrQ5ImgttVKgaFNqaB03ZqRRyVU2ZVO2ut1ct21iMLna/2q8LPxxPa3G6M0cPloSvKuKkqrNsEcGJVuCETQ6ZrIayqIZy//vjc4WiRguJptUFm/bADYagWxQsmwKx+6iaQqMiXHrI0VScJaHOFje//q4uHCFhmKCHFraMhDLbAM32KzIWj8CwGNiEgusmoBgdToBq/zOol4R0cesuEv50+luNdAZzCQ9XhKhQRM84KUGVXCEhDAjrvfRyqfCV9gseZStY3DzAKZ9MTy904vEfCk4VCc/aXprjgdxhvRxJcsOiOXFY9S3pXo5t5qgMo7uKZ5xQtYK/7u4f1YWDbyfcw791p1v9v2aU4SPtood96MSbYDohEDcExx/wxwu8ExlfAo8roPfor3d258beReH0l1/fSS5tT+PB+NlwtPN0vPPxbGPryizsj6oYxBuzTjSc+XE6w3OzXppV6A7GFfDe0+HmR8+Gmzs/HxwevScAAMcbiLf+JziH8C/sewvdumb8WwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;QuickJS çš„ OP ç &quot;
        title=&quot;&quot;
        src=&quot;/static/75f622fd7f08e5fa7bc3eaa3a6a2913f/84ad3/quickjs-opcode.png&quot;
        srcset=&quot;/static/75f622fd7f08e5fa7bc3eaa3a6a2913f/687da/quickjs-opcode.png 175w,
/static/75f622fd7f08e5fa7bc3eaa3a6a2913f/0ab4d/quickjs-opcode.png 350w,
/static/75f622fd7f08e5fa7bc3eaa3a6a2913f/84ad3/quickjs-opcode.png 700w,
/static/75f622fd7f08e5fa7bc3eaa3a6a2913f/ef8d3/quickjs-opcode.png 1050w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»ä¸Šå›¾å¯ä»¥çŸ¥é“ OPCode å®šä¹‰åˆ†ä¸ºè¿™å‡ ä¸ªéƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;id: OPCode çš„åå­—&lt;/li&gt;
&lt;li&gt;size: OPCode çš„å­—èŠ‚å¤§å°ã€‚æ¯”å¦‚è¯´ &lt;code&gt;push_i32&lt;/code&gt; æŒ‡ä»¤çš„ size æ˜¯ 5. é‚£ä¹ˆç¬¬ä¸€ä¸ªå­—èŠ‚ç”¨æ¥å­˜ OPCode æœ¬èº«ï¼Œ
åé¢å››ä¸ªå­—èŠ‚ç”¨æ¥å­˜ 32 ä¸ºçš„æ•´å‹ï¼Œä¹Ÿå°±æ˜¯å››ä¸ªå­—èŠ‚ã€‚&lt;/li&gt;
&lt;li&gt;n_pop: ä»æ ˆä¸Šé¢å¼¹å‡ºçš„å…ƒç´ çš„æ•°é‡ã€‚å’Œä¸‹é¢çš„ n_push ä¸€èµ·ç”¨æˆ·ç»Ÿè®¡å‡½æ•°éœ€è¦åˆ†é…çš„æ ˆçš„å¤§å°ã€‚&lt;/li&gt;
&lt;li&gt;n_push: ä»æ ˆä¸Šé¢æ’å…¥å…ƒç´ çš„æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;f: å­—èŠ‚ç çš„æ ¼å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Runtime&lt;/h2&gt;
&lt;p&gt;åœ¨è™šæ‹Ÿæœºå†…éƒ¨ï¼Œè¿ç®—çš„æœ€åŸºæœ¬å•ä½æ˜¯ JSValueï¼Œä¸€ä¸ª JSValue å¯ä»¥ç”¨ä»¥ä¸‹ Tag æ¥æ ‡ç¤ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-c&quot;&gt;enum {
    /* all tags with a reference count are negative */
    JS_TAG_FIRST       = -10, /* first negative tag */
    JS_TAG_BIG_INT     = -10,
    JS_TAG_BIG_FLOAT   = -9,
    JS_TAG_SYMBOL      = -8,
    JS_TAG_STRING      = -7,
    JS_TAG_SHAPE       = -6, /* used internally during GC */
    JS_TAG_ASYNC_FUNCTION = -5, /* used internally during GC */
    JS_TAG_VAR_REF     = -4, /* used internally during GC */
    JS_TAG_MODULE      = -3, /* used internally */
    JS_TAG_FUNCTION_BYTECODE = -2, /* used internally */
    JS_TAG_OBJECT      = -1,

    JS_TAG_INT         = 0,
    JS_TAG_BOOL        = 1,
    JS_TAG_NULL        = 2,
    JS_TAG_UNDEFINED   = 3,
    JS_TAG_UNINITIALIZED = 4,
    JS_TAG_CATCH_OFFSET = 5,
    JS_TAG_EXCEPTION   = 6,
    JS_TAG_FLOAT64     = 7,
    /* any larger tag is FLOAT64 if JS_NAN_BOXING */
};
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‚£ä¹ˆä¸€ä¸ª JSValue çš„è¡¨ç¤ºæ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-c&quot;&gt;typedef union JSValueUnion {
    int32_t int32;
    double float64;
    void *ptr;
} JSValueUnion;

typedef struct JSValue {
    JSValueUnion u;
    int64_t tag;
} JSValue;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»è¿™ä¸ªç»“æ„ä½“å¯ä»¥çœ‹å‡ºä¸€ä¸ª JSValue å ç”¨ 16 å­—èŠ‚çš„å†…å­˜ã€‚tag ç”¨æ¥è¡¨ç¤ºè¿™ä¸ª Value çš„ç±»å‹ã€‚è€Œ &lt;code&gt;JSValueUnion&lt;/code&gt; åˆ™æ˜¯
ç”¨æ¥å‚¨å­˜çœŸæ­£çš„å€¼ã€‚è¿™ä¸ªå€¼å¯ä»¥æ˜¯ int/float æˆ–è€…ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªçœŸæ­£çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;çœŸæ­£çš„å¯¹è±¡åœ¨ QuickJS é‡Œé¢åˆ™æ˜¯ä½¿ç”¨å¼•ç”¨è®¡æ•°æ¥è¿›è¡Œå†…å­˜ç®¡ç†ï¼Œæ‰€ä»¥éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-c&quot;&gt;ypedef struct JSRefCountHeader {
    int ref_count;
} JSRefCountHeader;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;å‘½ä»¤æ‰§è¡Œ&lt;/h2&gt;
&lt;p&gt;çŸ¥é“äº†ä¸Šè¿°èƒŒæ™¯ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹çœ‹ QuickJS è™šæ‹Ÿæœºå…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹äº†ã€‚éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œä¸€ä¸ªæ ˆè™šæ‹Ÿæœºï¼Œéœ€è¦ä¸¤ä¸ªå¾ˆé‡è¦çš„
æŒ‡é’ˆï¼Œåˆ†åˆ«æ˜¯ pc å’Œ spã€‚&lt;/p&gt;
&lt;p&gt;pc æŒ‡çš„æ˜¯ç¨‹åºè®¡æ•°å™¨ã€‚æŒ‡å‘æ­£åœ¨è¯»å–çš„ OPCodeï¼Œè¯»å–ä¹‹å pc ä¼š ++ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªå­—èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;sp æ˜¯æ ˆæŒ‡é’ˆã€‚æŒ‡å‘æ ˆæœºå™¨æ ˆé¡¶çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œç”¨æ¥è¿›è¡Œæ ˆç›¸å…³çš„æ“ä½œã€‚&lt;/p&gt;
&lt;h3&gt;å…¥æ ˆ&lt;/h3&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5a01f65ed89f2ad910820f02f6125e98/ef8d3/qjs-add.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 79.71428571428572%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADmElEQVQ4y6VTTYscVRQtVHAnSBq3Wkx/1XdV16vvj66u6q7uznRXTxIyiIkYEHEjalBHE40JgySkR4aYIUxQI8aFG1OQvWt3/gR3kgaRNJjlUFXX+3qYUbN1cbiv3+s6755z7mN+uXDv2XPTsK8lzkxWnWlbJpmo2ZlK3EzSrIw4UeZ00ywMepnl9jJBtRBmpuC5ohmZoJhTUbNmKvGG599463nmxtX5i3F//Q/ViaAlO2D7fVCID2tcB+oiASSHRluGV0gMnOYALxvAKyastSRgZRt41YK2RKDBq0/efuf9l5n57u1a2N94pFoxNBWnsLykUnSvqnOdqsF3qhaiwWnVmmhWDYFUTUFfoY57dfpbJEWD14GTjMeXPv6MZW7d3j/h9SaPVDOCtuyUvOJUbcmqmpJZtbSgalkpfqyuCPDDYzQp2arqJZ6BZiWPf/r5N5b5am+/hoQLxYiAOEmpkBAl2CCGM3CzN2GQnoUw2gSjE4IoW9AUDWj9FyUqAc0dLn/89QnLXL/yXi06eX5hDC6ApNml2AmgwanAkQj80asw8QbQDyagaB60BLIiwe6OQQlpFXV/eXlnn2Vuzr+sddNTi46TosFuiYAm9UTvgtHbgL6TQGAEICgWNJ4iPOqQrhWju7y6PWeZnd09DCVbaFYPJL2LHfrQxIQ5IwZ3fA5mfgoDO8YO3WPCpyU3BQMvtJcffXKFZW7Md2vx6MyCOH0QNL8UUFoTPaGS7cEmDN0+RBiYRDvE/aPuGv/Ukq75I8K9O1/X3GgdQ+kioXcsuY1ekmAdErMHHkLQA2gpLnAKzp5kgojgEJJklqJkgag6yw+2PmWZO3e/rdnheCFjujJByZp/6A/+WbGH4PhTkJFcQAva+upSULBbHROnpESxS111QOq4y4sfXmaZb+7drxleuqDpSnp4KFnADlUPdHcEkZWAhSMlm0iIoyOggjZVoQUgo684r2Wd/5fkmzu3TvSGp3/voPFIdoCS6eQXKLuQZKvokLjg6J7iFii5QMlFG18UXlhIWFH2AX0pgmr/uXXpc5a5tn29FsSTv3QMRUSf6IDLtKJvGnpodaegox06DQZV0CmgdRUIf2gNvi7a4cG7F7fWmO/v//BCnE7vJsPsYTzMHkxPv5ZvnH097483cq87yP0gyYMozUeTMzme5710kiejWR7EozxMxrjOHoyzzYfpyVPfXdv+4iUGACieQTz3P0E5mL8BxX0O/M1TIAkAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;qjs add&quot;
        title=&quot;&quot;
        src=&quot;/static/5a01f65ed89f2ad910820f02f6125e98/84ad3/qjs-add.png&quot;
        srcset=&quot;/static/5a01f65ed89f2ad910820f02f6125e98/687da/qjs-add.png 175w,
/static/5a01f65ed89f2ad910820f02f6125e98/0ab4d/qjs-add.png 350w,
/static/5a01f65ed89f2ad910820f02f6125e98/84ad3/qjs-add.png 700w,
/static/5a01f65ed89f2ad910820f02f6125e98/ef8d3/qjs-add.png 1050w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¥æ ˆæ“ä½œå°±æ˜¯æŠŠè¯»å…¥çš„å€¼å˜æˆä¸€ä¸ª JSInt32ï¼Œç„¶åèµ‹å€¼åˆ° sp æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ï¼Œç„¶å &lt;code&gt;sp++&lt;/code&gt;ã€‚å°±å®Œæˆäº†ä¸€ä¸ªå…¥æ ˆæ“ä½œã€‚
æˆ‘ä»¬å¯ä»¥çœ‹åˆ° QuickJS çš„å­—èŠ‚ç å®é™…æ˜¯ååˆ†å†—ä½™çš„ï¼Œå…·ä½“ä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡æˆ‘ä¸å¤ªæ¸…æ¥šã€‚ä¼°è®¡æ˜¯ 0-7 ä¹‹é—´çš„æ•°å¯ä»¥ç”¨ä¸€ä¸ª
å­—èŠ‚æå®šï¼ŒèŠ‚çœç©ºé—´ï¼Œä½†æ˜¯æˆ‘ä¸ªäººæ„Ÿè§‰ä¹Ÿå¤ªçœäº†ï¼Œå¯¹å®é™…è¿è¡Œåº”è¯¥å¸®åŠ©ä¸å¤§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;OP_push_i8&lt;/code&gt; æ˜¯ä¸€ä¸ªä¸¤å­—èŠ‚çš„ OP ç ï¼Œç¬¬äºŒä¸ªå­—èŠ‚å°±æ˜¯ä¸€ä¸ª 8 ä½çš„æ•´æ•°ï¼ŒåŒç† &lt;code&gt;OP_push_i16&lt;/code&gt; å°±æ˜¯ä¸€ä¸ªä¸‰ä¸ªå­—èŠ‚
çš„æŒ‡ä»¤ï¼Œå…¥æ ˆä¸€ä¸ª 16 ä½çš„æ•´æ•°ã€‚&lt;/p&gt;
&lt;h3&gt;åŠ æ³•&lt;/h3&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/26fc04630a6d21d4f24798f129c58c7c/cf304/qjs-add-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 62.913907284768214%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACt0lEQVQ4y21TvW7UQBC2REHN8QjJnb22d23vev17F99fIAHRwANQIiQaiiA45+6SXHJAEBVvQcUrAA0dLYgr6EG4QELI6DzM+pIjBcWnmd2Z+ebbGVtr97J9g/m5YfNcp37uBVu566e5bvu55cjc4knOwm7uiDgnVORNFubEDesYUXVUjEwmp6YT3L9778FlrTO4BZaXABMptGgAXpABRX/TlmA5ISAB6LwDthuCQSVsOAkQzLfcCAwWADaufUL973sP965qIh5UrsxKxtOyZfklC/plEPRKw5blBuFlyxQIXjaVxbg6Ny8A735vGh640eDzmw/fGlrUuw3MzyrTiSrdlpXpJpXw08oXUeW5UWVSWWFRpSNatvJlnXcBS2wCXnJt8foTNLS4fwcJu0gYqyA0LR88J4Z21Ace9kB30xrEa4ONI7HVCDCnZQkEWiRUdTZPF/uzF6iwcx0P7TWhjkWGjbOUHZBpF2zZAzPYRgxBcCRFYkN0ERk46BOKCi2JojqL+emrhpZ0b+JS0oqwcE3YwkHbLEGF2yDiITAsNJWysxfotsoJaqufK/TixWh8qAhv4Fa3/ilEEBpCpBT4XSDJLljJDtCgD9RNahg4Ep3hZlf5a8J8MsMZZrv1kwmL1oQKLn4eqLx+HvF7YIUDYIr4rAEPekCRtHWRcHzU0HjYV4RL4kTLs25L24mXQmQ4G4Eb5CtY/lIVK1vnqfPK/7MiTL7UhNGWUtgBorrV25P1vDg+l8khUGzIUCnB2Tbr+P+Bn93XkSJMsp2fPOwWQToseJgV+McUjt8uqBMV1EsK/BULgXF158pObVUO5ck5fuD9ryAdfHyST69oj0djOjmcsaenL+ns5BkdT4/owdEJfTKe0EejER3tTzF+XN/VmM3pFM/jgxmdnOFwNneO589bb9+9v/QXhMaRwBTo7QcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;qjs add 2&quot;
        title=&quot;&quot;
        src=&quot;/static/26fc04630a6d21d4f24798f129c58c7c/84ad3/qjs-add-2.png&quot;
        srcset=&quot;/static/26fc04630a6d21d4f24798f129c58c7c/687da/qjs-add-2.png 175w,
/static/26fc04630a6d21d4f24798f129c58c7c/0ab4d/qjs-add-2.png 350w,
/static/26fc04630a6d21d4f24798f129c58c7c/84ad3/qjs-add-2.png 700w,
/static/26fc04630a6d21d4f24798f129c58c7c/ef8d3/qjs-add-2.png 1050w,
/static/26fc04630a6d21d4f24798f129c58c7c/fed13/qjs-add-2.png 1400w,
/static/26fc04630a6d21d4f24798f129c58c7c/cf304/qjs-add-2.png 1510w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ ˆè™šæ‹Ÿæœºä¸Šçš„åŠ æ³•å°±æ˜¯ä»æ ˆå¼¹å‡ºä¸¤ä¸ªå…ƒç´ ï¼Œç›¸åŠ ï¼Œç„¶åå…¥æ ˆã€‚è¿™é‡Œé¦–å…ˆä»æ ˆé¡¶å–å‡º op1 å’Œ op2ã€‚ç„¶ååˆ¤æ–­æ˜¯ä¸æ˜¯ intã€‚
è¿™é‡Œçš„ int ç±»å‹æ˜¯ 32 ä½çš„ã€‚æ‰€ä»¥å®ƒå…ˆæŠŠä»–ä»¬åˆ‡åˆ° 64 ä½è¿›è¡Œç›¸åŠ ã€‚åŠ å®Œå†åˆ‡å› 32 ä½çš„ intï¼Œçœ‹çœ‹æ•°æ®æ˜¯ä¸æ˜¯ä¸€æ ·ã€‚
è‹¥ä¸ä¸€æ ·ï¼Œåˆ™è¯´æ˜åŠ æ³•äº§ç”Ÿäº†æº¢å‡ºï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸¢åˆ° add_slow è¿›è¡Œå¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥ä¸¤ä¸ª op éƒ½æ˜¯ float64 åˆ™è¿›è¡Œæµ®ç‚¹æ•°çš„åŠ æ³•ã€‚&lt;/p&gt;
&lt;h3&gt;If åˆ†æ”¯è·³è½¬&lt;/h3&gt;
&lt;p&gt;If åˆ†æ”¯è·³è½¬æ˜¯ç¨‹åºé‡Œé¢å¾ˆé‡è¦çš„ä¸€æ­¥ï¼Œå®ç°äº†åˆ†æ”¯è·³è½¬ï¼Œfor å’Œ if è¯­å¥éƒ½å¯ä»¥å®ç°äº†ã€‚
QuickJs æœ‰ goto æŒ‡ä»¤ï¼Œæ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸è¯´äº†ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹ &lt;code&gt;OP_if_true&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/83e893320956c5ea56965e06303824f9/cf304/qjs-if-true.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 62.913907284768214%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACkklEQVQ4y4WTu27UQBSGLVFQszwCWXs96/H4fhmvd7NZbgHRwANQIiQaikgkTvaSDRsFKQ2PQcUrAA0dJUJsQQ/CBRJCi+zDb8dJEAJRfDo+84/+OefMWEmGg9029zIdMNPPNMPNhJdkFuggF57MTHwzL82YCLDHy9rcz3Q7rr+Z8Hd005tAe3j/waOLSm90h1QRk+X3SBcBrTGXRLRBdtAnlQfEREgaYttOqWtFhEPpCg+p4yAXJzrDOgr6svV467LixaPScJKVcNIV53LFEA13sFKZu1K73qpdxRqn/m4zD+vnOfb8WOvYZEWjDy/ffm4p0fAuWcGwNCxZdoywFOGojJC7dpX7pfZ/ChxItry+fPGeWko8ukeoqNRFBNEjnEoGWvFdSYYZEiogDai/0W6oNRgC4k6yHD89RoX9G5iNLHWzMvQxL5+EGZPrSOJ2Nb8GmOsGZgYMfkKn2t8Ymm66XBw9byly/TZ17d65IWA8ptBPSYTrpCfQ5Sa5/jpxMyIOc0dENTpM1cawa8XL7d1pZXiLDCdtWj4x7KIaYUrSrB5pTp90S5JZ3Ta09j9aNmy5zMZzzHCw2bQcnhlytGzhKXXxRHSMQENlOtabFv+kMYyX2d5+S3HCDVTYK5iIi0YsGA8KbqeF8NPC9PuF7g0Ljj3cjosOtKbNU342FX6sDaP+ZjVD6qAKlXn1BTC0ym3MzB9S101JhaYJSXpz63+DiejTTmUoBze/2cEgD5KruYMo/H5uJ9dyvPwaVJVbfprjd4RWxV5uuknOHXnKV+jfg2T0bjubXFKe7OzxyWxuHj475vPFEd8bT/h4d5dn430w4+PZAZ8eHPLpfMFnoIoTrI2n8zOwLg4WR+qr128u/ALpxZAQuvlwkwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;qjs if true&quot;
        title=&quot;&quot;
        src=&quot;/static/83e893320956c5ea56965e06303824f9/84ad3/qjs-if-true.png&quot;
        srcset=&quot;/static/83e893320956c5ea56965e06303824f9/687da/qjs-if-true.png 175w,
/static/83e893320956c5ea56965e06303824f9/0ab4d/qjs-if-true.png 350w,
/static/83e893320956c5ea56965e06303824f9/84ad3/qjs-if-true.png 700w,
/static/83e893320956c5ea56965e06303824f9/ef8d3/qjs-if-true.png 1050w,
/static/83e893320956c5ea56965e06303824f9/fed13/qjs-if-true.png 1400w,
/static/83e893320956c5ea56965e06303824f9/cf304/qjs-if-true.png 1510w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;If åˆ†æ”¯è·³è½¬ä¸»è¦æ˜¯çœ‹æ ˆé¡¶å…ƒç´ æ˜¯ä¸æ˜¯ä¸º trueã€‚è‹¥ä¸º trueï¼Œåˆ™æŠŠ pc åŠ ç­‰äºç›¸åº”çš„ offsetã€‚
è¿™ä¸ª offset åœ¨ QuickJS é‡Œé¢æ˜¯ 32 ä½çš„ï¼Œè¿™æ„å‘³ç€ &lt;code&gt;OP_if_true&lt;/code&gt; æ˜¯ä¸€ä¸ª 5 ä¸ªå­—èŠ‚çš„
OPCodeã€‚è¿™ä¸ª offset åœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­å°±å¯ä»¥è¢«ç®—å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;å›¾ä¸­æœ‰ä¸€ä¸ª tag æ˜¯å¦å°äºç­‰äº &lt;code&gt;JS_TAG_UNDEFINED&lt;/code&gt; çš„åˆ¤æ–­ã€‚è¿™ä¸ªåˆ¤æ–­æ ¹æ®ä¸Šé¢çš„ tag çš„å®šä¹‰ã€‚
æˆ‘ä»¬çŸ¥é“åªæœ‰è¿™å‡ ä¸ªç±»å‹æ˜¯ä¸ç¬¦åˆè¿™ä¸ªåˆ¤æ–­çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;JS_TAG_UNINITIALIZED = 4&lt;/li&gt;
&lt;li&gt;JS_TAG_CATCH_OFFSET = 5&lt;/li&gt;
&lt;li&gt;JS_TAG_EXCEPTION   = 6&lt;/li&gt;
&lt;li&gt;JS_TAG_FLOAT64     = 7&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸Šå‡ ä¸ªç±»å‹éœ€è¦ç”¨ &lt;code&gt;JS_ToBoolFree&lt;/code&gt;ï¼Œè¿›è¡Œåˆ¤æ–­ï¼Œå…¶ä»–ç±»å‹åˆ™å¯ä»¥ä» JSValue è¯»å‡ºçœŸæ­£çš„ bool å€¼ã€‚&lt;/p&gt;
&lt;h2&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;QuickJS æºç å®ç°éå¸¸ç®€å•æ˜“æ‡‚ï¼Œæ˜¯ä¸€ä¸ªéå¸¸é€‚åˆå­¦ä¹ çš„ JS å¼•æ“ã€‚æœ‰ä¸€ç‚¹è°ˆä¸ä¸Šå¥½åçš„å°±æ˜¯
åƒ Bellard è¿™æ ·çš„ hacker å‡ºæ¥çš„ä»£ç éå¸¸çš„éªšæ°”ã€‚æ¯”å¦‚è¯´é€šç¯‡çš„ gotoï¼Œä¸è¿‡å¹¸å¥½ä¸æ˜¯å¾ˆéš¾æ‡‚ï¼Œ
æœ‰äº›é€»è¾‘ç¡®å® goto å†™èµ·æ¥æ¯”è¾ƒçˆ½è¿™ä¸€ç‚¹ï¼Œå¯ä»¥ç†è§£ã€‚å¦ä¸€æ–¹é¢ä¸å¤ªå¥½çš„å°±æ˜¯å¤§éƒ¨åˆ†ä»£ç éƒ½å†™å°½äº†ä¸€ä¸ª .c æ–‡ä»¶
é‡Œé¢äº†ï¼Œè¯»å‡½æ•°è°ƒç”¨è·³æ¥è·³å»æ¯”è¾ƒéº»çƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;æ€»çš„æ¥è¯´æ˜¯æ¯”è¾ƒé€‚åˆé˜…è¯»çš„æºç äº†ã€‚&lt;/p&gt;
&lt;h2&gt;ç›¸å…³é˜…è¯»&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;QuickJS å®˜æ–¹æ–‡æ¡£ï¼š&lt;a href=&quot;https://bellard.org/quickjs/quickjs.pdf&quot;&gt;https://bellard.org/quickjs/quickjs.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æ ˆå¼è™šæ‹Ÿæœºï¼š&lt;a href=&quot;https://www.iteye.com/blog/rednaxelafx-492667&quot;&gt;https://www.iteye.com/blog/rednaxelafx-492667&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;X86 æ¶æ„ï¼š&lt;a href=&quot;https://blog.csdn.net/ajigegege/article/details/17055779&quot;&gt;https://blog.csdn.net/ajigegege/article/details/17055779&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ Xcode è¿›è¡Œ Debugï¼š&lt;a href=&quot;https://blog.csdn.net/u011577874/article/details/73000207&quot;&gt;https://blog.csdn.net/u011577874/article/details/73000207&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[è½¬æ¢ç½‘æ˜“ ncm æ ¼å¼åˆ° mp3]]></title><link>https://diverse.space/2019/05/convert-ncm-to-mp3-on-mac</link><guid isPermaLink="false">https://diverse.space/2019/05/convert-ncm-to-mp3-on-mac</guid><pubDate>Tue, 07 May 2019 17:23:00 GMT</pubDate><content:encoded>&lt;p&gt;ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å¼€å§‹ï¼Œç½‘æ˜“ä¸‹è½½çš„æ­Œæ›²éƒ½ä¸ç”¨ä»¥å‰çš„ mp3 æ ¼å¼ï¼Œè€Œé‡‡ç”¨äº†è‡ªå®¶çš„ ncmï¼Œè¯´çœŸçš„ï¼Œæ¯”è¾ƒæ¶å¿ƒï¼Œå¹³æ—¶è‡ªå·±æƒ³è¦å‰ªä¸ªè§†é¢‘ç”¨ä¸ªé…ä¹éƒ½å¾ˆéº»çƒ¦ï¼Œæœäº†å¾ˆä¹…å¾ˆå¤šå·¥å…·ï¼Œæœ€åæœåˆ°äº†è¿™ä¸ªï¼š&lt;a href=&quot;https://github.com/anonymous5l/ncmdump&quot;&gt;ncmdump&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–é¡µæä¾›äº† Windows å’Œ Linux çš„ä½¿ç”¨æ–¹æ³•ï¼Œmac ä¸‹é¢ä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œå…ˆç”¨ brew å®‰è£… taglibï¼Œç„¶å make å³å¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-sh&quot;&gt;$ git clone https://github.com/anonymous5l/ncmdump
$ brew install taglib
$ make
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®æµ‹å¯ä»¥è½¬æ¢æˆåŠŸï¼š&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/39d4dbc9482ac806db796cf198e30f78/cd7e3/screenshot.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 69.33471933471932%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAACsUlEQVQ4y3VT6XLSUBTOE1jb8YctWYCwhawQshOWsrR1HH0pZ2xrnQp0lPomOgSyQjs+RaG+h/dcoOKM/fHNOTk5y3eWS3z9/GF1Pb5+HI+/P45vb39/G48fB8PhanRzA1h+urpanl9crj6eX4C+Go5G2D4c3Sy/DAYPyBdLZF8OBsMHolAWZ4Zpx4ZtJ7ppxaqmx0w6G2TY3BSQzrIemy9My4LoM5msd0RSk/2DVz/3Xh78eLGDvf21JNSaFumWFTtuI9EMM7YdN6m7zUQ3rFjTzaiiqqFSVcNcoTQ7IulJimImdDrjQXKQdDq7BrPWiUazNe+fnt2/fff+F8hu/+Su0+vfgd4/fXPf7pwtWse9hWnZsVyphqiDCNgWitxMVqohL0oBfEtKBesEOLU7XRTUWdh1F7MEtpZTx7CdRgLfULjZOp43Wu25gZILkhzkUVIYBwA6yOWLM8JFjt3eyR0w652cIna9+2pNW0BiaLumGxHMFiQAGFbUGgAzEiUlAAkMQSckWQkct5402+25jRhtquO5AUT0H7qAeZbKgl8ocTMKzYtEs6TotEcxCPRfEIqqRzXTiWVVD7OIcoqi4ccEArZI/QP6v4meEqpGPTbddiJU9LAsyiFynMI2SZrxELAER3IbhNjhZM+AMKxm4rS6c91uJla9MUfzSlTNiHhhvT2OF3wWMS9yZT+by0/J3aQ7TGlsy3iEhhKpViOumo1YVGqRiOYHWwNm63tjN7e2DgD26w522kb21ylyAkdPtI67C16Ug8MUhdsDIzjDhktl3t/OjNwAtg/3h1lukkGMa6DHoFoRYaKXIVW1UFDUsMDxPqI+hcr4eNFGn5hs2EARjodnyHrb9qGoguJ5XvKJimZHRUEJcpzoswXOR+94CoFQFbPb3SaTfqbltHe4afkPiYl2OXePz7MAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;screenshot&quot;
        title=&quot;&quot;
        src=&quot;/static/39d4dbc9482ac806db796cf198e30f78/84ad3/screenshot.png&quot;
        srcset=&quot;/static/39d4dbc9482ac806db796cf198e30f78/687da/screenshot.png 175w,
/static/39d4dbc9482ac806db796cf198e30f78/0ab4d/screenshot.png 350w,
/static/39d4dbc9482ac806db796cf198e30f78/84ad3/screenshot.png 700w,
/static/39d4dbc9482ac806db796cf198e30f78/ef8d3/screenshot.png 1050w,
/static/39d4dbc9482ac806db796cf198e30f78/fed13/screenshot.png 1400w,
/static/39d4dbc9482ac806db796cf198e30f78/cd7e3/screenshot.png 1924w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ä½¿ç”¨ OCaml è§£æ JavaScript]]></title><link>https://diverse.space/2019/02/parse-javascript-with-ocaml</link><guid isPermaLink="false">https://diverse.space/2019/02/parse-javascript-with-ocaml</guid><pubDate>Wed, 20 Feb 2019 00:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;èµ·å› &lt;/h1&gt;
&lt;p&gt;æœ€è¿‘åœ¨å†™ä¸€ä¸ªå…³äº JavaScript çš„é™æ€åˆ†æå™¨ï¼Œä½œä¸ºæˆ‘çš„æ¯•ä¸šè®¾è®¡ã€‚æˆ‘å†™é™æ€åˆ†æä¸»è¦æ˜¯ä¸ºäº† ES6 å±‚é¢çš„è¯­æ³•åšæ›´å¥½çš„ DCE(Dead Code Elimination)ã€‚æˆ‘é€‰æ‹© OCaml æ¥å®ç°è¿™ä¸ªé™æ€åˆ†æå·¥å…·ï¼Œç”¨ flow æ¥ parse JavaScriptã€‚&lt;/p&gt;
&lt;h1&gt;ä¸ºä»€ä¹ˆé€‰æ‹© OCaml&lt;/h1&gt;
&lt;p&gt;åœ¨å’Œå¯¼å¸ˆè®¨è®ºé¢˜ç›®çš„æ—¶å€™ï¼Œæˆ‘è·Ÿå¯¼å¸ˆè¯´è¿™ä¸ªé¡¹ç›®ç”¨ Java æ¥å†™ï¼Œä¸»è¦æ˜¯ Java æ¯”è¾ƒå®¹æ˜“è¯´æœè€å¸ˆã€‚å®é™…ä¸Šå¼€å§‹å†™çš„æ—¶å€™å°±å¡äº†å¾ˆå¤šç§è´§ï¼Œæˆ‘çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬å…¶å®ç”¨çš„æ˜¯ Scalaï¼ŒåŸå› æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Scala é‡Œé¢çš„å¾ˆå¤šè¯­è¨€ç‰¹æ€§éå¸¸æœ‰ FP é£æ ¼ï¼Œä¹Ÿå¾ˆé€‚åˆç”¨æ¥å†™ç¼–è¯‘å™¨å’Œé™æ€åˆ†æå·¥å…·ã€‚&lt;/li&gt;
&lt;li&gt;è¿è¡Œåœ¨ JVM ä¸Šé¢æ›´å®¹æ˜“åšå¤šçº¿ç¨‹ï¼Œå¯ä»¥ä½¿é™æ€åˆ†æè¿‡ç¨‹æœ‰è¾ƒå¤§çš„æå‡ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæœ‰éœ€è¦ï¼ŒScala å¯ä»¥ç¼–è¯‘æˆ JSã€‚JVM ä¸Šé¢ä¹Ÿæœ‰å¾ˆå¤šå¯ä»¥å’Œ JS è”åŠ¨çš„æ–¹æ¡ˆï¼Œæ–¹ä¾¿å’Œå…¶ä»– JS library è”åŠ¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½†æ˜¯å¼€å§‹ä½¿ç”¨ Scala çš„æ—¶å€™å´å‘ç°äº†è®¸å¤šé—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æˆ‘ä½¿ç”¨çš„ Parser å’Œ AST ç»“æ„éƒ½æ˜¯ Java å†™çš„ï¼ˆä½¿ç”¨äº† Graal.js çš„ Parserï¼‰ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨ Scala çš„ case class é£æ ¼ï¼Œè¿™æ„å‘³ç€æˆ‘è¦åœ¨ Scala é‡Œé¢å†™ Java Style çš„ä»£ç ï¼Œæˆ‘è¡¨ç¤ºå¾ˆæ‹’ç»ã€‚æˆ‘å½“ç„¶å¯ä»¥ç”¨ implicit è¯­æ³•å†™ä¸€å±‚è½¬æ¢å±‚ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™æ ·å¾ˆè›‹ç–¼ï¼Œæ‰€ä»¥æ”¾å¼ƒã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘è¦è¿›è¡Œçš„é™æ€åˆ†ææ˜¯åŸºäºå›¾ï¼ˆGraphï¼‰çš„ï¼Œä¼¼ä¹æ²¡åŠæ³•è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œå³ä½¿å¯ä»¥ï¼Œä¹Ÿä¼šæœ‰è¶…çº§å¤š overheadï¼Œè¿˜ä¸å¦‚ä½¿ç”¨å•çº¿ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;å·¨æ…¢çš„ç¼–è¯‘é€Ÿåº¦å’Œå¯åŠ¨æ—¶é—´ã€‚ç¼–è¯‘é€Ÿåº¦ä¸è¯´äº†ã€‚è¿è¡Œé€Ÿåº¦ Scala åº”è¯¥æ˜¯å¾ˆå¿«çš„ï¼Œä½†æ˜¯å¯åŠ¨ï¼ˆé¢„çƒ­ï¼‰å´å¾ˆæ…¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç§ç§è›‹ç–¼çš„æƒ…å†µè®©æˆ‘é‡æ–°å®¡è§†ç”¨ Scala æ˜¯ä¸æ˜¯ç‰¹åˆ«å¥½çš„æ–¹æ¡ˆï¼Œæˆ‘æƒ³è¦ä¸€é—¨æ‰§è¡Œé€Ÿåº¦ç›¸å¯¹è¾ƒå¿«ï¼Œè¯­æ³•å¯¹å†™ç¼–è¯‘å™¨ç›¸å¯¹å‹å¥½çš„è¯­è¨€ã€‚Scala å·²ç»å¾ˆæ¥è¿‘äº†ï¼Œä½†æ˜¯è¿˜ä¸å¤Ÿã€‚è¿™è®©æˆ‘æƒ³èµ·ä¹‹å‰ç”¨è¿‡ OCaml æ¥å†™è¿‡ç¼–è¯‘å™¨ï¼Œæ„Ÿè§‰ä»£æ•°å½¢å¼çš„æ•°æ®ç»“æ„å¤©ç”Ÿå¯¹ç¼–è¯‘å™¨å’Œé™æ€åˆ†æéå¸¸å‹å¥½ã€‚è€Œä¸”æœ‰ä¸¤ä¸ªé¡¹ç›®éå¸¸å¯å‘åˆ°æˆ‘ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&quot;https://flow.org/&quot;&gt;Flow&lt;/a&gt;&lt;/strong&gt;ï¼šé™æ€åˆ†æå·¥å…·ï¼Œä½†æ˜¯å·²ç»æ¼”åŒ–åˆ°ç±»ä¼¼ TypeScript é‚£æ ·ï¼Œå˜æˆä¸€é—¨è¯­è¨€äº†ã€‚æˆ‘ä¸ªäººç”¨è¿‡ flowï¼Œä½†æ˜¯æ„Ÿè§‰éå¸¸æ…¢ï¼Œæ¯” TypeScript æ…¢å¾ˆå¤šï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¸æ˜¯ OCaml æ…¢ï¼Œè€Œæ˜¯ flow æœ¬èº«è®¾è®¡çš„é—®é¢˜ã€‚è®¾è®¡ TypeScript çš„ Anders Hejlsberg æ¯•ç«Ÿæ˜¯ç¼–è¯‘å™¨é¢†åŸŸçš„å¤§ç‰›ï¼Œå¾ˆå¤šå‘éƒ½è¸©è¿‡ï¼Œåƒ TypeScript å’Œ VSCode è”åŠ¨ä½“éªŒè¿™ä¹ˆå¥½è‚¯å®šæ˜¯ç»è¿‡ä¼˜è‰¯è®¾è®¡çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&quot;https://bucklescript.github.io&quot;&gt;BuckleScript&lt;/a&gt;&lt;/strong&gt;ï¼šæŠŠ OCaml ç¼–è¯‘åˆ° JS çš„ç¼–è¯‘å™¨ï¼ˆå…¶å®ä¹Ÿç®—ä¸€é—¨è¯­è¨€ï¼Ÿï¼‰ã€‚ä½œè€…å·ç§°ç¼–è¯‘é€Ÿåº¦æœ€å¿«çš„è¯­è¨€ï¼Œç¼–è¯‘é€Ÿåº¦æ¯” TypeScript è¿˜å¿«ï¼Œå¹¶é™„ä¸Šäº† benchmarkã€‚è¿™ç‚¹ä¹Ÿå¯ä»¥ç†è§£ã€‚æ¯•ç«Ÿ OCaml è¿™é—¨è¯­è¨€æ¯” TypeScript ç®€å•å¤ªå¤šäº†ã€‚è¿™è®©æˆ‘çœ‹åˆ°äº†ä¸€çº¿ç”Ÿæœºï¼ŒOCaml å†™å‡ºæ¥çš„ç¼–è¯‘å™¨ä¹Ÿå¯ä»¥å¾ˆå¿«çš„å•Šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ä¼˜ç‚¹ï¼š&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ADT&lt;/li&gt;
&lt;li&gt;å†·å¯åŠ¨é€Ÿåº¦å´å¯ä»¥ç§’æ€ Scalaã€‚æƒ³è±¡ä¸€ä¸‹ç¼–è¯‘å‡ ä¸ªæ–‡ä»¶çš„é¡¹ç›®ï¼ŒScala è¿˜è¦ç­‰ JVM é¢„çƒ­æ‰èƒ½è¾¾åˆ°å³°å€¼ï¼Œå…¶å®å¾ˆè›‹ç–¼ã€‚&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘é€Ÿåº¦å¾ˆå¿«ï¼ˆç›¸æ¯” Scalaï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ç¼ºç‚¹ï¼š&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ç°åœ¨ OCaml ä¾ç„¶æ²¡æœ‰åŠæ³•å®ç°çœŸæ­£æ„ä¹‰ä¸Šçš„å¤šçº¿ç¨‹ï¼šæœ‰ GILã€‚è€Œæˆ‘è§‰å¾—è¿™ä¸æ˜¯ç—›ç‚¹ï¼Œè€Œä¸” multi-core OCaml å‡†å¤‡æ¨å‡ºäº†ï¼ˆ2020 å¹´ï¼Ÿï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœéœ€è¦å’Œ JS è”åŠ¨ï¼Œéœ€è¦ç¼–è¯‘æˆ JS&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;ä½¿ç”¨ Flow Parser&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Github:&lt;/strong&gt; &lt;a href=&quot;https://github.com/facebook/flow&quot;&gt;https://github.com/facebook/flow&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Flow æ˜¯åˆ©å™¨ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªå·±ä»å¤´å¼€å§‹å†™ ES çš„ Parser æ˜¯ä¸å¤ªç°å®çš„ã€‚å¾ˆå¹¸è¿ flow å°±æä¾›äº†è¿™ä¹ˆä¸€ä¸ªå·¥å…·ã€‚Flow çš„ä»£ç ç»“æ„è¿˜æ˜¯è›®æ¸…æ™°ï¼Œæˆ‘ä¸€çœ‹é¡¹ç›®ç›®å½•åŸºæœ¬äº†è§£å„ä¸ªæ¨¡å—çš„ä½œç”¨ï¼Œè€Œ parser æ˜¯ä½œä¸ºç‹¬ç«‹çš„ä¸€éƒ¨åˆ†ï¼š&lt;a href=&quot;https://github.com/facebook/flow/tree/master/src/parser&quot;&gt;Flow Parser&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;AST å®šä¹‰ï¼š&lt;a href=&quot;https://github.com/facebook/flow/blob/master/src/parser/flow_ast.ml&quot;&gt;https://github.com/facebook/flow/blob/master/src/parser/flow_ast.ml&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Flow çš„ AST éƒ½å†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œæˆ‘ä»¬çœ‹ program çš„å®šä¹‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot;&gt;type (&apos;M, &apos;T) program = &apos;M * (&apos;M, &apos;T) Statement.t list * &apos;M Comment.t list [@@deriving show]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸€ä¸ª program å°±æ˜¯ &lt;code&gt;list of Statment.t&lt;/code&gt;ã€‚æœ‰ä¸¤ä¸ªæ³›å‹å‚æ•° &lt;code&gt;&apos;M&lt;/code&gt; å’Œ &lt;code&gt;&apos;T&lt;/code&gt; å……æ–¥ç€æ•´ä¸ª ASTï¼Œè™½ç„¶å®ƒçš„ä½œç”¨å¾ˆå·§å¦™ï¼Œä½†æ˜¯å´å¹¶ä¸æ˜¯é‚£ä¹ˆç›´è§‚ã€‚å®é™…ä¸Š parser è¾“å‡ºçš„ç»“æœä¸­ï¼Œ&lt;code&gt;&apos;M&lt;/code&gt; å’Œ &lt;code&gt;&apos;T&lt;/code&gt; éƒ½æ˜¯ &lt;code&gt;Loc.t&lt;/code&gt;ï¼Œå°±æ˜¯ AST çš„ä½ç½®ä¿¡æ¯ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆéœ€è¦ä¸¤ä¸ªèŒƒå‹å‘¢ï¼Ÿæˆ‘ä»¬åªè¦çœ‹ &lt;code&gt;Statement&lt;/code&gt; å’Œ &lt;code&gt;Expression&lt;/code&gt; ä¸¤ä¸ªåœ°æ–¹çš„å®šä¹‰å°±æ˜ç™½äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Statement&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot;&gt;  and (&apos;M, &apos;T) t = &apos;M * (&apos;M, &apos;T) t&apos;
  and (&apos;M, &apos;T) t&apos; =
    | Block of (&apos;M, &apos;T) Block.t
    | Break of &apos;M Break.t
    | ClassDeclaration of (&apos;M, &apos;T) Class.t
    | Continue of &apos;M Continue.t
    | Debugger
    | DeclareClass of (&apos;M, &apos;T) DeclareClass.t
    | DeclareExportDeclaration of (&apos;M, &apos;T) DeclareExportDeclaration.t
    | DeclareFunction of (&apos;M, &apos;T) DeclareFunction.t
    | DeclareInterface of (&apos;M, &apos;T) Interface.t
    | DeclareModule of (&apos;M, &apos;T) DeclareModule.t
    | DeclareModuleExports of (&apos;M, &apos;T) Type.annotation
    | DeclareTypeAlias of (&apos;M, &apos;T) TypeAlias.t
    | DeclareOpaqueType of (&apos;M, &apos;T) OpaqueType.t
    | DeclareVariable of (&apos;M, &apos;T) DeclareVariable.t
    | DoWhile of (&apos;M, &apos;T) DoWhile.t
    | Empty
    | ExportDefaultDeclaration of (&apos;M, &apos;T) ExportDefaultDeclaration.t
    | ExportNamedDeclaration of (&apos;M, &apos;T) ExportNamedDeclaration.t
    | Expression of (&apos;M, &apos;T) Expression.t
    | For of (&apos;M, &apos;T) For.t
    | ForIn of (&apos;M, &apos;T) ForIn.t
    | ForOf of (&apos;M, &apos;T) ForOf.t
    | FunctionDeclaration of (&apos;M, &apos;T) Function.t
    | If of (&apos;M, &apos;T) If.t
    | ImportDeclaration of (&apos;M, &apos;T) ImportDeclaration.t
    | InterfaceDeclaration of (&apos;M, &apos;T) Interface.t
    | Labeled of (&apos;M, &apos;T) Labeled.t
    | Return of (&apos;M, &apos;T) Return.t
    | Switch of (&apos;M, &apos;T) Switch.t
    | Throw of (&apos;M, &apos;T) Throw.t
    | Try of (&apos;M, &apos;T) Try.t
    | TypeAlias of (&apos;M, &apos;T) TypeAlias.t
    | OpaqueType of (&apos;M, &apos;T) OpaqueType.t
    | VariableDeclaration of (&apos;M, &apos;T) VariableDeclaration.t
    | While of (&apos;M, &apos;T) While.t
    | With of (&apos;M, &apos;T) With.t
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Expression&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot;&gt;  type (&apos;M, &apos;T) t = &apos;T * (&apos;M, &apos;T) t&apos;
  and (&apos;M, &apos;T) t&apos; =
    | Array of (&apos;M, &apos;T) Array.t
    | ArrowFunction of (&apos;M, &apos;T) Function.t
    | Assignment of (&apos;M, &apos;T) Assignment.t
    | Binary of (&apos;M, &apos;T) Binary.t
    | Call of (&apos;M, &apos;T) Call.t
    | Class of (&apos;M, &apos;T) Class.t
    | Comprehension of (&apos;M, &apos;T) Comprehension.t
    | Conditional of (&apos;M, &apos;T) Conditional.t
    | Function of (&apos;M, &apos;T) Function.t
    | Generator of (&apos;M, &apos;T) Generator.t
    | Identifier of &apos;T Identifier.t
    | Import of (&apos;M, &apos;T) t
    | JSXElement of (&apos;M, &apos;T) JSX.element
    | JSXFragment of (&apos;M, &apos;T) JSX.fragment
    | Literal of Literal.t
    | Logical of (&apos;M, &apos;T) Logical.t
    | Member of (&apos;M, &apos;T) Member.t
    | MetaProperty of &apos;M MetaProperty.t
    | New of (&apos;M, &apos;T) New.t
    | Object of (&apos;M, &apos;T) Object.t
    | OptionalCall of (&apos;M, &apos;T) OptionalCall.t
    | OptionalMember of (&apos;M, &apos;T) OptionalMember.t
    | Sequence of (&apos;M, &apos;T) Sequence.t
    | Super
    | TaggedTemplate of (&apos;M, &apos;T) TaggedTemplate.t
    | TemplateLiteral of (&apos;M, &apos;T) TemplateLiteral.t
    | This
    | TypeCast of (&apos;M, &apos;T) TypeCast.t
    | Unary of (&apos;M, &apos;T) Unary.t
    | Update of (&apos;M, &apos;T) Update.t
    | Yield of (&apos;M, &apos;T) Yield.t
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç å°±æ˜¯åœ¨è¯´ï¼Œæ‰€æœ‰çš„ Expression ç»“ç‚¹éƒ½ä¼šé™„ä¸Šä¸€ä¸ª &lt;code&gt;&apos;T&lt;/code&gt; ä¿¡æ¯ï¼Œæ‰€æœ‰çš„ Statement éƒ½ä¼šé™„ä¸Šä¸€ä¸ª &lt;code&gt;&apos;M&lt;/code&gt; ä¿¡æ¯ï¼Œè¿™å°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªèŒƒå‹æ˜¯ç”¨æ¥åŒºåˆ† Statement å’Œ Expression çš„ã€‚åœ¨ flow é‡Œé¢è¿›è¡Œ type infer å’Œ type check çš„æ—¶å€™ï¼Œå®é™…ä¸Š &lt;code&gt;&apos;T&lt;/code&gt; ä¼šæ˜¯ &lt;code&gt;(Loc.t * Type.t)&lt;/code&gt;ã€‚è¿™ä¸ªæ˜¯ type check é˜¶æ®µé™„ä¸Šçš„ä¿¡æ¯ï¼Œè€Œ Statement ä¸éœ€è¦è¿™ä¸ªä¿¡æ¯ï¼Œæ‰€ä»¥å®ƒä»ç„¶æ˜¯ &lt;code&gt;Loc.t&lt;/code&gt;ã€‚ä¸¾ä¸ªç±»å‹æ¨å¯¼ä¾‹å­ ğŸŒ° æ¥è¯´æ˜ &apos;T é™„åœ¨è¡¨è¾¾å¼ä¸Šçš„ä½œç”¨ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;var a = 1 + 1;

var a = ((1: &apos;T) + (1: &apos;T)): &apos;T
var a = ((1: number) + (1: number)): &apos;T
var a = ((1: number) + (1: number)): number
var a: number = ((1: number) + (1: number)): number
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»ä¸Šè¿°è¿‡ç¨‹å¯ä»¥æ¨å‡º a çš„ç±»å‹æ˜¯ numberï¼Œè¿™ä¸ªç±»å‹ä¿¡æ¯æŒ‚åœ¨æ‰€æœ‰ expression çš„ AST çš„ä¸Šé¢ï¼Œè€Œ var è¯­å¥çš„ node ä¸éœ€è¦è¿™ä¸ªä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h1&gt;å®‰è£… Flow Parser&lt;/h1&gt;
&lt;p&gt;åŸæœ¬ &lt;code&gt;flow_parser&lt;/code&gt; å¯ä»¥ä» opam å®‰è£…ï¼Œä½†æ˜¯æˆ‘æ›´æ–°äº† opam ä¹‹åä¼¼ä¹å› ä¸ºä¸€äº›å®‰å…¨ç­–ç•¥ç¦æ­¢åŒ…é‡Œé¢çš„ bash è„šæœ¬æ‰§è¡Œï¼ˆå½“æ—¶ç¤¾åŒºå‘ç”Ÿäº†ä¸€ä»¶äº‹ï¼Œä¸€ä¸ªåŒ…çš„ bash è„šæœ¬æŠŠç”¨æˆ·çš„æ•´ä¸ª ~ ç›®å½•åˆ æ‰ï¼Œä¼¼ä¹æ˜¯æ‰‹æ»‘å†™çš„è„šæœ¬å°±å‘å¸ƒäº†ï¼Œåæ¥ opam å¯¹ bash è„šæœ¬åšäº†äº›é™åˆ¶ï¼‰ã€‚æ‰€ä»¥åæ¥æˆ‘åªèƒ½ clone äº† flow çš„ä»£ç æœ¬åœ°è¿›è¡Œå®‰è£…&lt;/p&gt;
&lt;p&gt;è¿›å…¥ &lt;code&gt;src/parser&lt;/code&gt; ç›®å½•æ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;$ make ocamlfind-install
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å³å¯å®‰è£…æˆåŠŸã€‚å¦‚æœä½¿ç”¨ ocamlbuild ç¼–è¯‘ï¼Œè¿›å…¥ &lt;code&gt;_tag&lt;/code&gt; æ–‡ä»¶ï¼ŒåŠ ä¸Š flow&lt;em&gt;parserã€‚æˆ‘çš„ `&lt;/em&gt;tag`:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;true: package(ppx_deriving.show), package(flow_parser), package(core_kernel)
&amp;#x3C;dist&gt;: -traverse
&lt;/code&gt;&lt;/pre&gt;
&lt;h1&gt;ä½¿ç”¨æ–¹æ³•&lt;/h1&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;Flow_ast&lt;/code&gt; è‡ªå¸¦çš„ &lt;code&gt;pp&lt;/code&gt; å’Œ &lt;code&gt;show&lt;/code&gt; æ–¹æ³•å¯ä»¥æŠŠ AST æ‰“å°å‡ºæ¥ï¼Œå‰ææ˜¯ä½ è¦ä¼ å…¥ &lt;code&gt;&apos;T&lt;/code&gt; å’Œ &lt;code&gt;&apos;M&lt;/code&gt; çš„ pretty print æ–¹æ³•ï¼Œ è¿™é‡Œæˆ‘æŠŠ &lt;code&gt;Loc.pp&lt;/code&gt; ä¼ è¿›å»å³å¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-ocaml&quot;&gt;let ast, _ = Parser_flow.program code in
Flow_ast.show_program Loc.pp Loc.pp ast |&gt; print_endline;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¤§åŠŸå‘Šæˆï¼&lt;/p&gt;
&lt;h1&gt;ç›¸å…³é˜…è¯»&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;QuickJS æºç è§£è¯»ï¼š&lt;a href=&quot;https://diverse.space/2019/08/understanding-source-code-of-quickjs-1&quot;&gt;https://diverse.space/2019/08/understanding-source-code-of-quickjs-1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[2018 ä¸åœç•™]]></title><link>https://diverse.space/2019/01/2018-never-stops</link><guid isPermaLink="false">https://diverse.space/2019/01/2018-never-stops</guid><pubDate>Tue, 01 Jan 2019 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;äººç”Ÿä¸­ä¸€äº›å¾ˆé‡è¦çš„æ—¶é—´æ®µï¼Œå¾€å¾€ä¼šåƒç»†æ°´é‚£æ ·æ…¢æ…¢æµèµ°ï¼Œå›è¿‡å¤´æ¥æ‰å‘ç°ï¼Œæ¶“æ¶“ç»†æ°´æ±‡æˆäº†æ±Ÿæ²³å¤§æµ·ã€‚å¯¹äºæˆ‘æ¥è¯´ 2018 å¹´å°±æ˜¯è¿™æ ·çš„ä¸€å¹´ï¼Œå›å¤´ä¸€çœ‹è§‰å¾—å¾ˆå¹³æ·¡ï¼Œä½†æ˜¯ä¸ä¹ä¸°å¯Œçš„ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…³é”®è¯ï¼š&lt;/strong&gt; GSoCï¼Œå¤§å››ï¼Œå®ä¹ &lt;/p&gt;
&lt;p&gt;ï¼ˆæš‚ä¸å¼€æ”¾)&lt;/p&gt;
&lt;!-- ä»Šå¹´å¹´åº•çš„æ—¶å€™æˆ‘æ—¶å¸¸ä¼šå›å¿†èµ· 2017 å¹´çš„ 12 æœˆï¼Œé‚£æ—¶å€™åˆšæ¥æ·±åœ³ï¼Œå¯èƒ½å› ä¸ºåŒæ˜¯ 12 æœˆï¼Œæ¸æ¸å˜å†·çš„å¤©æ°”è®©äººæœ‰ç›¸è¿‘çš„æ„Ÿè§‰ï¼Œä¾¿å®¹æ˜“æƒ³èµ·å¾€äº‹ã€‚17 å¹´çš„å¾ˆå¤šå¿ƒç»“åœ¨ç°åœ¨çš„æˆ‘çœ‹æ¥éƒ½å·²ç»è§£å¼€ï¼Œå³æ—¶ç°åœ¨çš„æˆ‘ä¹Ÿæœ‰æ–°çš„çº ç»“ç‚¹ä¹Ÿæ— å¦¨ï¼Œå› ä¸ºæˆ‘å·²ç»åœ¨è¿™ä¸€å¹´é‡Œé¢å¾—åˆ°äº†è¶³å¤Ÿçš„æˆé•¿ã€‚

ä¸€å¹´å¾ˆé•¿ï¼Œè¶³ä»¥å‘ç”Ÿå¾ˆå¤šäº‹æƒ…ï¼Œåœ¨è¿™ä¸€å¹´é‡Œé¢ï¼Œæˆ‘æœ€è€€çœ¼çš„äº‹æƒ…å°±æ˜¯å‚åŠ äº† GSoC 2018ã€‚ç°åœ¨å›è¿‡å¤´æ¥çœ‹ï¼Œå‚åŠ  GSoC çš„æ”¶ç›Šè¿œè¿œè¶…è¿‡äº†æˆ‘çš„é¢„æœŸã€‚æˆ‘æœ¬ä»¥ä¸ºï¼ŒGSoC åªæ˜¯ä¸€ä¸ªä¸ºå¼€æºé¡¹ç›®åšè´¡çŒ®çš„äº‹æƒ…ï¼Œåªç®—æ˜¯ä¸€ç§æƒ…æ€€ï¼Œå› æ­¤æˆ‘ä¹Ÿæ²¡æœ‰ç‰¹åˆ«å»è·Ÿåˆ«äººè¯´è¿™ä»¶äº‹ã€‚å¯æ˜¯å®ƒç»™æˆ‘å¸¦æ¥çš„å¥½å¤„å´è¿œè¶…æˆ‘çš„é¢„æœŸï¼ŒåŸå› ä¹‹ä¸€æ— éæ˜¯ç¢°å·§ä»Šå¹´ Sean æ¥å¹¿å·å‚åŠ å‰ç«¯å¤§ä¼šï¼Œè€Œä¸” Sean ä¹Ÿä¸é—ä½™åŠ›åœ°åœ¨ Twitter å’Œ Medium ä¸Šæ¨å¹¿æˆ‘çš„ GSoC æˆæœï¼Œçªç„¶ä¹Ÿè®©æˆ‘å°æœ‰äº†åæ°”ã€‚

å½“ç„¶ï¼Œä¸€æ¬¡çš„æˆåŠŸæ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œå¦‚æœæˆ‘å¯¹æ­¤å°±æ»¡æ„äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¥åä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆè¿›æ­¥ã€‚ä¸€æ¬¡çš„å°çˆ†å‘è¯´æ˜ä¸äº†ä»€ä¹ˆï¼Œåªæœ‰æŒç»­åœ°è¾“å‡ºæ‰èƒ½è¯æ˜è‡ªå·±çš„èƒ½åŠ›ã€‚å› æ­¤ï¼Œ2018 å¹´çš„è¿™äº›å¹»å…‰æˆ‘å¯ä»¥é€šé€šå¿˜æ‰ï¼Œå®ƒè™½ç„¶å¾ˆè€€çœ¼ï¼Œä½†å®ƒç»ˆç©¶åªæ˜¯æˆ‘å¥‹æ–—é€”ä¸­çš„ä¸€ä¸ªå°å°çš„å‘å…‰ç‚¹ï¼Œæˆ‘ç›¸ä¿¡ä»¥åä¼šæœ‰æ›´è€€çœ¼çš„æˆå°±ã€‚

è¿™ä¸€å¹´æ¥ï¼Œæˆ‘æŒç»­åœ°åœ¨æ·±åœ³å®ä¹ ï¼Œæ¯”å¾ˆå¤šåŒé¾„äººéƒ½è¦æ—©ã€‚ç°åœ¨å›æƒ³èµ·æ¥ï¼Œæƒ³èµ· 17 å¹´å¹´åº•ä¸€ä¸ªä¹³è‡­æœªå¹²çš„å°ä¼™å­ä¸€ä¸ªäººè·‘æ¥æ·±åœ³å®ä¹ éƒ½æœ‰ç‚¹ä¸å¯æ€è®®ã€‚è¿™ä¸€å¹´æ¥ï¼Œä½œä¸ºç»„é‡Œé¢å¹´çº§æœ€å°çš„å‘˜å·¥çš„è®°å½•ä»æ¥æ²¡æœ‰æ‰“ç ´ã€‚ä½†æ˜¯è¿™å¯¹äºæˆ‘æ¥è¯´ä¹Ÿä¸æ˜¯ç‰¹åˆ«å€¼å¾—ç‚«è€€çš„äº‹æƒ…ï¼Œå› ä¸ºæˆ‘ä¸€ç›´è§‰å¾—ã€Œé—»é“æœ‰å…ˆåï¼Œæœ¯ä¸šæœ‰ä¸“æ”»ã€ï¼Œæœ‰äº›äººæ¯”è¾ƒæ—©å·¥ä½œï¼Œæœ‰äº›äººå¤§å™¨æ™šæˆï¼Œè¿™äº›éƒ½ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯å¯æŒç»­åœ°è¾“å‡ºã€‚

æˆ‘è§‰å¾—å®ä¹ ç»™æˆ‘æœ€å¤§çš„å¥½å¤„å°±æ˜¯ï¼šè‡ªç”±ã€‚åœ¨å­¦æ ¡é‡Œé¢ï¼Œæ€»èƒ½æ„Ÿè§‰åˆ°å„ç§æŸç¼šï¼Œè¿™ç§æŸç¼šçš„æ„Ÿè§‰å·²ç»ä¼´éšæˆ‘å¥½å¤šå¹´äº†ã€‚å½“ç„¶å‡ºæ¥å·¥ä½œå¹¶ä¸æ˜¯å®Œå…¨è‡ªç”±ï¼Œåªä¸è¿‡æ˜¯ä»ä¸€ä¸ªå°ç›‘ç‹±è½¬ç§»åˆ°äº†ä¸€ä¸ªæ›´å¤§çš„ç›‘ç‹±ã€‚è™½ç„¶éƒ½æ˜¯åç‰¢ï¼Œå¾…é‡å´å¥½ä¸Šä¸å°‘ã€‚å®ä¹ çš„æ—¶å€™è‡ªå·±ä½ï¼Œæ²¡æœ‰äººç†ä¼šæˆ‘å›å®¶çš„æ—¶é—´ï¼Œä¹Ÿæ²¡æœ‰äººé˜»ç¢æˆ‘åšä»»ä½•äº‹ã€‚é™¤äº†è¿™äº›è‚¤æµ…çš„è‡ªç”±ï¼Œæ›´å¤§çš„ç²¾ç¥å±‚é¢çš„è‡ªç”±å°±æ˜¯æˆ‘å¯ä»¥åšè‡ªå·±å–œæ¬¢çš„äº‹ï¼Œè¿™ç§çŠ¶æ€åœ¨å­¦æ ¡é‡Œé¢å¯ä»¥è¯´æ˜¯æ±‚ä¹‹ä¸å¾—çš„ã€‚å¯¹äºåŒå€¦æ ¡å›­ç”Ÿæ´»å¾ˆä¹…çš„æˆ‘æ¥è¯´ï¼Œ2018 å¹´ä¸å¾—ä¸è¯´æ˜¯ä¸€ç§è§£è„±ã€‚

ï¼ˆæœªå®Œå¾…ç»­ï¼‰ --&gt;</content:encoded></item><item><title><![CDATA[åœ¨ Mojave ä¸‹ç¼–è¯‘ SpiderMonkey]]></title><link>https://diverse.space/2018/10/åœ¨-Mojave-ä¸‹ç¼–è¯‘-SpiderMonkey</link><guid isPermaLink="false">https://diverse.space/2018/10/åœ¨-Mojave-ä¸‹ç¼–è¯‘-SpiderMonkey</guid><pubDate>Mon, 29 Oct 2018 00:16:14 GMT</pubDate><content:encoded>&lt;p&gt;è‡ªä» macOS å‡çº§åˆ° Mojave(10.14) ä¹‹åï¼Œç¼–è¯‘ SpiderMonkey å˜å¾—æœ‰ç‚¹ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ç‚¹æ¯”è¾ƒé‡è¦çš„å˜åŒ–æ˜¯ libstdc++ è¢«æ›¿æ¢æˆ libc++ï¼Œè¿™ä¸ªä¿®æ”¹æ˜¯ä» OS X 10.9 å°±å¼€å§‹æœ‰çš„ä¿®æ”¹ï¼Œæ‰€ä»¥ç›´æ¥è°ƒç”¨ ./configure æœ‰è¿™æ ·çš„ warning å’ŒæŠ¥é”™ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;checking whether the C++ compiler (/usr/bin/clang++  -fno-common -fno-rtti  -lobjc) actually is a C++ compiler... no
configure: error: /usr/bin/clang++  -fno-common -fno-rtti  -lobjc failed to compile and link a simple C++ source.
------ config.log ------
; return 0; }
configure:7837: checking for 64-bit OS
configure:7846: /usr/bin/clang -c  -std=gnu99 -Qunused-arguments  conftest.c 1&gt;&amp;#x26;5
configure:8119: checking for -framework ExceptionHandling
configure:8129: /usr/bin/clang -o conftest  -std=gnu99 -fno-common -Qunused-arguments   -lobjc -framework ExceptionHandling conftest.c  1&gt;&amp;#x26;5
configure:8151: checking for -dead_strip option to ld
configure:8162: /usr/bin/clang -o conftest  -std=gnu99 -fno-common -Qunused-arguments   -lobjc -Wl,-dead_strip conftest.c  1&gt;&amp;#x26;5
configure:9034: checking for valid debug flags
configure:9045: /usr/bin/clang -c  -std=gnu99 -fno-common -g -Qunused-arguments  conftest.c 1&gt;&amp;#x26;5
configure:9134: checking whether the C++ compiler (/usr/bin/clang++  -fno-common -fno-rtti  -lobjc) actually is a C++ compiler
configure:9153: /usr/bin/clang++ -o conftest  -fno-common -fno-rtti -Qunused-arguments   -lobjc conftest.C  1&gt;&amp;#x26;5
clang: warning: libstdc++ is deprecated; move to libc++ with a minimum deployment target of OS X 10.9 [-Wdeprecated]
warning: include path for stdlibc++ headers not found; pass &apos;-std=libc++&apos; on the command line to use the libc++ standard library instead [-Wstdlibcxx-not-found]
configure:9147:10: fatal error: &apos;new&apos; file not found
#include &amp;#x3C;new&gt;
         ^~~~~
1 warning and 1 error generated.
configure: failed program was:
#line 9146 &quot;configure&quot;
#include &quot;confdefs.h&quot;
#include &amp;#x3C;new&gt;
int main() {
int *foo = new int;
; return 0; }
configure: error: /usr/bin/clang++  -fno-common -fno-rtti  -lobjc failed to compile and link a simple C++ source.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾ˆæ˜æ˜¾ï¼ŒæŠ¥é”™åŸå› æ˜¯å› ä¸ºæ ‡å‡†åº“ new æ‰¾ä¸åˆ°ï¼ŒåŸå› ä¹Ÿåœ¨äº libstdc++ è¢«æ›¿æ¢äº†ï¼Œä½†æ˜¯å¤©æ€çš„æŠ¥é”™ä¿¡æ¯å†™é”™äº†ã€‚åº”è¯¥åŠ å…¥çš„ flag æ˜¯ &lt;code&gt;-stdlib=libc++&lt;/code&gt; è€Œä¸æ˜¯ &lt;code&gt;-std=libc++&lt;/code&gt;ï¼Œè¿™ä¸€ç‚¹å¾ˆå‘çˆ¹ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åŠ ä¸Šäº†è¿™ä¸ª flag ä»ç„¶ä¸èƒ½ç¼–è¯‘ï¼Œå› ä¸ºåˆæœ‰æŠ¥é”™ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;clang: error: invalid deployment target for -stdlib=libc++ (requires OS X 10.7 or later)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æƒ³äº†åŠå¤©ï¼Œæˆ‘çš„ç³»ç»Ÿä¸æ˜¯ 10.14 å—ï¼Œåæ¥æ‰çŸ¥é“æ˜¯å› ä¸ºè¦è®¾ç½® deployment targetï¼Œå¾ˆå‘çˆ¹ï¼Œæ‰€ä»¥æœ€åè®©æˆ‘ç¼–è¯‘æˆåŠŸçš„å‘½ä»¤æ˜¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-shell&quot;&gt;$ CXXFLAGS=&quot;-stdlib=libc++ -mmacosx-version-min=10.7&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å†™ç¯‡ blog åº†ç¥ä¸€ä¸‹ã€‚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ç†è§£ Scala ä¸­çš„ for è¡¨è¾¾å¼]]></title><link>https://diverse.space/2018/06/understanding-for-comprehansion-in-scala</link><guid isPermaLink="false">https://diverse.space/2018/06/understanding-for-comprehansion-in-scala</guid><pubDate>Sun, 10 Jun 2018 02:58:33 GMT</pubDate><content:encoded>&lt;p&gt;Scala ä¸­çš„ for è¡¨è¾¾å¼éå¸¸å¼ºå¤§ï¼Œç”¨èµ·æ¥å¾ˆç®€å•é¡ºæ‰‹ï¼Œä½†æ˜¯ç†è§£èµ·æ¥å¯èƒ½éœ€è¦ä¸€äº›èƒŒæ™¯çŸ¥è¯†ã€‚è¿™ä¸ª for ä»åå­—ä¸Šçœ‹è®©æˆ‘ä»¬è§‰å¾—å®ƒå¾ˆåƒå‘½ä»¤å¼è¯­è¨€ä¸­çš„é‚£ç§ for statementï¼Œä½†æ˜¯å…¶å® Scala çš„ for æ˜¯éå¸¸å‡½æ•°å¼çš„ï¼Œå®ƒè·Ÿå‘½ä»¤å¼è¯­è¨€ä¸­çš„ for è¯­å¥æ ¹æœ¬ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œå› ä¸ºå®ƒæ ¹æœ¬ä¸æ”¯æŒ break å’Œ continue è¿™äº›è¯­å¥ã€‚&lt;/p&gt;
&lt;p&gt;å®˜æ–¹æ–‡æ¡£æä¾›çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;val twentySomethings = for (user &amp;#x3C;- userBase if (user.age &gt;=20 &amp;#x26;&amp;#x26; user.age &amp;#x3C; 30))
  yield user.name  // i.e. add this to a list
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Scala çš„ for è¡¨è¾¾å¼å€’æ˜¯å¾ˆåƒ Python å’Œ Haskell é‡Œé¢çš„ list comprehensionï¼Œå…¶å®è¿™ä¸ª for è¡¨è¾¾å¼åŸºæœ¬ä¸Šå¯ä»¥ç­‰åŒäº Haskell çš„ list comprehension åŠ ä¸Š do annotation äº†ã€‚ç„¶è€Œ Haskell é‡Œé¢ list comprehension å’Œ do ä¹Ÿæ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œæ‰€ä»¥åŸºæœ¬ç­‰åŒäº for comprehensionã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç†è§£ for ä¹‹å‰ï¼Œéœ€è¦å…ˆäº†è§£ &lt;code&gt;map&lt;/code&gt; å’Œ &lt;code&gt;flatMap&lt;/code&gt;ï¼Œè¿™äº›æ¦‚å¿µåœ¨ Scala å’Œ Haskell ä¸­å¾ˆç›¸ä¼¼ï¼š&lt;/p&gt;
&lt;h2&gt;Map&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;map&lt;/code&gt; å¤§å¤šæ•°äººä¼šç”¨åœ¨ List ä¸Šé¢ï¼Œä½†æ˜¯æ›´å¹¿ä¹‰çš„æ¦‚å¿µä¸Šï¼Œmap å¯ä»¥ç”¨åœ¨ä»»ä½•å¸¦æœ‰ context çš„ç±»å‹ä¸Šé¢ï¼Œä¸ä»…é™äº Listï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// map é€šè¿‡ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥æŠŠ A å…ƒç´ çš„åˆ—è¡¨è½¬æ¢æˆåˆ—è¡¨ B çš„
map(f: A =&gt; B): List[A] =&gt; List[B]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŒç†ï¼Œmap ä¸ä»…å¯ä»¥ç”¨åœ¨ &lt;code&gt;List&lt;/code&gt; ä¸Šé¢ï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨ç±»ä¼¼ Option å’Œ Future è¿™æ ·çš„ç±»å‹ä¸Šé¢ã€‚ä»ç›´è§‚æ„ä¹‰ä¸Šç†è§£ï¼Œmap åŒæ ·å¯ä»¥æŠŠ &lt;code&gt;Option[A]&lt;/code&gt; è½¬æ¢æˆ &lt;code&gt;Option[B]&lt;/code&gt;ï¼ŒæŠŠ &lt;code&gt;Future[A]&lt;/code&gt; è½¬æ¢æˆ &lt;code&gt;Future[B]&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Hasekll é‡Œé¢ï¼Œè¿™ç§æ”¯æŒ map æ“ä½œçš„ç±»å‹ï¼Œå«åš Functorï¼ŒScala é‡Œé¢ä¼¼ä¹æ²¡æœ‰ä¸€ä¸ªåå­—ã€‚&lt;/p&gt;
&lt;h2&gt;FlatMap&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;flatMap&lt;/code&gt; ç†è§£èµ·æ¥åˆ™ç¨å¾®å¤æ‚ä¸€äº›ï¼Œçœ‹ä¸€ä¸‹ List é‡Œé¢çš„ &lt;code&gt;flatMap&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;def flatMap[U](f: T =&gt; List[U]): List[U]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œé¢çš„ &lt;code&gt;f&lt;/code&gt; ä¸å†åƒ &lt;code&gt;map&lt;/code&gt; é‡Œé¢è¿”å›ä¸€ä¸ªæ–°çš„å­ç±»å‹ï¼Œè€Œæ˜¯ï¼Œè¿”å›ä¸€ä¸ªå¸¦æœ‰ context ç±»å‹æœ¬èº«ï¼š &lt;code&gt;List[U]&lt;/code&gt;ã€‚ä¹Ÿå°±æ˜¯è¯´ f å‡½æ•°è¿”å›çš„æ–°ç±»å‹æ˜¯åŒ…å«åœ¨ context é‡Œé¢çš„ã€‚&lt;strong&gt;éœ€è¦æ³¨æ„çš„æ˜¯&lt;/strong&gt;åœ¨è¿™é‡Œï¼Œè¿”å›çš„ç»“æœå¹¶ä¸æ˜¯ List[List[U]]ï¼Œè€Œæ˜¯ä»…ä»…æ˜¯ &lt;code&gt;List[U]&lt;/code&gt; ã€‚é€šè¿‡ &lt;code&gt;flatMap&lt;/code&gt; è¿™ä¸ªåå­—ä¸­çš„ &lt;code&gt;flat&lt;/code&gt; æˆ‘ä»¬ä¹ŸçŸ¥é“ï¼Œæœ€åçš„ç»“æœä¼šæ˜¯æŠŠæ¯ä¸ª list éƒ½æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„æ‹å¹³äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢æåˆ°çš„æ˜¯ List çš„ flatMapï¼ŒåŒæ ·åœ°ï¼Œ&lt;code&gt;Future&lt;/code&gt; ç±»å‹åŒæ ·ä¹Ÿæ˜¯æ”¯æŒ &lt;code&gt;flatMap&lt;/code&gt; çš„ï¼Œå®ƒçš„çš„å‚æ•° &lt;code&gt;f&lt;/code&gt; ç±»å‹æˆ‘ä»¬åº”è¯¥ä¹ŸçŒœåˆ°äº†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;def flatMap[U](f: T =&gt; Future[U]): Future[U]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡ flatMap æˆ‘ä»¬å°±å¯ä»¥åšå¾ˆå¤šäº‹æƒ…äº†ã€‚è¿™ä¸ªæ—¶å€™å‡è®¾æˆ‘ä»¬æœ‰å‡½æ•° &lt;code&gt;fetch1&lt;/code&gt; å’Œ &lt;code&gt;fetch2&lt;/code&gt; ï¼Œéƒ½æ˜¯è¿”å› &lt;code&gt;Future[Response]&lt;/code&gt;ï¼Œå¦‚æœæˆ‘ä»¬è¦å…ˆ fetch1 ç„¶åæ ¹æ® 1 çš„ response æ¥ fetch2 ï¼Œç„¶åæŠŠ 2 çš„ç»“æœæ‰“å°å‡ºæ¥ï¼Œæˆ‘ä»¬è¦æ€ä¹ˆåšå‘¢ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;// å†™æ³•ä¸€
val resp2 = fetch1
.flatMap { resp1 =&gt;
    // do something
    fetch2(resp1.data) // é€šè¿‡ 1 çš„ç»“æœæ¥è¿”å›æ–°çš„ Future
}
.map { resp2 =&gt;
    printf(resp2.data)
    resp2.data
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶åå›åˆ°å¼€å¤´ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ for comprehension æ¥å®Œæˆè¿™ä¸ªäº‹æƒ…ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;// å†™æ³•äºŒ
val resp2 = for {
    resp1 &amp;#x3C;- fetch1()
    resp2 &amp;#x3C;- fetch2(resp1.data)
    printf(resp2.data)
} yield resp2.data
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¶å®å®é™…ä¸Šï¼ŒScala ä¼šæŠŠä¸Šè¿°ä»£ç ç¿»è¯‘æˆä¸ä¸‹é¢ç­‰ä»·çš„æ ·å­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;// å†™æ³•ä¸‰
val resp2 = resp1
.flatMap { resp1 =&gt;
    fetch2(resp2.data)
    .map {
        printf(resp2.data)
        resp2.data
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åªè¦ä½ ä»”ç»†è§‚å¯Ÿï¼Œä½ å°±ä¼šå‘ç°ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œè¿™ä¸‰ç§å†™æ³•çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ç¬¬ä¸€ç§å†™æ³•æœ‰ä»€ä¹ˆç¼ºç‚¹å‘¢ï¼Œç¼ºç‚¹å°±æ˜¯åœ¨ç¬¬äºŒä¸ª &lt;code&gt;flatMap&lt;/code&gt; é‡Œé¢ï¼Œ&lt;code&gt;resp1&lt;/code&gt; å·²ç»ä¸åœ¨ä½œç”¨åŸŸé‡Œé¢äº†ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœä½ è¿˜æƒ³è°ƒç”¨ resp1 å·²ç»ä¸å¯èƒ½äº†ï¼Œä½†æ˜¯å†™æ³•ä¸‰æ˜¯å¯ä»¥çš„ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;// å†™æ³•ä¸‰
val resp2 = resp1
.flatMap { resp1 =&gt;
    fetch2(resp2.data)
    .map {
        printf(resp1.data) // åœ¨è¿™é‡Œä»ç„¶å¯ä»¥è°ƒç”¨ resp1ï¼Œå› ä¸ºå®ƒè¿˜åœ¨ä½œç”¨åŸŸé‡Œé¢
        printf(resp2.data)
        resp2.data
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ ·çœ‹èµ·æ¥å°±è·Ÿ Haskell çš„ Monad å¾ˆæ¥è¿‘äº†ã€‚&lt;/p&gt;
&lt;h2&gt;For è¡¨è¾¾å¼çš„å‡ ç§ç¿»è¯‘æ–¹å¼&lt;/h2&gt;
&lt;p&gt;å…¶å®æ˜ç™½äº† map å’Œ flatMap ä¹‹åï¼Œfor è¡¨è¾¾å¼å¾ˆå®¹æ˜“ç†è§£äº†ã€‚ä½†æ˜¯å®ç°èµ·æ¥è¿˜è¦å‚è€ƒ &lt;a href=&quot;https://docs.scala-lang.org/tutorials/FAQ/yield.html&quot;&gt;for è¡¨è¾¾å¼çš„ç¿»è¯‘æ–¹å¼&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3&gt;If&lt;/h3&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ if è¯­æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;for(x &amp;#x3C;- c; if cond) yield {...}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¼šè¢«ç¿»è¯‘æˆï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;c.withFilter(x =&gt; cond).map(x =&gt; {...})
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“ç„¶ä¼šæœ‰ fallback ï¼ˆå¦‚æœä¸æ”¯æŒ withFilterï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;c.filter(x =&gt; cond).map(x =&gt; {...})
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ—¶å€™å†çœ‹æ–‡ç« å¼€å¤´çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;val twentySomethings = for (user &amp;#x3C;- userBase if (user.age &gt;=20 &amp;#x26;&amp;#x26; user.age &amp;#x3C; 30))
  yield user.name  // i.e. add this to a list
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¼šè¢«ç¿»è¯‘æˆï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;val twentySomethings = userBase
.filter { user =&gt;
    user.age &gt;=20 &amp;#x26;&amp;#x26; user.age &amp;#x3C; 30
}
.map { _.name }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°±å¾ˆå®¹æ˜“ç†è§£äº†&lt;/p&gt;
&lt;h3&gt;èµ‹å€¼è¯­å¥&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;for&lt;/code&gt; è¡¨è¾¾å¼ä¸­åŒæ ·æ”¯æŒèµ‹å€¼è¯­å¥ï¼ˆè¿™é‡Œè¯´çš„æ˜¯ &lt;code&gt;=&lt;/code&gt; ä¸æ˜¯ &lt;code&gt;&amp;#x3C;-&lt;/code&gt;ï¼‰ï¼Œè¿™åœ¨å¤„ç†å¼‚æ­¥è¯·æ±‚çš„æ—¶å€™éå¸¸å¸¸è§ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;val resp2 = for {
    resp1 &amp;#x3C;- fetch1()
    data = doSomething(resp1)
    resp2 &amp;#x3C;- fetch2(data)
    printf(resp2.data)
} yield resp2.data
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ³¨æ„ï¼Œåœ¨ for comprehension ä¸­å†™ &lt;code&gt;=&lt;/code&gt; èµ‹å€¼è¯­å¥å¹¶ä¸éœ€è¦å†™ &lt;code&gt;var&lt;/code&gt; æˆ–è€… &lt;code&gt;val&lt;/code&gt; ï¼Œè‡³äºä¸ºä»€ä¹ˆï¼Œåªè¦çœ‹å®ƒä¼šè¢«ç¿»è¯‘æˆä»€ä¹ˆæ ·å­å°±èƒ½æ˜ç™½ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;val resp2 = for {
    resp1 &amp;#x3C;- fetch1()
    data = doSomething(resp1)
    resp2 &amp;#x3C;- fetch2(data)
    printf(resp2.data)
} yield resp2.data

var resp2 = fetch1()
.map { resp1 =&gt;
    (resp1, doSomething(resp1))
}
.flatMap { 
    case (resp1, data) =&gt;
        fetch2(data)
    .map { resp2 =&gt;
        printf(resp2.data)
        resp2.data
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥è¿™ä¸ªæ—¶å€™å†å†™ &lt;code&gt;val&lt;/code&gt; å’Œ &lt;code&gt;var&lt;/code&gt; å·²ç»æ²¡ä»€ä¹ˆæ„ä¹‰äº†&lt;/p&gt;
&lt;h2&gt;CPS å˜æ¢&lt;/h2&gt;
&lt;p&gt;å…¶å® Scala åšçš„è¿™ä¸ªå˜æ¢æ˜¯ä¸€ç§ CPS(Continuation Passing Style) å˜æ¢ï¼ŒæŠŠä¸€ç³»åˆ—çœ‹ä¸Šå»æƒ³æ˜¯èµ‹å€¼ &lt;code&gt;&amp;#x3C;-&lt;/code&gt; çš„æ“ä½œè½¬æ¢æˆ CPS çš„å½¢å¼ï¼Œè¿™æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Œé€šè¿‡è¿™ç§å˜æ¢ï¼Œmap å’Œ flatMap çš„å‚æ•° f å°±å¯ä»¥æ˜¯ä¸€ä¸ªçº¯ï¼ˆPureï¼‰çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´é€šè¿‡ä¸€ç³»åˆ—çº¯å‡½æ•°çš„ç»„åˆï¼Œå¯ä»¥å®ç°åƒå‘½ä»¤å¼ç¼–ç¨‹é‡Œé¢çš„æœ‰çŠ¶æ€çš„èµ‹å€¼æ“ä½œï¼Œè€Œè¿™äº›æ“ä½œæ˜¯å«æœ‰ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œåƒä¸‹é¢è¿™ç§è°ƒç”¨ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scala&quot;&gt;c1.map(p1 =&gt; p1.map(p2 =&gt; p2.map(p3 =&gt; ...)))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¶å®æ˜¯å°¾é€’å½’è°ƒç”¨ï¼Œç¼–è¯‘å™¨å¯ä»¥ä¸ºæ­¤åšå¾ˆå¤šä¼˜åŒ–ï¼Œæé«˜è¿è¡Œé€Ÿåº¦ã€‚&lt;/p&gt;
&lt;h1&gt;æ€»ç»“&lt;/h1&gt;
&lt;p&gt;for comprehension å…¶å®æ˜¯ä¸€ä¸ªå¾ˆç”œå¾ˆå¥½ç”¨çš„è¯­æ³•ç³–ï¼Œå¯ä»¥å¸®æˆ‘ä»¬çœä¸‹å¾ˆå¤šä»£ç ã€‚æˆ‘ä»¬å½“ç„¶å¯ä»¥é€‰æ‹©ç»§ç»­ç”¨ &lt;code&gt;flatMap&lt;/code&gt; å’Œ &lt;code&gt;map&lt;/code&gt;ï¼Œä½†æ˜¯ for å°±èƒ½ç”¨å¾ˆç®€å•çš„è¯­è¨€å†™å‡ºæ¥ã€‚å½“ç„¶ï¼Œç®€å•çš„èƒŒåæ˜¯æœ‰ä»£ä»·çš„ï¼Œç”¨ for çš„è¿‡ç¨‹ä¸­å°±éœ€è¦ä½¿ç”¨è€…æ˜ç™½è¡¨è¾¾å¼æœ€ç»ˆä¼šè¢«æ€æ ·è½¬æ¢æˆç›¸åº”çš„ &lt;code&gt;flatMap&lt;/code&gt; å’Œ &lt;code&gt;map&lt;/code&gt; ä»£ç ï¼Œè¿™æ ·æ‰èƒ½è®©æˆ‘ä»¬å†™å‡ºç®€æ´çš„ for comprehensionã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘çœŸçš„å¾ˆä½©æœ Scala çš„è®¾è®¡ï¼Œè®©æ•´ä¸ªè¯­è¨€å„ä¸ªéƒ¨åˆ†çš„è®¾è®¡éƒ½éå¸¸å®¹æ˜“å’Œä¼˜é›…åœ°ç»„åˆï¼Œè®¾è®¡å¾—ç›¸å½“åœ°ç²¾å¦™ï¼ŒåŒæ—¶æˆ‘åœ¨å…¶ä¸­ä¹Ÿçœ‹åˆ°äº†ä¸€äº› Haskell çš„å‘³é“ã€‚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[webpack å¦‚ä½•é€šè¿‡ä½œç”¨åŸŸåˆ†ææ¶ˆé™¤æ— ç”¨ä»£ç ]]></title><link>https://diverse.space/2018/05/better-tree-shaking-with-scope-analysis</link><guid isPermaLink="false">https://diverse.space/2018/05/better-tree-shaking-with-scope-analysis</guid><pubDate>Fri, 25 May 2018 14:24:18 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;GSoC 2018 ä¸­ï¼Œæˆ‘çš„é¡¹ç›®å°±åœ¨äºç»™ webpack å®ç°æ·±ä½œç”¨åŸŸåˆ†æï¼ˆDeep Scope Analysisï¼‰ï¼Œä¸»è¦è¿˜æ˜¯ä¸ºäº†æ”¹è¿› webpack çš„ tree-shaking å·¥ä½œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;JS çš„ tree-shaking ä¸€ç›´æ˜¯å‰ç«¯å¼€å‘ä¸­çš„ç—›ç‚¹ï¼Œå¤§å®¶éƒ½åœ¨æƒ³å°½åŠæ³•å‡å°‘æ‰“åŒ…çš„ä»£ç ä½“ç§¯ã€‚Tree shaking æ˜¯ä¸€ä¸ªå¸®åŠ©åœ¨ä¸åŒæ¨¡å—ä¹‹é—´æ¶ˆé™¤æ— ç”¨ä»£ç çš„ featureã€‚åœ¨ç¼–è¯‘åŸç†ä¸­ï¼Œæˆ‘ä»¬æŠŠè¿™é¡¹æŠ€æœ¯å«åš DCE(dead code elimination)ã€‚ä½†æ˜¯ DCE å’Œ tree shaking æœ‰äº›è®¸ä¸åŒï¼ŒæŒ‰ç…§ Tobias çš„è¯´æ³•ï¼Œtree shaking ä¸»è¦åº”ç”¨äºäºæ¨¡å—ï¼ˆmoduleï¼‰ä¹‹é—´ï¼Œç”¨äºå¸®åŠ©è¿›è¡Œ DCEï¼ˆwebpack çš„ DEC é€šè¿‡ uglify å®Œæˆï¼‰ï¼Œrollup çš„ä½œè€…ä¹Ÿæ›¾ç»æåˆ°ï¼Œ tree shaking æ˜¯æ‰“åŒ…çš„è¿‡ç¨‹ä¸­æŠ½å–æœ‰ç”¨çš„éƒ¨åˆ†ï¼Œåˆ«çš„éƒ¨åˆ†åƒæ ‘å¶ä¸€æ ·è½ä¸‹ï¼Œæ‰€ä»¥å« tree shakingã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/vincentdchan/webpack-deep-scope-analysis-plugin&quot;&gt;é¡¹ç›®åœ°å€&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;ä»å‰&lt;/h2&gt;
&lt;p&gt;webpack æœ¬èº«çš„ tree shaking æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯æ‰¾ä¸€ä¸ª import è¿›æ¥çš„å˜é‡æ˜¯å¦åœ¨è¿™ä¸ªæ¨¡å—å†…å‡ºç°è¿‡ï¼Œéå¸¸ç®€å•ç²—æš´ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å¾€å¾€ä½œç”¨ä¸å¤§ï¼Œå› ä¸ºä¸€èˆ¬äººä¸ä¼šå» import ä¸€ä¸ªæ²¡æœ‰ç”¨åˆ°çš„å˜é‡ã€‚æ¯”è¾ƒå¤šçš„æƒ…å†µæ˜¯å¯èƒ½æ›¾ç»å¼•ç”¨è¿‡ï¼Œä½†æ˜¯å¿˜äº†åˆ æ‰ã€‚ç°åœ¨çš„ç¼–è¾‘å™¨å’Œ lint å·¥å…·éƒ½ä¼šæç¤ºä½ å»åˆ æ‰æ— ç”¨çš„å˜é‡ï¼Œæ‰€ä»¥ webpack æœ¬èº«çš„ tree shaking åŠŸèƒ½æ˜¯ä¸å¤Ÿå¼ºå¤§çš„ã€‚&lt;/p&gt;
&lt;script src=&quot;https://gist.github.com/vincentdchan/9ccec2d1b603ef119e473cf285c7fa6b.js&quot;&gt;&lt;/script&gt;
&lt;p&gt;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå˜é‡ &lt;em&gt;isNumber&lt;/em&gt; å¹¶æ²¡æœ‰è¢«å¼•ç”¨åˆ°ï¼Œæ‰€ä»¥ä¼šè¢«æ¶ˆå»ã€‚&lt;/p&gt;
&lt;h2&gt;å¼€ç«¯&lt;/h2&gt;
&lt;p&gt;åœ¨ä»Šå¹´å¹´åˆï¼Œwebpack é¡¹ç›®ä¸‹é¢æœ‰ä¸€ä¸ª &lt;a href=&quot;https://github.com/webpack/webpack/issues/6264&quot;&gt;issue&lt;/a&gt; æåˆ°äº† webpack æ‰“åŒ…äº†å¤šä½™çš„ä»£ç å’Œæ¨¡å—ã€‚ä½†æ˜¯è¿™ä¹Ÿä¸ºä¼˜åŒ– tree-shaking æä¾›äº†ä¸€ä¸ªæ€è·¯ï¼Œå°±æ˜¯æ‰¾åˆ°ä½œç”¨åŸŸä¹‹é—´çš„å…³ç³»ï¼Œæ¥è¿›è¡Œä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/3199950/34681428-28df7576-f49c-11e7-942d-12caa6e905b8.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå…¶å® &lt;em&gt;function2&lt;/em&gt; å’Œæ•´ä¸ª &lt;em&gt;external2&lt;/em&gt; éƒ½å¯ä»¥è¢«æ¶ˆå»ï¼Œå› ä¸º &lt;em&gt;function2&lt;/em&gt; å¹¶æ²¡æœ‰è¢« &lt;em&gt;entry&lt;/em&gt; å¼•ç”¨åˆ°ã€‚ä½†æ˜¯ç›®å‰ webpack çš„æœºåˆ¶ä¸èƒ½åšåˆ°è¿™ä¸€ç‚¹ã€‚å€ŸåŠ©äº webpack å¼ºå¤§çš„æ’ä»¶æè‡´ï¼Œæˆ‘çš„æ’ä»¶å°±å¯ä»¥å¸®åŠ© webpack åšåˆ°ã€‚&lt;/p&gt;
&lt;h2&gt;æˆ‘çš„æ’ä»¶åšäº†ä»€ä¹ˆ&lt;/h2&gt;
&lt;p&gt;æ’ä»¶åŒ…æ‹¬äº†ä¸€ä¸ªä½œç”¨åŸŸåˆ†æå™¨ï¼Œå¯ä»¥åˆ†æä¸€ä¸ªæ¨¡å—é‡Œé¢çš„ä½œç”¨åŸŸï¼Œä»æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸åŒä½œç”¨åŸŸä¹‹é—´å˜é‡çš„å¼•ç”¨å…³ç³»ã€‚å½“æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªä½œç”¨åŸŸæ˜¯å¦ä¼šè¢«ä½¿ç”¨ï¼Œå°±å¯ä»¥å› æ­¤è€Œæ¨æ–­å‡ºè¿™ä¸ªä½œç”¨åŸŸåšå¼•ç”¨çš„å…¶ä»–ä½œç”¨åŸŸæ˜¯å¦ä¹Ÿä¼šè¢«ä½¿ç”¨ã€‚è¿™å°±æ˜¯ä½œç”¨åŸŸåˆ†æå™¨å¸®åŠ©æ¶ˆé™¤æ— ç”¨ä»£ç çš„åŸç†ã€‚&lt;/p&gt;
&lt;h3&gt;ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸ&lt;/h3&gt;
&lt;p&gt;ä¸‹é¢çš„ä»£ç åˆ—ä¸¾äº† JS ä¸­ä¼š&lt;strong&gt;æ–°å»º&lt;/strong&gt;ä¸€ä¸ªä½œç”¨åŸŸçš„ä»£ç ï¼š&lt;/p&gt;
&lt;script src=&quot;https://gist.github.com/vincentdchan/a67ee79011c9c1fbb699a137538dcbe7.js&quot;&gt;&lt;/script&gt;
&lt;p&gt;å¯¹äº ES6 æ¨¡å—æ¥è¯´ï¼Œmodule scope æ˜¯æœ€åº•å±‚çš„ä½œç”¨åŸŸã€‚è€Œå¯¹äºä¸€ä¸ªæ¨¡å—æ¥è¯´ï¼Œ&lt;strong&gt;åªæœ‰ class å’Œ function çš„ä½œç”¨åŸŸæ˜¯å¯ä»¥å¯¼å‡ºåˆ°å…¶ä»–æ¨¡å—çš„&lt;/strong&gt;ã€‚æ‰€ä»¥åœ¨è¿™å¼ éœ€è¦éå†çš„å›¾é‡Œé¢ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ä½œç”¨åŸŸéƒ½å¯ä»¥è¢«å½“ä½œä¸€ä¸ªç‹¬ç«‹çš„éå†ç»“ç‚¹ï¼Œåƒ if-else ä½œç”¨åŸŸå…¶å®æ˜¯å½’å±äºçˆ¶ä½œç”¨åŸŸçš„ã€‚&lt;/p&gt;
&lt;h2&gt;æ’ä»¶çš„å·¥ä½œåŸç†&lt;/h2&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å»åˆ†æä½œç”¨åŸŸä¹‹é—´çš„å¼•ç”¨å…³ç³»ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆéœ€è¦å»åˆ†æä»£ç çš„ä½œç”¨åŸŸã€‚ä»£ç çš„ä½œç”¨åŸŸåˆ†æå»ºç«‹åœ¨ AST(Abstract Syntax Tree) ä¹‹ä¸Šã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å€ŸåŠ©äº†ä¸€ä¸ªå« &lt;a href=&quot;https://github.com/estools/escope&quot;&gt;escope&lt;/a&gt; çš„å·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;è§£æå®Œä¹‹åï¼Œå…¶å®å°±æ˜¯å›¾çš„æ·±åº¦éå†ï¼Œæ‰¾åˆ°é‚£äº›ä½œç”¨åŸŸæ˜¯ä¼šè¢«ä½¿ç”¨åˆ°äº†ï¼Œå“ªäº›æ˜¯å¯ä»¥æ¶ˆå»çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/tree-shaking.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºè¿™ä¸ªæ’ä»¶å¯ä»¥ä»å¯¼å‡ºçš„ä½œç”¨åŸŸä¹‹é—´åˆ†æå‡ºè¿™äº›å¯¼å‡ºçš„ä½œç”¨åŸŸå’Œå¯¼å…¥å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´ã€‚åªè¦çŸ¥é“å“ªäº›å¯¼å‡ºä½œç”¨åŸŸè¢«ä½¿ç”¨çš„åˆ°ï¼Œé‚£ä¹ˆå°±çŸ¥é“å“ªäº›å¯¼å…¥å˜é‡è¢«å¼•ç”¨ï¼Œé‚£äº›æ²¡æœ‰è¢«å¼•ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€æ–¹é¢ï¼Œwebpack æœ¬èº«æ˜¯å¯ä»¥åˆ†æå‡ºæ¨¡å—ä¹‹é—´çš„å˜é‡å¼•ç”¨å…³ç³»çš„ï¼Œä» webpack æˆ‘å¯ä»¥å¾—çŸ¥ä¸€ä¸ªæ¨¡å—å“ªäº›å¯¼å‡ºå˜é‡æ˜¯è¢«ç”¨åˆ°çš„ï¼Œè¿™æ˜¯ webpack 4 çš„æ–° featureã€‚æ‰€ä»¥æˆ‘çš„æ’ä»¶ tap ä¸Šäº† webpack ç›¸åº”çš„ hookï¼Œè·å–è¿™ä¸ªæ¨¡å—ä¸­ä¼šè¢«å…¶ä»–æ¨¡å—å¼•ç”¨çš„å¯¼å‡ºå˜é‡ï¼Œè¿”å›ç»™ webpack å“ªäº›å¼•å…¥çš„å˜é‡è¢«ç”¨åˆ°ï¼Œè¿™æ · webpack å°±å¯ä»¥æ ¹æ®æˆ‘çš„æ’ä»¶çš„ä¿¡æ¯è¿›è¡Œæ›´å®Œå–„çš„ tree-shakingã€‚&lt;/p&gt;
&lt;h2&gt;Edge cases&lt;/h2&gt;
&lt;p&gt;å®é™…ä¸Šï¼ŒJavaScript çš„åˆ†ææœ‰å¾ˆå¤š Edge cases ä¼šå¯¼è‡´ä»£ç ä¸ä¼šè¢«æ¶ˆå»ï¼Œè¿™é‡Œåˆ—ä¸¾ä¸€äº›æ¯”è¾ƒå¸¸è§çš„ï¼š&lt;/p&gt;
&lt;p&gt;åŒæ—¶æä¾›ä¸€ä¸ª &lt;a href=&quot;https://vincentdchan.github.io/webpack-deep-scope-demo/&quot;&gt;Demo&lt;/a&gt; æ¥ç»™å¤§å®¶å°è¯•ã€‚&lt;/p&gt;
&lt;h3&gt;æ ¹ä½œç”¨åŸŸçš„å¼•ç”¨&lt;/h3&gt;
&lt;script src=&quot;https://gist.github.com/vincentdchan/c8cbb1198bfef580c216343e1ef4eedf.js&quot;&gt;&lt;/script&gt;
&lt;p&gt;åœ¨æ ¹ä½œç”¨åŸŸå¼•ç”¨åˆ°çš„ä½œç”¨åŸŸä¸ä¼šè¢«æ¶ˆé™¤ã€‚&lt;/p&gt;
&lt;h3&gt;ç»™å˜é‡é‡æ–°èµ‹å€¼ ğŸ‘&lt;/h3&gt;
&lt;script src=&quot;https://gist.github.com/vincentdchan/f7f94c8e28bf8cc29e0e691371012783.js&quot;&gt;&lt;/script&gt;
&lt;p&gt;å› ä¸ºç¼ºå°‘&lt;a href=&quot;https://en.wikipedia.org/wiki/Data-flow_analysis&quot;&gt;æ•°æ®æµåˆ†æ&lt;/a&gt;ï¼Œå¯¹å˜é‡é‡æ–°èµ‹å€¼çš„ä½œç”¨åŸŸä¸ä¼šè¢«æ¶ˆå»ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå› ä¸ºå¯¹ &lt;em&gt;fun&lt;/em&gt; å˜é‡è¿›è¡Œäº†é‡æ–°èµ‹å€¼ï¼Œæ‰€ä»¥ &lt;em&gt;isNull&lt;/em&gt; æ— è®ºå¦‚ä½•éƒ½ä¼šè¢«å¼•å…¥ã€‚&lt;/p&gt;
&lt;h3&gt;çº¯å‡½æ•°è°ƒç”¨ ğŸ‘&lt;/h3&gt;
&lt;script src=&quot;https://gist.github.com/vincentdchan/473b219b3cbbc64c903e9a1bf100e791.js&quot;&gt;&lt;/script&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªåŒ¿åå‡½æ•°è¢«åŒ…åœ¨ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¸­ï¼Œé‚£ä¹ˆå…¶å®è¿™ä¸ªæ’ä»¶æ˜¯æ— æ³•åˆ†æçš„ï¼Œåƒä¸Šé¢çš„ä¾‹å­ã€‚ä½†æ˜¯å¦‚æœåŠ ä¸Šäº† PURE æ³¨é‡Šçš„è¯ï¼Œè¿™ä¸ªæ’ä»¶ä¼šæŠŠè¿™ä¸ªå‡½æ•°è°ƒç”¨å½“ä½œä¸€ä¸ªç‹¬ç«‹çš„åŸŸï¼Œæ‰€ä»¥åœ¨ä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œtree-shaking æ˜¯ä¼šç”Ÿæ•ˆçš„ã€‚&lt;/p&gt;
&lt;h2&gt;å®é™…ä½¿ç”¨çš„è¿‡ç¨‹ä¸­åº”è¯¥æ³¨æ„ä»€ä¹ˆ&lt;/h2&gt;
&lt;p&gt;æ·±ä½œç”¨åŸŸåˆ†æåŸç†å¾ˆç®€å•ï¼Œå®ç°èµ·æ¥ä¹Ÿä¸å¤æ‚ï¼Œä½†æ˜¯çœŸçš„è¦ä½¿ç”¨å†å®é™…é¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œå´æœ‰å¾ˆå¤šè¦æ³¨æ„çš„åœ°æ–¹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸€ã€å¿…é¡»ä½¿ç”¨ ES6 çš„ import/export æ¨¡å—æœºåˆ¶ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®æ•´ä¸ªæ·±ä½œç”¨åŸŸåˆ†æéƒ½æ˜¯åŸºäº ES6 æ¨¡å—å®Œæˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ·±ä½œç”¨åŸŸåˆ†ææ— æ³•åˆ†æ CommonJS å’Œ AMD ç­‰ç­‰æ¨¡å—è§„èŒƒã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±è¦æ±‚é¡¹ç›®ä¸­å¼•ç”¨çš„æ¨¡å—éƒ½éµå¾ª ES6 çš„è§„èŒƒï¼Œæ¯”å¦‚ä½¿ç”¨ lodash-es ä»£æ›¿ lodashã€‚å¦å¤–å°±æ˜¯è¦æ³¨æ„ babel-loader å’Œ TypeScript çš„è®¾ç½®ï¼Œæ˜¯å¦ä¼šæŠŠä»£ç è½¬æ¢åˆ° ES5 è¯­æ³•ï¼Œå¯¼è‡´æ·±ä½œç”¨åŸŸåˆ†æå¤±æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;äºŒã€å­¦ä¼šä½¿ç”¨ PURE æ³¨é‡Šã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç”±äº JS è¯­æ³•çš„å¤æ‚ç¨‹åº¦ï¼Œwebpack æ²¡æœ‰æ‰“ç®—ç»™ JS å®ç°æ•°æ®æµåˆ†æï¼Œæ‰€ä»¥æ’ä»¶æ˜¯æ— æ³•çŸ¥é“ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ˜¯å¦å…·æœ‰å‰¯ä½œç”¨çš„ã€‚æ‰€ä»¥å¯¹äºä¸€äº›å¯¼å‡ºæ¨¡å—ï¼Œå¦‚æœæ˜¯çº¯çš„å‡½æ•°è°ƒç”¨ï¼Œåˆ™éœ€è¦åŠ ä¸Š &lt;code&gt;/*@__PURE__*/&lt;/code&gt; æ³¨é‡Šæ¥è¡¨æ˜è¿™ä¸ªå‡½æ•°æ˜¯ pure çš„ï¼Œè¿™æ˜¯ &lt;a href=&quot;https://github.com/mishoo/UglifyJS2&quot;&gt;Uglify&lt;/a&gt; ä½¿ç”¨çš„æ–¹æ³•ã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸å…³çš„ babel æ’ä»¶è¿›è¡Œæ‰¹é‡æ·»åŠ ã€‚&lt;/p&gt;
&lt;h1&gt;æ€»ç»“&lt;/h1&gt;
&lt;p&gt;å…¶å®æˆ‘è¿™æ’ä»¶çš„å®ç°æ˜¯å½’æ ¹äº ES6 ä¸­è‰¯å¥½çš„ import/export è¯­æ³•çš„è®¾è®¡çš„ã€‚ç›¸ä¿¡å¾ˆå¤šå‰ç«¯å¤§ä½¬éƒ½æåˆ°ï¼Œå°±æ˜¯æ¨¡å—çš„è®¾è®¡ä¸€å®šè¦åˆç†ã€‚tree shaking å†å¼ºå¤§å®ƒä¹Ÿåªæ˜¯ä¸€ä¸ªç¼–è¯‘å™¨çš„å·¥å…·ï¼Œå¦‚æœæ¨¡å—è®¾è®¡ä¸åˆç†ï¼Œå®ƒä¸€æ ·ä¼šåœ¨æ‰“åŒ…çš„æ—¶å€™å¼•å…¥å¾ˆå¤šæ— ç”¨çš„ä»£ç ã€‚ä¸€ä¸ªåˆç†è®¾è®¡çš„æ¨¡å—ä¸€å®šèƒ½å€ŸåŠ© tree shaking æœºåˆ¶åªå¼•å…¥å®ƒéœ€è¦çš„ä»£ç ã€‚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[GSoC ä¹‹æ—…]]></title><link>https://diverse.space/2018/04/beginning_gsoc_2018</link><guid isPermaLink="false">https://diverse.space/2018/04/beginning_gsoc_2018</guid><pubDate>Sun, 29 Apr 2018 14:16:00 GMT</pubDate><content:encoded>&lt;p&gt;æœ‰å¹¸è¢« &lt;a href=&quot;https://webpack.github.io&quot;&gt;webpack&lt;/a&gt; é€‰ä¸­å‚åŠ ä»Šå¹´çš„ GSoCï¼Œè¿™æ¬¡çš„ GSoC æˆ‘ä¸»è¦è´Ÿè´£å®ç° Deep Scope Analysisï¼Œè¿™ä¸ªæœ€åä¼šè¢«ç”¨åˆ°æœ€æ–°ç‰ˆæœ¬çš„ webpack é‡Œé¢ç”¨äº Tree Shaking&lt;/p&gt;
&lt;p&gt;Github é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/vincentdchan/webpack-deep-scope-analysis-plugin&quot;&gt;webpack-deep-scope-analysis-plugin&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ® webpack çš„è¦æ±‚ï¼Œæˆ‘ä¼šæŠŠ GSoC æœŸé—´å‘ç°çš„äº‹æƒ…è®°å½•åœ¨ Medium&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://medium.com/webpack/better-tree-shaking-with-deep-scope-analysis-a0b788c0ce77&quot;&gt;&lt;strong&gt;Better tree shaking with deep scope analysis&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Hereâ€™s my project in GSoC 2018: Improve tree-shaking for webpack, a widely used JS code bundler.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://medium.com/webpack/my-story-of-gsoc-2018-beginning-4c98d8966bfe&quot;&gt;&lt;strong&gt;My story with GSoC 2018: Beginning&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This is the first part of my stories with GSoC 2018. I will tell my personal experiences and all the things happened with GSoC 2018 in the series.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://vincentdchan.github.io/webpack-deep-scope-demo/&quot;&gt;&lt;strong&gt;Deep Scope Analysis Demo&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ä¸ªç®€æ˜“çš„ç”¨äºæµ‹è¯•åˆ†æç»“æœçš„ demo&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[åˆçª¥ Racketï¼šè§£æä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼]]></title><link>https://diverse.space/2018/01/parsing-math-expression-by-racket</link><guid isPermaLink="false">https://diverse.space/2018/01/parsing-math-expression-by-racket</guid><pubDate>Sun, 28 Jan 2018 19:09:00 GMT</pubDate><content:encoded>&lt;p&gt;å½“ Haskell è¿™äº›é™æ€ç±»å‹çš„å‡½æ•°å¼è¯­è¨€ç©ä¹…äº†ï¼Œå°±æƒ³å°è¯•ä¸€ä¸‹åŠ¨æ€ç±»å‹çš„å‡½æ•°å¼è¯­è¨€ï¼Œæ¯”å¦‚ Lispï¼Œæœ€å¤è€çš„ç¼–ç¨‹è¯­è¨€ä¹‹ä¸€ã€‚ä¸è¿‡ç°åœ¨å†™ Lisp æ˜¯ä¸ç°å®ï¼Œå› ä¸ºåŸå§‹çš„ Lisp æ˜¯ dynamic scope çš„ï¼Œå†™èµ·æ¥ä¼šå¼‚å¸¸ç—›è‹¦ã€‚æ‰€ä»¥æˆ‘æ‰“ç®—ä» Lisp çš„ä¸€äº›æ¯”è¾ƒç°ä»£æ–¹è¨€ä¸‹æ‰‹ï¼Œæ¯”å¦‚è¯´ Racket è¿™ç§å¹¿å—èµèª‰çš„è¯­è¨€ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹äº†ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£ä¹‹åæ„Ÿè§‰è¿˜æ˜¯åº”è¯¥å†™ç‚¹ä»€ä¹ˆå®é™…çš„ä¸œè¥¿æ„Ÿå—ä¸€ä¸‹ï¼Œä¸ªäººæ¯”è¾ƒå–œæ¬¢å†™æ•°å­¦è¡¨è¾¾å¼è§£æå™¨äº†ã€‚ä¹‹å‰å†™è¿‡ä¸€ç¯‡ã€Œ&lt;a href=&quot;/2017/10/parsing-math-expression-by-haskell/&quot;&gt;åˆçª¥Haskellï¼šè§£æä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼&lt;/a&gt;ã€ã€‚æ‰€ä»¥è¿™æ¬¡æ‰“ç®—ç”¨ Racket å†™è§£æä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;Racket ä¸æ˜¯ä¸€ä¸ªâ€œçº¯â€çš„è¯­è¨€ï¼Œæ‰€ä»¥åœ¨ Racket é‡Œé¢å†™æœ‰å‰¯ä½œç”¨çš„ä»£ç æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œè¯´ä¸å®šè¿˜ä¼šæœ‰æ›´é«˜çš„æ•ˆç‡ã€‚ä½†æ˜¯è¿™æ¬¡æˆ‘æ²¡æœ‰è¿™ä¹ˆåšï¼Œå› ä¸ºå—åˆ° Haskell çš„å½±å“ï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯ç”¨â€œçº¯â€å‡½æ•°å¼çš„æ–¹æ³•å»å®ç°ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scheme&quot;&gt;(define (char-&gt;op ch)
  (cond
    [(char=? ch #\+) &apos;add]
    [(char=? ch #\-) &apos;sub]
    [(char=? ch #\*) &apos;mul]
    [(char=? ch #\/) &apos;div]))

(struct token (type value)
  #:prefab)

(define (tokenizer content)
  (letrec (
    [char-list (string-&gt;list content)]
    [my-tokenizer (lambda (reading-buffer number-buffer token-buffer)
      (if (null? reading-buffer)
        (if (null? number-buffer)
          token-buffer ;;; æ‰€æœ‰å­—ç¬¦éƒ½å·²ç»è§£æå®Œæ¯•
          (cons  ;;; è¿˜æœ‰ number-buffer çš„å­—ç¬¦ä¸²
            (token &apos;number 
              (string-&gt;number (list-&gt;string (reverse number-buffer)))) 
            token-buffer))
        (let (
          [first-char (car reading-buffer)]
          [buffer-tail (cdr reading-buffer)]
        ) (if (char-numeric? first-char) ;;; å½“å‰å­—ç¬¦æ˜¯ä¸€ä¸ªæ•°å­—
              (my-tokenizer buffer-tail (cons first-char number-buffer) token-buffer)
              (if (null? number-buffer)
                (let (
                  [current-token (token &apos;operator (char-&gt;op first-char))])
                  (my-tokenizer buffer-tail (list) (cons current-token token-buffer)))
                (let (
                  [number-token 
                    (token &apos;number 
                      (string-&gt;number 
                        (list-&gt;string 
                          (reverse number-buffer))))]
                ) (my-tokenizer 
                    reading-buffer 
                    (list) 
                    (cons number-token token-buffer))))))))]
  ) (my-tokenizer char-list (list) (list))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ä¸Šä»£ç å®ç°äº†ä¸€ä¸ª tokenizerï¼Œæ˜¯ç”¨å°¾é€’å½’çš„æ–¹æ³•æ¥å®ç°çš„ã€‚&lt;/p&gt;
&lt;p&gt;Lisp çš„æ‹¬å·è¯­æ³•ä¸€ç›´é¥±å—äº‰è®®ï¼Œä½†æ˜¯è¿™æ ·åšä¸æ˜¯æ²¡æœ‰å¥½å¤„çš„ï¼Œå°±æ˜¯æ•´ä¸ª Lisp å†™èµ·æ¥å…¶å®æ²¡æœ‰å¤ªå¤šå¤æ‚çš„è¯­æ³•ï¼Œè€Œä¸”è¯­æ³•éƒ½æ˜¾å¾—å¾ˆä¸€è‡´ï¼Œå¾ˆå®¹æ˜“ç»„åˆï¼Œè€Œä¸” Racket æœ‰å¾ˆå¼ºçš„å®ç¼–ç¨‹èƒ½åŠ›ï¼Œå…³äºè¿™ç‚¹æˆ‘è¿˜æ²¡æœ‰äº†è§£ã€‚æœ‰äººæŠŠ Lisp ç†è§£æˆæ‰‹å†™ AST(Abstract Syntax Tree)ï¼Œè¿™ç§è¯´æ³•æˆ‘è§‰å¾—ä¹Ÿæ²¡æœ‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬çš„ç±» C è¯­è¨€çš„å˜é‡åå–œæ¬¢ç”¨ä¸‹åˆ’çº¿æˆ–è€…é©¼å³°æ ‡è®°æ³•æ¥åŒºåˆ†ï¼Œè€Œåœ¨ Racket é‡Œé¢ï¼Œåˆ™å¯ä»¥ç”¨ &lt;em&gt;this-is-a-variable&lt;/em&gt; è¿™ç§å°çŸ­æ æ¥è¡¨ç¤ºï¼Œä¸ªäººè§‰å¾—çœ‹ä¸Šå»è¿˜æ˜¯å¾ˆèˆ’æœçš„ã€‚å¦ä¸€æ–¹é¢ï¼Œå¾ˆå¤šæ ‡ç‚¹ç¬¦å·ä¹Ÿå¯ä»¥ç”¨æ¥ä½œä¸ºå˜é‡åï¼Œæ¯”å¦‚ &lt;em&gt;string?&lt;/em&gt; æ˜¯ä¸€ä¸ªç”¨æ¥åˆ¤æ–­å˜é‡æ˜¯å¦ä¸º &lt;em&gt;string&lt;/em&gt; çš„å‡½æ•°ã€‚æ¯”å¦‚ &lt;em&gt;string-&gt;numer&lt;/em&gt; ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²è½¬æ•°å­—çš„å‡½æ•°ï¼Œä¸ªäººæ„Ÿè§‰éå¸¸ç›´è§‚ã€‚&lt;/p&gt;
&lt;p&gt;å’Œ Haskell ç›¸æ¯”èµ·æ¥ä¼šéº»çƒ¦ä¸€ç‚¹çš„åœ°æ–¹å°±æ˜¯è¦è‡ªå·±å»åˆ¤æ–­å˜é‡çš„ç±»å‹ï¼Œä½†æ˜¯è¿™ä¹Ÿæ„å‘³ç€ç»™è¯­è¨€æä¾›æ›´å¤§çš„çµæ´»æ€§ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-scheme&quot;&gt;(define (get-precedence x) 
  (match x
    [&apos;add 1]
    [&apos;sub 1]
    [&apos;mul 2]
    [&apos;div 2]))

(define (eval tokens)
  (letrec (
    [get-handler (lambda (op)
                  (match op
                    [&apos;add +]
                    [&apos;sub -]
                    [&apos;mul *]
                    [&apos;div /]))]
    [my-eval (lambda (tokens num-stack op-stack)
                (if (null? tokens)
                  (match op-stack
                    [null (car num-stack)]
                    [(cons top-op op-stack-tail)
                      (let* 
                        (
                          [num1 (car num-stack)]
                          [num2 (car (cdr num-stack))]
                          [num-stack-tail (cdr (cdr num-stack))]
                          [handler (get-handler top-op)]
                          [result (handler num1 num2)]
                        )
                        (my-eval (list) (cons result num-stack-tail) op-stack-tail))])
                  (let* (
                    [next-op (token-value (car tokens))]
                    [next-number (token-value (car (cdr tokens)))]
                    [tokens-tail (cdr (cdr tokens))]
                  ) (match op-stack
                      [null 
                        (my-eval 
                          tokens-tail 
                          (cons next-number num-stack) 
                          (cons next-op op-stack))]
                      [(cons top-op op-stack-tail)
                        (let* (
                            [op-stack-tail (cdr op-stack)]
                            [top-op (car op-stack)]
                            [top-op-precedence (get-precedence top-op)]
                            [next-op-precedence (get-precedence next-op)]
                          ) (if (&gt; next-op-precedence top-op-precedence)
                              (my-eval 
                                tokens-tail 
                                (cons next-number num-stack) 
                                (cons next-op op-stack))
                              (let* (
                                [num1 (car num-stack)]
                                [num2 (car (cdr num-stack))]
                                [num-stack-tail (cdr (cdr num-stack))]
                                [handler (get-handler top-op)]
                                [result (handler num1 num2)]
                              ) (my-eval tokens (cons result num-stack-tail) op-stack-tail))))]))))]
    [num (token-value (car tokens))]
    [token-tail (cdr tokens)]
  ) (my-eval token-tail (list num) (list))))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸Šè¿°ä»£ç å®šä¹‰äº†ä¸€ä¸ª eval å‡½æ•°ï¼Œç”¨ä¼˜å…ˆçº§è§£æçš„æ–¹æ³•å»è§£æä¸Šé¢å†™çš„å‡½æ•°ç”Ÿæˆçš„ tokens&lt;/p&gt;
&lt;p&gt;ä»£ç å†™èµ·æ¥ä¼šæ¯” Haskell ç‰ˆæœ¬çš„ç¨é•¿ä¸€ç‚¹ï¼Œä½†æ˜¯ä¸ªäººæ„Ÿè§‰éå¸¸æ¸…æ™°ï¼Œè¯­æ³•ä¹Ÿå¾ˆä¸€è‡´å’Œæ¼‚äº®ã€‚ä¸ªäººæ„Ÿè§‰æ˜¯ Racket ç¡®å®æ˜¯ä¸€é—¨éå¸¸æ¼‚äº®çš„è¯­è¨€ï¼Œä¹Ÿæ²¡æœ‰åƒ Haskell ç©å„ç§æ¦‚å¿µè¿™ä¹ˆçƒ§è„‘ï¼Œè¿˜æ˜¯åŠ¨æ€ç±»å‹çš„ï¼Œå¹³æ—¶å¨±ä¹ä¸€ä¸‹å¼€æ‹“ä¸€ä¸‹çœ¼ç•Œæ„Ÿè§‰éå¸¸å¥½ã€‚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[å…³äºå‡½æ•°å¼]]></title><link>https://diverse.space/2017/11/some-opinions-about-fp</link><guid isPermaLink="false">https://diverse.space/2017/11/some-opinions-about-fp</guid><pubDate>Mon, 13 Nov 2017 12:54:18 GMT</pubDate><content:encoded>&lt;p&gt;æ­¤ç¯‡åšæ–‡æ•´ç†äº†æˆ‘å’Œ &lt;a href=&quot;http://walkerlala.github.com/&quot;&gt;walkerlala&lt;/a&gt; å…³äºå‡½æ•°å¼ç›¸å…³é—®é¢˜çš„è®¨è®º&lt;/p&gt;
&lt;p&gt;Vincent Chan&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘è§‰å¾—å‡½æ•°å¼å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯ Immutableï¼Œä½¿å¾—æ¯ä¸€æ¬¡æ›´æ”¹éƒ½è¦é‡æ–°ç”Ÿæˆä¸€æ¬¡æ•´ä¸ªæ•°æ®ç»“æ„ï¼ˆå½“ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–è¯‘å™¨ä¼˜åŒ–æ¥å‡å°‘æŸäº›ç”Ÿæˆï¼‰ï¼Œä½†æ˜¯immutable ä¹Ÿä½¿å¾—æ•´ä¸ªç¨‹åºçš„çŠ¶æ€å¯ä»¥è¢«è®°å½•å’Œæ›´æ”¹ã€‚æˆ‘ä¹‹å‰å†™å‰ç«¯çš„æ—¶å€™å°±å°è¯•äº† Redux + React è¿™ç§æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼å¾ˆæœ‰æ„æ€ï¼Œæˆ‘åˆšå†™èµ·æ¥çš„æ—¶å€™è§‰å¾—è¶…çº§åˆ«æ‰­ï¼Œå†™äº†å¾ˆå¤šæ— ç”¨çš„ä»£ç ã€‚ä½†æ˜¯å½“æˆ‘å¼€å§‹ç€æ‰‹ç”¨å®ƒæ¥å†™ä¸€ä¸ªå‰ç«¯é¡¹ç›®çš„æ—¶å€™ï¼Œæˆ‘å¼€å§‹ä½“ä¼šåˆ°äº†è¿™é‡Œé¢çš„æ€æƒ³ï¼ˆè™½ç„¶æˆ‘ä»ç„¶è§‰å¾—å¾ˆæ¶å¿ƒå’Œåˆ«æ‰­ï¼Œå› ä¸ºå®ƒå°è¯•ç”¨ js æ¥å†™å‡½æ•°å¼)ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“ html ç•Œé¢å…¶å®å°±æ˜¯ä¸€é¢—å¾ˆåºå¤§çš„æ ‘ï¼Œæœ‰å¾ˆå¤š html èŠ‚ç‚¹ï¼Œè¿™äº›html èŠ‚ç‚¹é‡Œé¢æœ‰å¾ˆå¤šå­èŠ‚ç‚¹ï¼Œæ¯ä¸ªå­èŠ‚ç‚¹åˆæœ‰è‡ªå·±çš„å±æ€§ï¼ˆattributesï¼‰ã€‚å½“æˆ‘ä»¬ä»¥å‰å†™çš„ jQuery ä»£ç éƒ½åœ¨å¹²ä»€ä¹ˆï¼Ÿå°±æ˜¯ç»‘å®šä¸€ä¸ªèŠ‚ç‚¹çš„äº‹ä»¶ï¼Œç„¶åæ›´æ”¹å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚æƒ³æƒ³çœ‹ï¼Œæˆ‘ç›¸ä¿¡ä½ å†™è¿‡ jQueryï¼Œæˆ‘ä»¬å…ˆåœ¨è¿™ä¸ªåºå¤§çš„ document æ ‘é‡Œé¢ query åˆ°èŠ‚ç‚¹ï¼Œæ¯”å¦‚ä¸€ä¸ª buttonï¼Œç„¶åæˆ‘ä»¬ç›‘å¬å®ƒçš„click äº‹ä»¶ï¼Œå½“è¿™ä¸ªäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæˆ‘ä»¬ query å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯”å¦‚ä¸€ä¸ªlabelï¼Œç„¶åä¿®æ”¹é‡Œé¢çš„å†…å®¹ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä»¥å‰ç”¨ jQuery åšçš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;è€Œ Redux+React çš„äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼ŒReact ç»´æŠ¤ç€ä¸€ä¸ª js çš„å‡çš„ document treeï¼Œè¿™æ£µæ ‘å’ŒçœŸæ­£çš„ document tree æ¯”èµ·æ¥æ˜¯å¾ˆè½»é‡çº§çš„ï¼Œä¹Ÿå¾ˆå¿«ï¼Œç„¶åé€šè¿‡è¿™é¢—è™šæ‹Ÿçš„æ ‘å»ç”ŸæˆçœŸçš„ document æ ‘ã€‚æ¯å½“ä¸€ä¸ªçŠ¶æ€æ”¹å˜äº†ï¼Œç„¶åï¼Œé‡æ–°ç”Ÿæˆä¸€é¢—è™šæ‹Ÿæ ‘ï¼Œç„¶åå’Œè€çš„è™šæ‹Ÿæ ‘åš diffï¼Œç„¶åæ›´æ–°çœŸçš„ DOMã€‚è¿™ç§åšæ³•çœ‹èµ·æ¥å¾ˆæŠ˜è…¾ï¼Œä½†æ˜¯å´æœ‰å®ƒçš„ç”¨å¤„ï¼šä»€ä¹ˆçŠ¶æ€å°±å¯¹åº”æ€æ ·çš„ DOMï¼Œä¹Ÿå°±æ˜¯ä½ çŠ¶æ€æ²¡é”™ï¼Œä½ ç•Œé¢è‚¯å®šå°±æ²¡é”™ã€‚æƒ³æƒ³ä¹‹å‰ jQuery çš„åŠæ³•ï¼Œé€»è¾‘å¤šèµ·æ¥ï¼Œä½ æ€ä¹ˆä¿è¯çŠ¶æ€ä¸€å®šæ˜¯ä½ è„‘ä¸­çš„é‚£æ ·ã€‚é‚£æˆ‘ä»¬æ€ä¹ˆç®¡ç†è¿™ä¸ªçŠ¶æ€å‘¢ï¼Ÿè¿™é‡Œå°±ç”¨ Redux äº†ï¼š&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¯å½“æˆ‘ä»¬è¦æ”¹å˜ä¸€ä¸ªçŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬å°±æ˜¯è¦ sending a messageï¼Œè¿™ä¸ªmessage æ˜¯ä¸€ä¸ªæ•°æ®ï¼Œå‘Šè¯‰ redux æˆ‘è¦æ›´æ”¹ä»€ä¹ˆï¼Œåˆ é™¤ä»€ä¹ˆï¼Œæ·»åŠ ä»€ä¹ˆâ€¦â€¦ç„¶åæˆ‘ä»¬ä¼šå®šä¹‰ä¸€ä¸ª reducerï¼Œreducer çš„ä½œç”¨å°±æ˜¯é€šè¿‡ä¸€é¢—æ—§çš„çŠ¶æ€æ ‘ï¼Œæ¥æ”¶æ¶ˆæ¯ä¹‹åï¼Œé€šè¿‡æ¶ˆæ¯æ¥ç”Ÿæˆä¸€é¢—æ–°çš„çŠ¶æ€æ ‘ï¼Œç„¶åæŠŠæ–°çš„çŠ¶æ€æ ‘äº¤ç»™React ç”Ÿæˆæ–°çš„è™šæ‹Ÿ document æ ‘ï¼Œç„¶åå†åš diffï¼Œç„¶åæ›´æ–°è§†å›¾ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆšæ‰ jQuery åšçš„äº‹æƒ…ï¼Œæˆ‘ç°åœ¨ç”¨ Redux+React çš„æ–¹æ³•é‡æ–°åšä¸€éï¼šæŠŠæŸä¸ªæŒ‰é’®ç»‘å®šæŸä¸ª meesageï¼Œå½“ç”¨æˆ·æŒ‰ä¸‹æŸä¸ªæŒ‰é’®ï¼Œå°±å‘é€ä¸€ä¸ª messageï¼Œå‘Šè¯‰ Redux è¦æ›´æ–°æŸä¸ª label çš„å€¼ï¼ŒRedux æ ¹æ® message é‡æ–°ç”Ÿæˆæ–°çš„çŠ¶æ€æ ‘ï¼ŒåŒ…å«äº†æ–°çš„ label å€¼ï¼Œç„¶åç”Ÿæˆæ–°çš„è™šæ‹Ÿ DOM æ ‘ï¼Œç„¶åå’Œæ—§çš„æ¯”è¾ƒï¼Œåš diffï¼Œç„¶åæ›´æ–°çœŸæ­£çš„ DOMã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ä½ å¼€å§‹ç”¨ Redux+React é‡æ–°å†™ä¸Šé¢çš„æµç¨‹çš„æ—¶å€™ï¼Œä½ ä¼šæ²‰æµ¸åœ¨å¾ˆå¤šç»†èŠ‚é‡Œé¢ï¼Œå› ä¸ºè¦è§£å†³å¾ˆå¤šé—®é¢˜ï¼Œä½†æ˜¯ä½ ç®€åŒ–è¿™ä¸ªæ¨¡å‹ï¼Œå‘ç°è¿™å°±æ˜¯ FP çš„æ€æƒ³ï¼Œè€Œè¿™ç§æ€æƒ³æ¥æºäº Elmï¼Œè¿™æ˜¯ä¸€ä¸ª Haskell å†™æˆçš„è¯­è¨€ï¼Œè¯­æ³•æ˜¯ä»¿Haskell çš„ï¼Œå¯ä»¥ç¼–è¯‘æˆ js ä»£ç ï¼Œè€Œè¿™é—¨è¯­è¨€æ‰€å®ç°çš„ï¼Œå°±æ˜¯åˆšæ‰æ‰€è¯´çš„Redux+React æ¶æ„ï¼Œå½“æˆ‘ä»¬ç”¨ Elm å†™ä¸Šé¢è¿™ä¸€åˆ‡çš„æ—¶å€™ï¼Œä½ ä¼šå‘ç°ï¼Œè¿™ç§åšæ³•ç”¨FPè¯­è¨€å»åšæ˜¯å¤šä¹ˆè‡ªç„¶ï¼ŒReact+Redux å‡ ç™¾è¡Œä»£ç æ‰åšå¥½çš„äº‹æƒ…ï¼Œç”¨Elmå¯ä»¥ç”¨ä¸åˆ°ä¸€ç™¾è¡Œå†™å‡ºæ¥ï¼Œå»ºè®®ä½ å»å®˜ç½‘çœ‹çœ‹ï¼Œä»£ç çœŸçš„éå¸¸æ¼‚äº®ã€‚æˆ‘è§‰å¾—å†™ Redux+React ç®€ç›´å°±æ˜¯åœ¨äººå·¥ç¼–è¯‘ Elm ä»£ç ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;è‡³äºä¸ºä»€ä¹ˆ Elm æ²¡æœ‰ç«èµ·æ¥ï¼Œè€Œ Redux+React ç«äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¹Ÿæ˜ç™½ï¼ŒRedux+React æ˜¯ç”¨ js å†™çš„ï¼Œå¯ä»¥å’Œç°æœ‰çš„ä»£ç å¾ˆå¥½çš„ç»“åˆï¼Œè€Œ Elm è¦é‡å†™ä»£ç ï¼ŒHaskell è¯­æ³•ä¸€èˆ¬äººä¹Ÿå¾ˆéš¾æ¥å—ï¼ŒåŠ ä¸Š React æœ‰ Facebook çš„çˆ¹ï¼ˆæ‘Šæ‰‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Yubin Ruan&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Hmm... å¯¹æˆ‘æ¥è¯´ï¼ŒFP çš„ Immutable çš„å¥½å¤„æœ‰ä¸¤ç§ï¼š&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;å› ä¸ºæ²¡æœ‰ side effect æ‰€æœ‰æ¯”è¾ƒå¥½ reasoningï¼›&lt;/li&gt;
&lt;li&gt;å› ä¸ºçœ‹èµ·æ¥åƒçœ‹æ•°å­¦å…¬å¼ä¸€æ ·æ‰€ä»¥é€»è¾‘æ¸…æ™°ï¼ˆåŒæ—¶ä¹Ÿæ–¹ä¾¿å½¢å¼åŒ–éªŒè¯ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½†æ˜¯ä½ ä¸Šé¢æ‰€è¯´çš„çŠ¶æ€ï¼ŒçœŸçš„ä¹Ÿæ˜¯ FP çš„å¥½å¤„å—ï¼Ÿå³ä½¿æ˜¯ä¸€ä¸ªçŠ¶æ€å¯¹åº”ä¸€ä¸ªè™šæ‹Ÿæ ‘ï¼Œä½†æ˜¯å¦‚æœé€»è¾‘å¤šèµ·æ¥(e.g., çŠ¶æ€A =&gt; çŠ¶æ€B =&gt; çŠ¶æ€C)ï¼Œæ€ä¹ˆä¿è¯çŠ¶æ€ä¸€å®šæ˜¯è„‘æµ·ä¸­çš„é‚£æ ·å‘¢ï¼ŸJQuery çš„ç¡®æœ‰è¿™ä¸ªé—®é¢˜(çŠ¶æ€æ¯”è¾ƒä¹±ï¼‰ï¼Œä½†æ˜¯ Elm è²Œä¼¼ä¹Ÿæ²»æ ‡ä¸æ²»æœ¬...?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“ç„¶ï¼Œå¦‚æœ Elm æ˜¯å†…åµŒ Redux+React çš„æ¨¡å¼çš„è¯ï¼Œè‚¯å®šæ˜¯æ¯” jQuery è¦å¥½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘å…¶å®å†™è¿‡å¾ˆå¤š JS ä»£ç ï¼Œè™½ç„¶æ²¡æœ‰æ­£å¼çœ‹è¿‡ä»–çš„è¯­æ³•ï¼ˆè‡³ä»Šè¿˜åˆ†ä¸æ¸… === å’Œ == çš„åŒºåˆ«ï¼‰ã€‚ç»™æˆ‘çš„æ„Ÿè§‰çš„ç¡®å¾ˆæ“è›‹...å¤§æ‹¬å·æ¢è¡Œè¿˜èƒ½æ”¹å˜ç¨‹åºçš„æ„æ€ï¼›é—­åŒ…æ˜¯å‡é—­åŒ…ï¼Œè€Œä¸”ä½ è¿˜ä¸çŸ¥é“è¿™ä¸ªé—­åŒ…æ˜¯çœŸçš„è¿˜æ˜¯å‡çš„ï¼ˆC++ çš„é—­åŒ…è™½ç„¶å¯ä»¥é Immutableï¼Œä½†æ˜¯èµ·ç éƒ½ä¼šåœ¨é—­åŒ…å£°æ˜çš„æ—¶å€™çœ‹å¾—åˆ°ï¼‰...&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘è§‰å¾—ç»ˆç©¶ä¼šæœ‰ä¸€é—¨è¯­è¨€æ¥æ“ç¿» js çš„ (æ‘Šæ‰‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯¶ï¼Œå¦‚æœCè¯­è¨€é‡Œé¢æœ‰ hygien macro æˆ‘è§‰å¾—å°±å®Œç¾äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;</content:encoded></item><item><title><![CDATA[åˆçª¥ Haskellï¼šè§£æä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼]]></title><link>https://diverse.space/2017/10/parsing-math-expression-by-haskell</link><guid isPermaLink="false">https://diverse.space/2017/10/parsing-math-expression-by-haskell</guid><pubDate>Mon, 30 Oct 2017 20:26:27 GMT</pubDate><content:encoded>&lt;p&gt;æœ€è¿‘åœ¨å­¦ä¹  Haskellï¼Œä¸å¾—ä¸è¯´ï¼Œè¿™çœŸçš„æ˜¯ä¸€é—¨ä»¤æˆ‘ç€è¿·çš„è¯­è¨€ï¼Œlazy å’Œçº¯å‡½æ•°å¼ç­‰ç‰¹æ€§éƒ½éå¸¸å¸å¼•æˆ‘ï¼Œä¸è¿‡çŸ­æ—¶é—´å†…è¿˜æ— æ³•æŒæ¡å¾—å¾ˆå¥½ï¼Œæœ€é‡è¦æ˜¯æ€ç»´çš„è½¬å˜éå¸¸è‹¦éš¾ã€‚&lt;/p&gt;
&lt;p&gt;å­¦ä¹ ä¸€é—¨è¯­è¨€æœ€å¥½çš„åŠæ³•å°±æ˜¯å¤šå®è·µï¼Œæˆ‘è¿˜è®°å¾—æˆ‘å†™è¿‡ä¸€ç‰‡æ–‡ç« &lt;a href=&quot;https://vincentdchan.github.io/2016/07/parse-math-expression/&quot;&gt;ç¼–è¯‘åŸç†å­¦ä¹ ç¬”è®°1ï¼šè§£ææ•°å­¦è¡¨è¾¾å¼&lt;/a&gt;
æ¥è®²è¿°æ€æ ·å»è§£ææ•°å­¦è¡¨è¾¾å¼ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰è®²å¦‚ä½•å»å®ç°ï¼Œç°åœ¨åˆšå¥½ç”¨ Haskell å®ç°ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;æœ¬ç¯‡æ–‡ç« æ‰€æœ‰æºç &lt;a href=&quot;https://gist.github.com/vincentdchan/78435adcbb007df77e0c674201202925&quot;&gt;https://gist.github.com/vincentdchan/78435adcbb007df77e0c674201202925&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;gists é‡ŒåŒ…å«äº†æˆ‘æ›¾ç»åœ¨æˆ‘çš„ä½œä¸šé‡Œé¢ç”¨ C# å®ç°äº†ä¸€ä¸ªè¿‡ç¨‹å¼çš„æ•°å­¦è¡¨è¾¾å¼è¿ç®—å™¨ï¼Œæ€»ä»£ç  161 è¡Œï¼Œè€Œ Haskell ç‰ˆåªç”¨äº†54è¡Œã€‚FP çš„ pattern matching åœ¨å†™çŠ¶æ€å¤æ‚çš„ç¨‹åºçš„æ—¶å€™çœŸçš„å¦‚è™æ·»ç¿¼ã€‚&lt;/p&gt;
&lt;h2&gt;å†™ä¸€ä¸ªè¯æ³•åˆ†æå™¨ Tokenizer&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬è¦æŠŠå­—ç¬¦ä¸²è§£ææˆä¸€ä¸ªä¸ª tokenï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³æ—¶æ‰€è¯´çš„è¯æ³•åˆ†æå™¨é‡Œé¢çš„â€è¯â€œï¼Œæƒ³æƒ³ä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼é‡Œé¢æœ‰ä»€ä¹ˆç±»å‹çš„ tokenï¼Ÿå¤§æ¦‚æ˜¯åªæœ‰æ•°å­¦ç¬¦å·å’Œæ˜¯æ•°å­—ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-haskell&quot;&gt;data Token = Num Int 
    | T_Plus | T_Sub 
    | T_Mul | T_Div
    deriving (Show)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ³¨æ„æˆ‘åœ¨ä¸Šä¸€ç¯‡åšæ–‡é‡Œé¢æåˆ°çš„ä¼˜å…ˆçº§é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªå‡½æ•°æ¥è¿”å›æ“ä½œç¬¦çš„ä¼˜å…ˆçº§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ pattern matching&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-haskell&quot;&gt;getPrecedence:: Token -&gt; Int
getPrecedence T_Plus = 1
getPrecedence T_Sub = 1
getPrecedence T_Mul = 2
getPrecedence T_Div = 2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™ç§è¡¨è¾¾å¯ä»¥è¯´æ˜¯éå¸¸ä¼˜é›…äº†ï¼Œç„¶åå¼€å§‹å†™ä¸€ä¸ªè¯æ³•åˆ†æå™¨â€¦â€¦çš„å®šä¹‰&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-haskell&quot;&gt;tokenizer:: String -&gt; [Token]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Haskell çš„ç±»å‹å®šä¹‰ï¼Œä¸€ä¸ªè¯æ³•åˆ†æå™¨è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åè¾“å‡ºä¸€ä¸² Token&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¥ä¸‹æ¥çœ‹æˆ‘æ”¾å¤§æ‹›&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;tokenizer&lt;/code&gt; å‡½æ•°å°†è°ƒç”¨ä¸‹é¢è¿™ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„ &lt;code&gt;_tokenizer&lt;/code&gt; æ¥å®Œæˆè¯æ³•åˆ†ææ“ä½œï¼Œä¸‹é¢æˆ‘æ¥è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‡½æ•°çš„å‚æ•°æœ‰ä»€ä¹ˆä½œç”¨&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯å¾…è§£æçš„å­—ç¬¦ä¸²&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒä¸ªå‚æ•°æ˜¯æš‚å­˜çš„æ•°æ®ç¼“å†²åŒºï¼Œå¦‚æœæˆ‘ä»¬è¦è¯»å…¥æ•°å­—1234ï¼Œé‚£ä¹ˆè¦å…ˆæŠŠ123å…ˆç¼“å­˜èµ·æ¥ï¼Œè¯»å…¥4åå†ä¸€èµ·è§£æ&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯&lt;strong&gt;ä¹‹å‰å·²ç»è¯»å…¥çš„token&lt;/strong&gt;, æˆ‘ä»¬æŠŠè¿™æ¬¡è§£æå‡ºæ¥çš„tokenè¿æ¥è¿›å»ï¼Œç„¶åé€šè¿‡é€’å½’ä¼ ç»™ä¸‹ä¸€æ¬¡è¿ç®—ï¼Œæœ€åç›´æ¥è¿”å›ä¸‹ä¸€æ¬¡çš„é€’å½’è°ƒç”¨è¿”å›çš„å€¼ï¼Œè¿™ç§å†™æ³•å«åšå°¾é€’å½’ï¼Œå¯ä»¥å‡å°‘å†…å­˜çš„ä½¿ç”¨ã€‚å…³äºå°¾é€’å½’è¿™é‡Œä¸è¯¦ç»†è¯´ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&quot;language-haskell&quot;&gt;_tokenizer:: String -&gt; String -&gt; [Token] -&gt; [Token] -- å°¾é€’å½’å†™æ³•
_tokenizer &quot;&quot; [] previous = previous -- æ‰€æœ‰å­—ç¬¦éƒ½è§£æå®Œæ¯•
_tokenizer &quot;&quot; buf previous = ((Num $ read $ reverse buf):previous) -- å­—ç¬¦éƒ½è§£æå®Œæ¯•ï¼Œä½†æ˜¯ç¼“å†²åŒºè¿˜æœ‰æ•°æ®
_tokenizer (ch:expr) buf previous = 
    if (Data.Char.isDigit ch) then -- å½“å‰å­—ç¬¦æ˜¯ä¸€ä¸ªæ•°å­—
        _tokenizer expr (ch:buf) previous -- æŠŠæ•°å­—æ”¾å…¥ç¼“å†²åŒº
    else -- å½“å‰å­—ç¬¦ä¸æ˜¯æ•°å­—
        case buf of  -- æ£€æŸ¥ç¼“å†²åŒºæ˜¯å¦ä¸ºç©º
            [] -&gt;  -- ç¼“å†²åŒºä¸ºç©º
                case ch of -- è§£æå½“å‰å­—ç¬¦
                    &apos;+&apos; -&gt; _tokenizer expr [] (T_Plus:previous)
                    &apos;-&apos; -&gt; _tokenizer expr [] (T_Sub:previous)
                    &apos;*&apos; -&gt; _tokenizer expr [] (T_Mul:previous)
                    &apos;/&apos; -&gt; _tokenizer expr [] (T_Div:previous)
            _ -&gt; _tokenizer (ch:expr) [] ((Num $ read $ reverse buf):previous) -- ç¼“å†²åŒºä¸ä¸ºç©ºï¼Œè¯»å–ç¼“å†²åŒºå­—ç¬¦
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šç¼“å†²åŒºä¿å­˜çš„æ•°å­—ç¼“å†²æ˜¯å€’åºçš„ï¼Œå½“æˆ‘ä»¬ç”¨ &lt;code&gt;read&lt;/code&gt; å‡½æ•°è¯»å–æ•°å€¼çš„æ—¶å€™ï¼Œè¦å…ˆç”¨ &lt;code&gt;reverse&lt;/code&gt; å‡½æ•°åè½¬&lt;/p&gt;
&lt;p&gt;ç„¶å &lt;code&gt;tokenizer&lt;/code&gt; çš„å®šä¹‰å°±å¾ˆç®€å•äº†ï¼Œæˆ‘ä»¬è¯æ³•åˆ†æå‡ºæ¥çš„åˆ—è¡¨æ˜¯å€’åºçš„ï¼Œæˆ‘ä»¬è¦ç”¨reverseå‡½æ•°æ¥åè½¬ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-haskell&quot;&gt;tokenizer expr = reverse (_tokenizer expr [] [])
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;è¡¨è¾¾å¼æ±‚å€¼&lt;/h2&gt;
&lt;p&gt;åˆ°æ­¤ä¸ºæ­¢ï¼Œè¯æ³•åˆ†æå™¨å°±å®Œæˆäº†ï¼Œå½“æˆ‘ä»¬å¯¹ä¸€ä¸²å­—ç¬¦ä¸²è°ƒç”¨ tokenizer å°±å¯ä»¥å¾—åˆ°ä¸€ä¸² token äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¦‚ä½•å¯¹è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼ï¼ŒåŸç†å¯ä»¥å›é¡¾&lt;a href=&quot;https://vincentdchan.github.io/2016/07/parse-math-expression/&quot;&gt;ç¼–è¯‘åŸç†å­¦ä¹ ç¬”è®°1ï¼šè§£ææ•°å­¦è¡¨è¾¾å¼&lt;/a&gt;ï¼Œè¿™é‡Œè®²è®²å®ç°&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-haskell&quot;&gt;-- å®šä¹‰æ“ä½œç¬¦è¿ç®—
evalOp :: Token -&gt; Int -&gt; Int -&gt; Int
evalOp T_Plus a b = a + b
evalOp T_Sub a b = a - b
evalOp T_Mul a b = a * b
evalOp T_Div a b = a `div` b

-- æä¸€ä¸ªå¥½çœ‹ç‚¹çš„åŒ…è£…å‡½æ•°
eval :: [Token] -&gt; Int
eval ((Num value):tokens) = _eval tokens [value] []

-- çœŸæ­£è¿ä½œçš„å‡½æ•°åœ¨è¿™é‡Œ
_eval :: [Token] -&gt; [Int] -&gt; [Token] -&gt; Int
-- æ“ä½œæ•°æ ˆé‡Œé¢åªæœ‰ä¸€ä¸ªæ•°äº†ï¼Œå°±æ˜¯æˆ‘ä»¬è¦æ±‚çš„å€¼äº†
_eval [] [value] _ = value
-- æ“ä½œç¬¦æ ˆæ•°å€¼ä¸ºç©ºï¼Œè¿›è¡ŒSHIFTæ“ä½œ
_eval (op:(Num num):tokens) numStack [] =
    _eval tokens (num:numStack) [op]
-- æ“ä½œç¬¦æ ˆä¸ä¸ºç©º
_eval (op:(Num num):tokens) numStack (topOp:opStack) =
    if (getPrecedence op) &gt; (getPrecedence topOp) then
        _eval tokens (num:numStack) (op:topOp:opStack) -- SHIFT
    else -- REDUCE
        case numStack of
            (num1:num2:stack) -&gt;
                _eval (op:(Num num):tokens) ((evalOp topOp num1 num2):stack) opStack
-- æ ˆé‡Œè¿˜æœ‰ä¸€äº›æ®‹ç•™çš„å€¼ï¼Œç»§ç»­è¿ç®—
_eval [] (num1:num2:numStack) (topOp:opStack) =
    _eval [] ((evalOp topOp num1 num2):numStack) opStack
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œ &lt;code&gt;_eval&lt;/code&gt; çš„å‚æ•°&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¦è§£æçš„ token é›†åˆ&lt;/li&gt;
&lt;li&gt;æ“ä½œæ•°çš„æ ˆ&lt;/li&gt;
&lt;li&gt;æ“ä½œç¬¦çš„æ ˆ&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œåœ¨ pattern matching çš„å¸®åŠ©ä¸‹ï¼Œå†™ä¸€ä¸ªè¡¨è¾¾å¼æ±‚å€¼çš„ç¨‹åºå¯ä»¥è¯´éå¸¸ç®€æ´æ˜äº†ã€‚å½“ä½ ç”¨è¿‡ç¨‹å¼è¯­è¨€å»å†™ tokenizer çš„æ—¶å€™ï¼Œä½ éœ€è¦æ§åˆ¶ä¸€ä¸ªæŒ‡é’ˆåœ¨å­—ç¬¦ä¸²ä¸Šç§»æ¥ç§»å»ï¼Œéå¸¸å®¹æ˜“å‡ºé”™ï¼Œå¦‚æœç”¨ pattern matchingï¼Œåªéœ€è¦å®šä¹‰å¥½ç›¸åº”çš„å­—ç¬¦ä¸²å°±å¯ä»¥äº†ï¼Œéå¸¸ä¼˜é›…ã€‚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ç”¨ Python ç”Ÿæˆé¥¼çŠ¶æ—‹è½¬åŠ¨ç”»]]></title><link>https://diverse.space/2017/10/generating-spin-animation-using-python</link><guid isPermaLink="false">https://diverse.space/2017/10/generating-spin-animation-using-python</guid><pubDate>Sun, 29 Oct 2017 01:53:48 GMT</pubDate><content:encoded>&lt;p&gt;åœ¨å†™ä¸€ä¸ªå°æ¸¸æˆè¿‡ç¨‹ä¸­ï¼Œæ‰“ç®—åšä¸€ä¸ªé¥¼çŠ¶æ—‹è½¬çš„åŠ¨ç”»ï¼Œäºæ˜¯æ‰“ç®—ç”¨ Python æ¥ç”Ÿæˆè¿™ä¸ªåŠ¨ç”»ï¼Œå‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€å¼ å›¾ç‰‡&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/38af76d5aae29e7a83399b6046f7f4d3/a8408/red-circle.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 128px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAACVklEQVQ4y61UPWhTYRS9aRcdnMW0SUS01kVQqSBSq2kagzVpLC1YUq2KS0FRuiilKOLSwaFTKeikky46KggO4iAl4CZuTg6uWrC81+94z/3el9dKoZoa+Mjlve+ed3/OOYLFB8Ifvn8Td2xHp8WA4G5j2F0ZeIyxI000Tqzg0slVjB5uumvFp7g9WtM7/u5e6cDHdx7jybz44MMbgSTx/eslTBz/hFoPUMkDpW7gTFbPHh/z2fn9wMW+z5i7WkvSxL19mWlV1gKbGbuH+iFN7AIGu2MM5SM9a3ochgouiSN7xzv1XuBWfT6Aovle0jYN7CAr0aRC7EH0lHJu05h3itkYIweAmyOPDEOkI22TlXmwNU1EmpjHHyeAwyomqI7HzV6+4HvnAjgztsCvpmDY4gRQ3/740S+6qJ22TVuAn5n7S7D11XJZEaq6qJnxCTFqVOxl1AYgkiojVApQar0Q4xnpwHn4oeMfj7O2yzm4au+yGGnJs3aq8xU6lJVSp3ezwp9iCiBpPc/aq5CAAwo4deqXUE7/peWzVFDPspg2t7cU11rKVP8rMaFTm9uiTS7C8D7gRnWSztJpQm+b2JozmCWxv2Llxy4vPXUNEzpl5Ge5Fahr3Sl2KalVz3cakxL8zP7VNUzoHjReR9rNDMJXRjDmTJ9bTMwhI8Ec7YG6hsmQ7VNOflGx0aJccMmHIpsZ26ymYJb/+nlmozkyVtcwoVOb3JwqwEhLnpEafMYFcGahTYI9W8hssG2aY/AzugaFTm1STlQASUuekRrcZlgA2wyVYemh/AYK9VmiTWdy5wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;red circle&quot;
        title=&quot;&quot;
        src=&quot;/static/38af76d5aae29e7a83399b6046f7f4d3/a8408/red-circle.png&quot;
        srcset=&quot;/static/38af76d5aae29e7a83399b6046f7f4d3/a8408/red-circle.png 128w&quot;
        sizes=&quot;(max-width: 128px) 100vw, 128px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ€åç”Ÿæˆçš„åŠ¨ç”»æ˜¯è¿™ä¸ªæ ·å­çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/red-ani2.gif&quot;&gt;&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œä¸­é—´ä¼šç”Ÿæˆå¾ˆå¤šå¸§çš„åŠ¨ç”»&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/41eb5fcf99a8e3f6b23642b5889142e3/0eaa2/red-circle2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 49.53429297205758%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABYlAAAWJQFJUiTwAAACV0lEQVQozxWQTUgUYRjHB+oQdOrSoQ5Bl6AOCUGXICHo0CEIErqFEXgJgiI6mEmEYFC2ZZluatrm6jrSbunq7tqWjm1qmpua2oq768eYozuzu/OxOx/vvO/7NHP7PfB74Mefobs8fVSDf4zS5TnaeBtnU5QLk44nWNgCto3Eg5jPUn8zXkmSPzM02Gnndsi3T/B9pLQnMPA1BMcY3HCLeBvgKGP3vab3rtGK/TgehEvHydXTdpSFMwdI7XXi88ApxvZ5aP1NOHtQjgUZs1wSe1vlvwvqriB2v1Rze+pSMtfTUjKMYnwwHw7oyBb7vIUZrlwsiB1P1c2MuvZXevdc5DcZkk1ZkX69VFLHYiIX2TUoirBmJoX0Mgp2mjZGfNYa/GAC2HMJaypuATgCSs3LCDMwOgAV+6zmOsPzwMnTQn5ypwqunMQTw252XTWODcC5Q6S/lbQ3woUj9u9JercKbpzXNtKMaZpi4G1xfobfkdKtTetrG8XklNDxTNP1AheVQj7FsPIfuwsTMVVRpC5PMbWkbGbEziZ5e4sh6SUryjpViIsIXGSBF7JC7p9zljXEek1CrK0sCnW5wuy4NfnFhbAfrSR1AAYiAacKL05Tz31y+URxfa3kqcWvHmJRgMrDZHwIz3IuaDJpewzVlTYArbkILfWG86wbhsS2F2YTSl6SfM3azrY6Py2+f6GWdSc1PzKgmigf8km/JjVFFvvbi4KgZFb3PvtlVWPI+ioa6nE2tBNRmwu7Yw75rfQyIsQOvEGWZQm8zXpdIZlAY4MuDPfaiz/LFP4Dn8zaaD8Lv5QAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;red circle2&quot;
        title=&quot;&quot;
        src=&quot;/static/41eb5fcf99a8e3f6b23642b5889142e3/84ad3/red-circle2.png&quot;
        srcset=&quot;/static/41eb5fcf99a8e3f6b23642b5889142e3/687da/red-circle2.png 175w,
/static/41eb5fcf99a8e3f6b23642b5889142e3/0ab4d/red-circle2.png 350w,
/static/41eb5fcf99a8e3f6b23642b5889142e3/84ad3/red-circle2.png 700w,
/static/41eb5fcf99a8e3f6b23642b5889142e3/ef8d3/red-circle2.png 1050w,
/static/41eb5fcf99a8e3f6b23642b5889142e3/0eaa2/red-circle2.png 1181w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆå»ç”Ÿæˆæ¯ä¸€å¸§åŠ¨ç”»å‘¢ï¼Ÿå…¶å®å…³é”®å°±åœ¨äºæŒ–å»ä¸€ä¸ªé¥¼çŠ¶å›¾å½¢é‡Œé¢çš„åƒç´ &lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a236b82cf5500f6f0b887cbfd78a486d/a8408/red-ani3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 128px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAC0ElEQVQ4y4WUS2hTQRSGJymCIi7cKOZxU2xTYxdCFRURG/PsM2laG7CmplFEEJRKN0opigjShQtXRdSVBUE3Cm4UBAVRkFIQN+LGx0ZBVAQNWJPM7zkz99XYpIHJzL33zDfnn/MQmLsk+Ievn4XctbZFrQGB84UBlKI3kO96gyN7P+FkOqi+laIeZCLC+iEovHj2UK9vzZovXzwWsAwunkhibM9rZDuAHgNIBSBjvh+IbvKr731tXjUf3r0R08V+Cyyf3PfYntmwqdELyG0Hkn4gEagiZSwhHSKo8Y1mDUwZa9ScCMzgUCcwOXzF9nbxuXBkKtg2ILalhlSIYZJGDWlDA1OG396YDLbRcxlxH5ANQ54ZuqreC+F1ZLJnGlajDWgGlCljHr3seegvQat8PXK6OKw/cgD4zlgme+bA4ACDDDRMyd3mIZJs2a6q9uZ3vqNgrtPR5ADoO5MumAtofLc8pPml9s6o2HbJQAWZdmAqPyZkKXoTvYZl0Aj4k8Z68qiIvlY3TJqKKuqQo/vvCYx2LdIJerOWgP+BwS+07qTxXqcSvXdstOx0EDITWRAo7Csj5sMK3rk9/EDjDnqU1KoLBOVEOiRxcDN7+FvQ3xJFlwOyEtAJjvMs6w7XwCgBJ7r/CIzsaCaZ5co6GOoO1pL5KgY7FoQ8Hr/dJCiNYI6NdkIHZeLAA4GzI1kMtjdKm9WGdY8VDGwFTmfGubO0UKG/bZDYzWHKlvYkfJzYH1H+tUGX3syxLHIRqDLSd7kaVNo2cT8ldRg4VxjXsFZd0JjMzWIobEGrphR3iUnXWnvGMN5zqn/ObA4egVdPnWZJXUOVIcvnctKBqqq0SIekeVBF3RnLzDgwtf/RXc/y5shr6hqq0Lk2OXJUASppOc84NfgdB4DvzJLJsPlrnmVtm5uj1c+4a3Chc21yOXEFcNJynnFqcDStALBMyzNcvyz+AXNMK+qPAbllAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;red ani3&quot;
        title=&quot;&quot;
        src=&quot;/static/a236b82cf5500f6f0b887cbfd78a486d/a8408/red-ani3.png&quot;
        srcset=&quot;/static/a236b82cf5500f6f0b887cbfd78a486d/a8408/red-ani3.png 128w&quot;
        sizes=&quot;(max-width: 128px) 100vw, 128px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é‚£æˆ‘ä»¬åªè¦éå†è¿™å¼ å›¾ç‰‡çš„æ‰€æœ‰å…ƒç´ ï¼Œç„¶åæŒ–å»åœ¨è¿™ä¸ªé¥¼çŠ¶èŒƒå›´å†…çš„åƒç´ å³å¯ï¼Œä»è¿™ä¸ªæ€è·¯å‡ºå‘ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“æƒ³åˆ°ä½¿ç”¨æåæ ‡ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸¤æ¡æåæ ‡ç©ºé—´é‡Œé¢çš„ç›´çº¿ &lt;code&gt;p = Theta1&lt;/code&gt; å’Œ &lt;code&gt;p = Theta2&lt;/code&gt; é‚£æˆ‘ä»¬åªè¦æŠŠè¿™ä¸¤æ¡ç›´çº¿ä¸­é—´çš„åƒç´ æŒ–æ‰å³å¯ã€‚å½“æˆ‘ä»¬éå†æ‰€æœ‰å…ƒç´ çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­è¿™ä¸ªåƒç´ ç‚¹åœ¨æåæ ‡ç©ºé—´ä¸­çš„ä½ç½®ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬åæ ‡çš„åœ†å¿ƒæ˜¯æ•´ä¸ªå›¾ç‰‡çš„ä¸­å¿ƒï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸ªåƒç´ ç‚¹ï¼Œæˆ‘ä»¬è¦å‡å»æ•´å¼ å›¾ç‰‡ä¸­ç‚¹åæ ‡ï¼Œæ±‚å‡ºçš„ç›¸å¯¹åæ ‡å†ä½œ atan2 è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://wikimedia.org/api/rest_v1/media/math/render/svg/86ad33236e019c6a82a8dd674f266fb70f51ac57&quot;&gt;&lt;/p&gt;
&lt;p&gt;ç”¨ math.atan2 æ±‚å‡º theta ä¹‹åè‹¥åœ¨ theta1 å’Œ theta2 ä¹‹å†…ï¼Œåˆ™åˆ å»å³å¯ï¼Œæ‰€ä»¥è¯´æ ¸å¿ƒä»£ç å…¶å®å¾ˆç®€å•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-python&quot;&gt;for x in range(SIZE[0]):
        for y in range(SIZE[1]):
            relative_point = (x - CENTER_POINT[0], y - CENTER_POINT[1])
            theta = math.atan2(relative_point[1], relative_point[0])
            theta = theta * 180 / math.pi + 180

            if theta &gt;= theta1 and theta &amp;#x3C; theta2:
                draw = ImageDraw.Draw(img, &apos;RGBA&apos;)
                draw.point([x, y], (0, 0, 0, 0))    # write null pixel
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€åé™„ä¸Šæºç  gist åœ°å€:
&lt;a href=&quot;https://gist.github.com/vincentdchan/e120f3cacf88efbba3e51fa1b0084086&quot;&gt;https://gist.github.com/vincentdchan/e120f3cacf88efbba3e51fa1b0084086&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[HTML Canvaså®ç°ã€Šé»‘å®¢å¸å›½ã€‹æ•°å­—é›¨]]></title><link>https://diverse.space/2017/06/matrix-rain-by-html-canvas</link><guid isPermaLink="false">https://diverse.space/2017/06/matrix-rain-by-html-canvas</guid><pubDate>Mon, 19 Jun 2017 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;ã€Šé»‘å®¢å¸å›½ã€‹æ˜¯æˆ‘æœ€å–œæ¬¢çš„ç”µå½±ä¹‹ä¸€ï¼Œæˆ‘æ„Ÿè§‰ã€Šé»‘å®¢å¸å›½ã€‹é‡Œé¢çš„æ•°å­—é›¨ç®€ç›´æ˜¯ä¸€ç§è‰ºæœ¯ï¼Œéå¸¸å¥½çœ‹ï¼Œçœ‹ä¸Šå»éå¸¸é«˜å¤§ä¸Šï¼Œè€Œä¸”å’Œâ€œé›¨â€è¿™ç§ä¸œè¥¿ç»“åˆï¼Œéå¸¸æœ‰æ„æ€ï¼Œäºæ˜¯æƒ³è‡ªå·±å®ç°ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æ•ˆæœå›¾:&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d0dab848e704fc95b1559329d05867f9/70ccc/matrix-ani.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 48.04687499999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAA3klEQVQoz21Syw7DIAxLeJaWaYf9/7cyqGzVrXqwgCTYccAs2rBsw4sP+819nXAgTKSJDajA2hvyjpp94rvi61AmItYsxVHiJMw4G3Ko8+rDj9nUmSxQyVipSjF2etiIRxzWXkQbmylihQX+6I77inMHYRJ0dt7gf4PCJsRZVgdJ4ayQIyHFl41TOcqcmGzyOOEiOR8wyMzp7iTsCPJSFsIq1nQURWLqKpEwPQo45A0kWR7KXmba5OvYBxejtJ1Q1GFx90vUIJBF9KuEx50wlHAvXoTJLwcmX4z/sl+W/33ny1L5gsdYAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;matrix ani&quot;
        title=&quot;&quot;
        src=&quot;/static/d0dab848e704fc95b1559329d05867f9/84ad3/matrix-ani.png&quot;
        srcset=&quot;/static/d0dab848e704fc95b1559329d05867f9/687da/matrix-ani.png 175w,
/static/d0dab848e704fc95b1559329d05867f9/0ab4d/matrix-ani.png 350w,
/static/d0dab848e704fc95b1559329d05867f9/84ad3/matrix-ani.png 700w,
/static/d0dab848e704fc95b1559329d05867f9/ef8d3/matrix-ani.png 1050w,
/static/d0dab848e704fc95b1559329d05867f9/70ccc/matrix-ani.png 1280w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨Canvasé‡Œé¢å®ç°åŠ¨ç”»çš„æ€è·¯å…¶å®å¾ˆç®€å•ï¼Œåœ¨å¾ˆçŸ­çš„æ—¶é—´é‡Œé¢åˆ·æ–°ä¸€æ¬¡å°±è¡Œäº†ã€‚æ¯æ¬¡åˆ·æ–°çš„æ—¶å€™ï¼Œå­—ç¬¦éƒ½ä¼šä¸‹é™ï¼Œç„¶è€Œæ•°å­—é›¨é‡Œé¢å¹¶ä¸æ˜¯æ•´ä¸²â€œé›¨â€å¾€ä¸‹ç§»åŠ¨ä¸€ä¸ªå•ä½ï¼Œè€Œæ˜¯è¿™ä¸ªé›¨çš„æœ€ä¸‹ç«¯ï¼Œæ˜¾ç¤ºäº†ä¸€ä¸ªæ–°çš„å­—ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/matrix.gif&quot;&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬ä¸å¦¨æ¢ä¸ªæ€è·¯ï¼Œå°±æ˜¯å…¶å®æ¯ä¸ªå­—ç¬¦çš„ä½ç½®å…¶å®æ˜¯å›ºå®šï¼Œæ¯æ¬¡åˆ·æ–°çš„ä¸æ˜¯æ¯ä¸ªå­—ç¬¦çš„ä½ç½®ï¼Œè€Œæ˜¯åˆ·æ–°ä»–ä»¬çš„é¢œè‰²ï¼Œè®©ä¸€ä¸ªå­—ç¬¦çš„é¢œè‰²ä»æœ€ç»¿æ…¢æ…¢å˜é»‘ï¼Œç„¶ååˆå˜æœ€ç»¿ï¼Œç„¶åæ…¢æ…¢å˜é»‘â€¦â€¦å‘¨è€Œå¤å§‹ã€‚æœ€åæŠŠæ¯ä¸ªå­—ç¬¦ç”¨Canvasåœ¨å¯¹åº”çš„åæ ‡ç”»å‡ºæ¥å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶è¿™å½“ä¸­æœ‰å…ˆåé¡ºåºï¼Œä¸€åˆ—é‡Œé¢ï¼Œç¬¬nä¸ªå­—ç¬¦çš„é¢œè‰²åº”è¯¥åˆšå¥½æ¯”ç¬¬n-1ä¸ªå­—ç¬¦å°‘ä¸€ä¸ªæ¢¯åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ç¬¬iç§’çš„æ—¶å€™ï¼š
    ç¬¬Nä¸ªå­—ç¬¦çš„é¢œè‰²ä¸º A
        ç¬¬N-1å­—ç¬¦çš„é¢œè‰²ä¸º A -1
    
ç¬¬i+1ç§’çš„æ—¶å€™
        ç¬¬Nä¸ªå­—ç¬¦çš„é¢œè‰²ä¸ºA-1
        ç¬¬N-1ä¸ªå­—ç¬¦çš„é¢œè‰²ä¸ºA-2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“ç„¶äº†ï¼Œä¸ºäº†è¦è®©æ¯ä¸€æ¡é›¨æ¡ä¸‹è½çš„å…ˆåé¡ºåºä¸ä¸€æ ·ï¼Œå¿…é¡»ç»™å®ƒä»¬çš„é¢œè‰²åŠ ä¸€ä¸ªéšæœºçš„åç§»é‡ï¼Œç„¶åå–æ¨¡ï¼Œè¿™æ ·å°±ä¼šæœ‰å…ˆåè½ä¸‹çš„æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;æœ€åé™„ä¸Šæºç ï¼Œéœ€è¦ç”¨Babelç¼–è¯‘ä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://gist.github.com/vincentdchan/aa426fc9767b2508d79fbefc87c659fd&quot;&gt;Github gist æºä»£ç &lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[å†™ä¸€ä¸ªå…‰çº¿è¿½è¸ªæ¸²æŸ“å™¨]]></title><link>https://diverse.space/2017/05/writing-a-ray-tracing-renderer</link><guid isPermaLink="false">https://diverse.space/2017/05/writing-a-ray-tracing-renderer</guid><pubDate>Thu, 18 May 2017 00:01:00 GMT</pubDate><content:encoded>&lt;p&gt;æœ€è¿‘éƒ½åœ¨åšä¸€ä»¶äº‹æƒ…ï¼Œåšä¸€ä¸ªå…‰çº¿è¿½è¸ªæ¸²æŸ“å™¨ï¼Œä¸€ç›´å¾ˆæƒ³æ­å¼€å…‰çº¿è¿½è¸ªæ¸²æŸ“å™¨çš„å¤§é—¨ï¼Œäºæ˜¯è·Ÿç€ Milo Yip çš„æ­¥ä¼å¼€æ’¸äº†&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.cnblogs.com/miloyip/archive/2010/03/29/1698953.html&quot;&gt;ç”¨ JavaScript ç©è½¬è®¡ç®—æœºå›¾å½¢å­¦(ä¸€)å…‰çº¿è¿½è¸ªå…¥é—¨&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¸²æŸ“ç»“æœå›¾ï¼š
&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/6f3405112aa6623034871f512c1a8cd9/748a9/renderer-img.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsSAAALEgHS3X78AAAD9UlEQVQ4y6WTX0xbdRTH77/e3vb+6b29t/Te9lIKpbSl6x/+NaMQSKkg1aZCqTXMxYBsUP5Mp5ixFGhHmdB2tOmqwtiyMM2iEnSEbGQvZpiQGF/2YHDyIHHuwUfju4nWW3gx2Xzy5PfyO+d8zvfkd34HAP6/gcfnxKD/THk+90Vx4MXx59wnNx6GX8WwCZKcpulBkhRg+N8tgLBCRtlxIcCZ39Jaz8pV5mPvMWqA4VGCSNH0jcrKb1tbfw0Gv3G52jHshIcQHKUbcF1QdIwHh+7OffxsZO4HrqqnTKIg2I1hwzh+kWHW7PanExOlra2/CoVHLlcNVNaGZWoZZSO0bY62WDy7v/+kdP/7Uu/QLohyAA1BHSgaVijOU1Smru5gbKz08GHpwYOjSFRqh0ZRXkkBcgFn3ZamwXPvf3bjy18ytw67Br9QaNoBJQi6MSxAkmdZ9oOqqg2f78mFCz+/e3GnozPOMF6NxsIwoIwk2TrR3OXpigXeWOp8banaM4txbQAIQWa12s/zYUEYMRjeM5nSjY3XXK55vf5tHDfKZLxSoWY5tcagMzZJfPWpsNFxRnTEUMIEoChKkaSF4xwY1klR52y2IYNhWK9/x2hsxXGlQqFAZKyawQkCgHC9sdns6OWMPbzpFQzDgVAo5HK5WIapFYRTHNdAUR6CaEbRdq3W29TU3NKiragwG42iKAqCjuFEmVLU1Xg9rb6ammogHA5PTk5KJerr651OJ8+yJILYqqtf7ukJBAJer9disUikFOV5HoJgXqiss9gEnnc4ncDIyEgikYjH41NTU9FoVKvVSuOhGYaiKJZlY7HYzMxMfHY2m82Oj8ekEoIgYBgGgqBOpwPsdrvVau3v719YWJAK9ff1RcLhgVDozUgkFAy2eDySeLff7/P5uvx+t9tNEKS7oTEafT0SiQCS1EA4nEgmc/n8R9evF7PZ1XT6Tj5/b20tPz9PSO8EABiKYnIMQZDyn4PlDFvpcDaMjp4HUqnUtWNbTqXyqdTdQuHzXG5zZWU7l1u/dEmkaRSCcByXy+XSUFW0hlbr5YQIIqzUOSBpJhOJQiaznsl8urJyr1jcu337u42N/dW1zdnZOo2GgGGJlJSVuEql1rPaWlpjUTI2CCEAiUxfufLJ4uKddHorl3t08+bT3d3f9/aebX21OTdn5DgKKW8YIlOQKi0vWk3W04baVqqiCcF4YDGZLKZSt6SGr169n8v9tLn558FB6ejoj+3t1cuXlSRZXj5IDslIXCVKZEf3oK932OzsQ4kq4MNk8oT8enl5r1j8bWendHj49+PHP66vz0xPE2UYhmUULOdItane/dLAmemh8aXT/jEU1/8DpXECkfMkBosAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;renderer img&quot;
        title=&quot;&quot;
        src=&quot;/static/6f3405112aa6623034871f512c1a8cd9/84ad3/renderer-img.png&quot;
        srcset=&quot;/static/6f3405112aa6623034871f512c1a8cd9/687da/renderer-img.png 175w,
/static/6f3405112aa6623034871f512c1a8cd9/0ab4d/renderer-img.png 350w,
/static/6f3405112aa6623034871f512c1a8cd9/84ad3/renderer-img.png 700w,
/static/6f3405112aa6623034871f512c1a8cd9/748a9/renderer-img.png 1024w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®åˆ¶ä½œçš„è¿‡ç¨‹æ˜¯éå¸¸åå·çš„ï¼Œæˆ‘é¦–å…ˆç”¨ C# æŒ‰ç…§åšæ–‡çš„æ€è·¯é‡å†™äº†ä¸€è¾¹ï¼Œæ¸²æŸ“å‡ºç»“æœï¼ˆ1024x1024ï¼‰ï¼Œæ€»å…±è€—æ—¶6ç§’ï¼Œç»“æœä»¤äººå¾ˆä¸æ»¡æ„ï¼Œè§‰å¾—æœ‰ç‚¹æ…¢ï¼Œäºæ˜¯æ‰“ç®—ç”¨ C++ é‡æ–°å®ç°ä¸€éï¼Œä½¿ç”¨ MSVC ç¼–è¯‘å™¨ï¼Œç¬¬ä¸€æ¬¡åšå‡ºæ¥çš„ç»“æœæ˜¯2.1sï¼Œæ¯” C# å¿«ä¸€ç‚¹ï¼Œä½†æ˜¯ä¼˜åŠ¿è¿˜ä¸æ˜¯å¾ˆæ˜æ˜¾ã€‚ä½†æ˜¯æˆ‘åšäº†å¦‚ä¸‹æ”¹åŠ¨ä¹‹åï¼Œæ€§èƒ½å¾—åˆ°äº†æå¤§çš„æå‡ï¼š&lt;/p&gt;
&lt;p&gt;æœ¬æ¥çš„å†™æ³•ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-cpp&quot;&gt;std::shared_ptr&amp;#x3C;Result&gt; function()
{
    if (do_something()) return std::make_share&amp;#x3C;Result&gt;();
    else return null;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ”¹ä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-cpp&quot;&gt;bool function(Result&amp;#x26; result)
{
    if (do_something()) 
    {
        result = xxx;
        return true;
    }
    else return false
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç»è¿‡è¿™ä¸€æ”¹åŠ¨ä¹‹åï¼Œæ¸²æŸ“å®è·µä»åŸæ¥çš„ 2.1 ç§’ç¬é—´ç¼©çŸ­åˆ°äº† 0.6sï¼Œæœ‰ç‚¹ä»¤äººä¸å¯æ€è®®ï¼Œä¸ªäººçŒœæµ‹æ˜¯ shared_ptr è¿›è¡Œé¢‘ç¹çš„åˆ†é…å’Œé‡Šæ”¾ç©ºé—´å¯¼è‡´çš„é€Ÿåº¦å¤§å¹…åº¦å˜æ…¢ã€‚0.6s çš„æ¸²æŸ“æ—¶é—´è®©æˆ‘è§‰å¾—å¾ˆæ»¡æ„ï¼Œæœ¬æ¥æƒ³ç»§ç»­åšä¸‹ä¸€æ­¥å®éªŒï¼Œä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆçš„ï¼Œæˆ‘æ€»æ˜¯è§‰å¾—ç¨‹åºè¿˜èƒ½ä¼˜åŒ–ã€‚äºæ˜¯æˆ‘çœ‹äº†çœ‹ Profileï¼Œæ²¡å‘ç°ä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘è§‰å¾—è¯¥æ”¹çš„éƒ½æ”¹äº†ï¼Œå†æ”¹å¯èƒ½ä¹Ÿå¾—ä¸åˆ°å¤§å¹…åº¦çš„æå‡ï¼Œåæ¥æˆ‘å¾€å¦ä¸€ä¸ªæ–¹é¢æƒ³ï¼šå¤šçº¿ç¨‹&lt;/p&gt;
&lt;p&gt;å…‰çº¿è¿½è¸ªç®—æ³•æ¯ä¸ªåƒç´ çš„è®¡ç®—ä¹‹é—´æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œè¿™æ„å‘³ç€ï¼Œå¯ä»¥åŒæ—¶è¿›è¡Œè®¡ç®—ï¼Œç„¶åæœ€åæŠŠç»“æœåˆå¹¶ï¼Œpbrt ä¹Ÿè®²äº†è¿™ç§æ€æƒ³ï¼Œäºæ˜¯æˆ‘ä¹Ÿè¯•è¯•ã€‚ä¸€å¼€å§‹æˆ‘ä½¿ç”¨äº† Windows çš„ APIï¼Œå¯æ˜¯æˆ‘æ²¡æœ‰ä»€ä¹ˆ Windows çš„ç¼–ç¨‹ç»éªŒï¼ŒWin32 çš„ API éƒ½æ˜¯ç°æŸ¥ç°ç”¨ï¼Œäºæ˜¯å‡ºç°äº†ä¸€ä¸ªæˆ‘è§£å†³ä¸äº†çš„é—®é¢˜ï¼Œå°±æ˜¯æˆ‘ç”¨WaitForMultipleObjects å‡½æ•°å»ç­‰å¾…å­çº¿ç¨‹ç»“æŸï¼Œè°ƒåº¦çº¿ç¨‹æ‰ç»“æŸï¼Œå¯æ˜¯æ¯æ¬¡è°ƒåº¦çº¿ç¨‹è‡ªå·±å…ˆç»“æŸäº†ï¼ŒWaitForMultipleObjects å‡½æ•°æ²¡èµ·åˆ°ä½œç”¨ï¼Œæˆ‘æ£€æŸ¥äº†ç»“æœï¼Œåœ¨æ­£ç¡®èŒƒå›´å†…ï¼Œä¹Ÿæ²¡å‘ç°é—®é¢˜ï¼Œä½†æ˜¯å°±æ˜¯ä¸è¡Œï¼Œæ²¡åŠæ³•è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;åæ¥é‡‡ç”¨ boost çš„ thread æ¡†æ¶ï¼ŒæˆåŠŸåœ°ä½¿ç”¨äº† joinï¼Œè°ƒåº¦ç¨‹åºç­‰æ‰€æœ‰æ¸²æŸ“éƒ½å®Œæˆäº†æ‰ç»“æŸï¼Œç”±äºæˆ‘ä½¿ç”¨çš„ç”µè„‘çš„ CPU æ˜¯ i5-5200Uï¼ŒåŒæ ¸å››çº¿ç¨‹ï¼Œæ‰€ä»¥æˆ‘å¼€äº†å››çº¿ç¨‹ï¼Œè¿›è¡Œæ¸²æŸ“ï¼Œæ€»å…±è€—æ—¶ 0.3sï¼Œé€Ÿåº¦å¯ä»¥è¯´æ˜¯åŠ å¿«äº†è®¸å¤šï¼Œæˆ‘å°è¯•å¼€å…«çº¿ç¨‹è¿›è¡Œæ¸²æŸ“ï¼Œä¹Ÿæ˜¯ 0.3sï¼Œé€Ÿåº¦æ²¡æœ‰å¾—åˆ°æå‡ï¼Œè¯´æ˜å››çº¿ç¨‹åœ¨æˆ‘çš„ç”µè„‘ä¸Šåº”è¯¥æ˜¯æœ€åˆé€‚çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¤šçº¿ç¨‹çš„é—®é¢˜è§£å†³äº†ï¼Œç„¶åå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥çš„å®éªŒäº†ã€‚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ä»å¤´æ‰“é€ ä¸€ä¸ª Markdown ç¼–è¾‘å™¨ï¼ˆä¸€ï¼‰ï¼šæ•°æ®ç»“æ„å’Œå±•ç°]]></title><link>https://diverse.space/2017/01/markdown-editor-1</link><guid isPermaLink="false">https://diverse.space/2017/01/markdown-editor-1</guid><pubDate>Tue, 03 Jan 2017 10:26:00 GMT</pubDate><content:encoded>&lt;p&gt;åˆšå¼€å§‹å†™è¿™ä¸ªç¼–è¾‘å™¨çš„æ—¶å€™ï¼Œæˆ‘æ˜¯æ¯«æ— æ€è·¯çš„ï¼Œå°±æ˜¯å®Œå…¨ä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹ï¼Œåæ¥å»ç¿»äº†ä¸€ä¸‹ CodeMirror, ACEditor, VSCode è¿™äº›ä¼˜ç§€ç¼–è¾‘å™¨çš„ä»£ç ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰å…¨çœ‹ï¼Œå› ä¸ºæˆ‘è¦æˆ‘çš„ç¼–è¾‘å™¨å¤§éƒ¨åˆ†éƒ½æ˜¯æˆ‘è‡ªå·±æƒ³å‡ºæ¥çš„ï¼Œåªæœ‰æˆ‘æƒ³ä¸åˆ°çš„æ—¶å€™æ‰å»çœ‹ã€‚
é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°æ®ç»“æ„æ¥å‚¨å­˜æˆ‘ä»¬çš„æ–‡æœ¬ï¼Œä¸ºä»€ä¹ˆè¦ç”¨æ•°æ®ç»“æ„è€Œä¸ç›´æ¥ç”¨ stringï¼Œæ˜¯å› ä¸ºç¼–è¾‘å™¨éœ€è¦å¤§é‡çš„å¢åˆ æŸ¥æ”¹æ“ä½œï¼Œè€Œå½“ä¸€ä¸ªæ–‡æœ¬å¾ˆå¤§çš„æ—¶å€™ï¼Œstring æ˜¯ä¸å¤Ÿå¿«çš„ï¼Œå› ä¸º string çš„å¢åˆ æŸ¥æ”¹æ“ä½œçš„æ—¶é—´å¤æ‚åº¦åŸºæœ¬ä¸Šéƒ½æ˜¯ O(n)ï¼Œè¿˜ä¸å¤Ÿå¿«ã€‚&lt;/p&gt;
&lt;h1&gt;æ•°æ®ç»“æ„ Data structure&lt;/h1&gt;
&lt;p&gt;ä¸€å¼€å§‹æˆ‘æ‰“ç®—ç”¨çš„æ˜¯ Ropeï¼Œæ˜¯å› ä¸ºçœ‹ä¸Šè¿™ä¸ªæ•°æ®ç»“æ„è¶³å¤Ÿå¿«ï¼Œåæ¥å¼ƒç”¨äº†ï¼Œæ˜¯å› ä¸ºå®ƒå’Œæˆ‘çš„ç¼–è¾‘å™¨çš„ View éƒ¨åˆ†çš„æ„æƒ³ä¸å¤ªä¸€æ ·ï¼Œå¾ˆéš¾èåˆåœ¨ä¸€èµ·ï¼Œå¦å¤–å°±æ˜¯å®ƒæœ¬èº«è‡ªå·±ä¹Ÿæ¯”è¾ƒéš¾å®ç°ï¼Œæ‰€ä»¥æˆ‘å°±ç”¨äº†å¾ˆç®€å•çš„ chains of lines æ¥å®ç°äº†ï¼Œå°±æ˜¯ç”¨ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢å­˜çš„æ˜¯æ¯ä¸€è¡Œçš„å†…å®¹ã€‚åºŸè¯ä¸å¤šè¯´å…ˆä¸Šä»£ç &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/vincentdchan/MDE/blob/master/src/model/textModel.ts&quot;&gt;/src/model/textModel.ts&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-typescript&quot;&gt;class TextModel {

    protected _lines : LineModel[];

    constructor(_string: string) {
        // ctor
    }

    // other methods
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/vincentdchan/MDE/blob/master/src/model/lineModel.ts&quot;&gt;/src/model/lineModel.ts&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-typescript&quot;&gt;class LineModel {

    protected _number : number;
    protected _text : string;

    constructor(_num : number, _t : string) {
        // ctor
    }

    // other methods
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ•°æ®ç»“æ„å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œå°±æ˜¯ç”¨æ•°ç»„æŠŠæ¯ä¸€è¡Œçš„å†…å®¹éƒ½å­˜èµ·æ¥å­˜èµ·æ¥ã€‚åœ¨è¿™é‡Œæˆ‘ç”¨äº†ä¸€ä¸ª LineModel çš„ç±»æ¥å‚¨å­˜ï¼Œæ˜¯å› ä¸ºæˆ‘è¿˜è¦å®ç°ä¸€äº›åˆ«çš„æ–¹æ³•ï¼Œæ¯”å¦‚æœ€å…¸å‹çš„å¢åˆ æ“ä½œã€‚å½“ç„¶æˆ‘ä»¬å®é™…ä¸Šè¦å®ç°çš„æ•°æ®ç»“æ„çš„æ“ä½œä¸æ­¢é‚£ä¹ˆå¤šï¼Œè‡³å°‘è¦æŠŠinsert, delete, replaceè¿™å‡ ä¸ªæ“ä½œéƒ½å®ç°äº†æ‰è¡Œã€‚è¿™æ ·æˆ‘ä»¬æ–‡ä¸­æ‰€æœ‰çš„å­—ç¬¦éƒ½å¯ä»¥ç”¨ä¸€ä¸ªå¯¹è±¡ Position æ¥è¡¨ç¤ºï¼Œå°±æ˜¯è¡Œ+ä½ç§»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-typescript&quot;&gt;export interface Position {
    line : number;
    offset : number;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è€Œä¸€æ®µæ–‡å­—ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„ Rangeï¼Œæˆ–è€…è¯´é€‰åŒºï¼ˆSelectionï¼‰åˆ™å¯ä»¥ç”¨ä¸¤ä¸ªPosition æ¥è¡¨ç¤ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-typescript&quot;&gt;export interface Range {
    begin: Position;
    end: Position;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æƒ³æƒ³æˆ‘ä»¬è¦åšç¼–è¾‘å™¨è¦åšçš„æ“ä½œ&lt;/p&gt;
&lt;p&gt;1.æ’å…¥ï¼ˆInsertï¼‰: åœ¨æ–‡æœ¬å†…çš„ä¸€ä¸ªä½ç½®ï¼ˆPositionï¼‰æ’å…¥ä¸€æ®µæ–‡å­—ï¼ˆstringï¼‰&lt;/p&gt;
&lt;p&gt;2.åˆ é™¤ï¼ˆDeleteï¼‰: åˆ é™¤æ‰ä¸€æ®µèŒƒå›´ï¼ˆRangeï¼‰å†…çš„æ–‡å­—&lt;/p&gt;
&lt;p&gt;3.æ›¿æ¢ï¼ˆReplaceï¼‰: æŠŠä¸€æ®µèŒƒå›´ï¼ˆRangeï¼‰å†…çš„æ–‡å­—æ›¿æ¢ä¸ºä¸€æ®µæ–°çš„æ–‡å­—ï¼ˆstringï¼‰&lt;/p&gt;
&lt;p&gt;&lt;samll&gt;å…¶å®æ›¿æ¢æ“ä½œå¾ˆå®¹æ˜“ç†è§£ï¼Œæˆ‘ä»¬å…ˆåˆ é™¤ï¼Œå†æ’å…¥å³å¯ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸»è¦å®ç° Insert å’Œ Deleteã€‚å…·ä½“çš„å®ç°æ–¹æ³•å¯ä»¥å‚è€ƒæˆ‘çš„æºç &lt;/small&gt;&lt;/p&gt;
&lt;h1&gt;å±•ç° Presentation&lt;/h1&gt;
&lt;p&gt;ä¸‹é¢è®²è®²å¦‚ä½•å±•ç°ï¼ˆpresentation)ï¼Œå°±æ˜¯å¦‚ä½•é€šè¿‡ HTML DOM æ“ä½œæŠŠæ•°æ®ç»“æ„é‡Œé¢çš„æ•°æ®å±•ç°å‡ºæ¥ï¼Œæˆ‘æƒ³å¤§å®¶éƒ½å·²ç»æƒ³åˆ°äº†ï¼Œä¸€ä¸ª LineModel å¯¹åº”ä¸€è¡Œï¼Œä¸€ä¸ªçˆ¶ DOM åŒ…å«ç€æ¯ä¸€è¡Œçš„ DOM&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/fbbaf443f03da85035ccb2a80b3965f1/b1413/screen-present.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 20.75242718446602%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAwUlEQVQI1y2OO08DMRCE7///FyqkFDRpgCBER4GQUoUkyt2e7fXa+/A9OFYK0mg0xXya6b4+j8/7w8v+9XQ8KQpB5mzWtta2MVBhHYHPPzmODCAx2jAogLqLLN3h4/th9/b49H69hLltwovKarZNDo9UxUpSHFLChklKLs4TTTlPLHOHqCy/PqW21rqwLE7+w4GwqlDDQESGWRKy90udvaZt7WLkEIrLgwtR7vD9dmXFKNcLBShDXwHsdpO+F3fm+Q8Dl+CmDoAFMAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;screen present&quot;
        title=&quot;&quot;
        src=&quot;/static/fbbaf443f03da85035ccb2a80b3965f1/84ad3/screen-present.png&quot;
        srcset=&quot;/static/fbbaf443f03da85035ccb2a80b3965f1/687da/screen-present.png 175w,
/static/fbbaf443f03da85035ccb2a80b3965f1/0ab4d/screen-present.png 350w,
/static/fbbaf443f03da85035ccb2a80b3965f1/84ad3/screen-present.png 700w,
/static/fbbaf443f03da85035ccb2a80b3965f1/ef8d3/screen-present.png 1050w,
/static/fbbaf443f03da85035ccb2a80b3965f1/fed13/screen-present.png 1400w,
/static/fbbaf443f03da85035ccb2a80b3965f1/5b79c/screen-present.png 2100w,
/static/fbbaf443f03da85035ccb2a80b3965f1/b1413/screen-present.png 2472w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;çœ‹å›¾å¯çŸ¥ï¼ŒMDE é‡Œé¢æ¯ä¸€è¡Œå…¶å®å°±æ˜¯ä¸€ä¸ª &amp;#x3C;p&gt;ï¼Œæ‰€ä»¥å…¶å®æ²¡ä»€ä¹ˆç¥ç§˜çš„ä¸œè¥¿ï¼Œä¸è¿‡å°±æ˜¯åŠ ä¸Šäº†è¡Œå·ï¼Œè¿˜æœ‰ Syntax Highlighting è€Œå·²ï¼ˆè¿™ä¸ªæˆ‘ä»¬åé¢ä¼šè¯´ï¼‰ã€‚æ€ä¹ˆæŠŠä¸Šé¢æåˆ°çš„ TextModel ç¼–ç¨‹ HTML DOM å…ƒç´ äº†ï¼Œè‡ªå·±å†™ä¸ªéå†å™¨éå†ä¸€éå°±å¥½äº†ï¼Œåœ¨è¿™é‡Œä¸æ¨èè‡ªå·±æ‹¼æ¥ HTML å­—ç¬¦ç„¶åç”¨ innerHTML æ›´æ–°ï¼Œè¿™æ ·ä¸€æ¥æ•ˆç‡ä½ä¸‹ï¼ŒäºŒæ¥éœ€è¦æ‰‹åŠ¨è¿‡æ»¤å­—ç¬¦ï¼Œä¸‰æ¥ä¸æ–¹ä¾¿æˆ‘ä»¬åç»­çš„æ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;éå†ä¸€é TextModelï¼Œç„¶åç”¨ document.createElement å¥½äº†ï¼Œè¿™é‡Œä½ å¯èƒ½éœ€è¦ä¸€ä¸ªæ–¹ä¾¿çš„å·¥å…·ç±»&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/vincentdchan/MDE/blob/master/src/util/dom.ts&quot;&gt;/src/util/dom.ts&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-typescript&quot;&gt;function elem(elemName : string, className?: string, props?: any) {
    let _elm = document.createElement(elemName);

    if (className)
        _elm.setAttribute(&quot;class&quot;, className);

    if (props &amp;#x26;&amp;#x26; typeof props === &quot;object&quot;) {
        for (let key in props) {
            _elm.setAttribute(key, props[key]);
        }
    }

    return _elm;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…·ä½“çš„å®ç°å¤§å®¶å¯ä»¥å‚è€ƒä¸‹åˆ—å‡ ä¸ªæ–‡ä»¶ï¼Œä¸è¿‡å› ä¸ºå·²ç»å®ç°äº† Syntax Highlightingï¼Œå¯èƒ½ç°åœ¨çš„ç‰ˆæœ¬å·²ç»å¾ˆå¤æ‚äº†ï¼Œåˆå­¦çš„è¯çœ‹å¯èƒ½æœ‰ç‚¹å‹åŠ›&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/vincentdchan/MDE/blob/master/src/view/viewLine.ts&quot;&gt;/src/view/viewLine.ts&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/vincentdchan/MDE/blob/master/src/view/viewDocument.ts&quot;&gt;/src/view/viewDocument.ts&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œä½ å¯èƒ½å·²ç»çŸ¥é“æ€ä¹ˆæŠŠ TextModel é‡Œé¢çš„å†…å®¹å±•ç°å‡ºæ¥äº†ï¼Œä½†æ˜¯åšä¸€ä¸ªç¼–è¾‘å™¨ï¼Œä»…ä»…è¿™æ ·è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œä¸‹ä¸€å¼ è®²è®²å¦‚ä½•æ›´æ–°è§†å›¾ã€‚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ä»å¤´æ‰“é€ ä¸€ä¸ª Markdown ç¼–è¾‘å™¨ï¼ˆåºç« ï¼‰]]></title><link>https://diverse.space/2017/01/markdown-editor-2</link><guid isPermaLink="false">https://diverse.space/2017/01/markdown-editor-2</guid><pubDate>Sun, 01 Jan 2017 09:13:00 GMT</pubDate><content:encoded>&lt;p&gt;å¼€å§‹å†™æ–‡ç« ä¹‹å‰ï¼Œå…ˆæ‰“ä¸ªå°å¹¿å‘Šï¼Œå°±æ˜¯å°å¼Ÿæ–°é²œå‡ºç‚‰çš„ä½œå“ MDEï¼Œä¸€ä¸ªå®Œå…¨å…è´¹çš„ï¼Œå¼€æºçš„ï¼ŒåŸºäº Electron çš„ Markdown ç¼–è¾‘å™¨&lt;a href=&quot;https://github.com/vincentdchan/MDE&quot;&gt;MDE Editorï¼Œç‚¹å‡»é“¾æ¥&lt;/a&gt;è¿›å…¥GitHub&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2c8b1f22315d52bfaada2c27347674af/a9195/screen-mde.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 53.63281250000001%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABaUlEQVQoz2VR246CMBTk///IRze+GcWgG90XVynIrVfaUi6l3YPsJmyYTEgDZzpzhmCz2Ww/tsfjMQzD438cDgdKqfd+GIZ+haZpglP4udsdzudbFF2XvFy+9vtT+AZjDK5wzvkF4Magb50harTTpyUBTWNmf5jzK0xiVXey4I0ejHFLdp2nVEdRVFXV2nYhprrrfd97EMxPIJhxbq7XmxAClNba8Q3nxvkMawcwkeVMyUHKXqlh5nyu6/bxeCAUw85FUUAESgmlglKulNJaB4w1CSoRMCnTF8kyAm8wrquqJkTmeZ4kGSihWzmhZsxY+xcbJp6ozF+MpZQiXKaE8RbCw4SUbVlWcayM6daFQfhAiDaOc8GNUdbosTVOawuFta2H2K9XhjEHW1jS/mLefZycRd3d70maVggVjDeDnToDQmFKgTNGyI3j2tiDPkiS6nb7BnNCFMYStpgJ/ynLcBw/GROcizWgxR+OQm0kEXBfDgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;screen mde&quot;
        title=&quot;&quot;
        src=&quot;/static/2c8b1f22315d52bfaada2c27347674af/84ad3/screen-mde.png&quot;
        srcset=&quot;/static/2c8b1f22315d52bfaada2c27347674af/687da/screen-mde.png 175w,
/static/2c8b1f22315d52bfaada2c27347674af/0ab4d/screen-mde.png 350w,
/static/2c8b1f22315d52bfaada2c27347674af/84ad3/screen-mde.png 700w,
/static/2c8b1f22315d52bfaada2c27347674af/ef8d3/screen-mde.png 1050w,
/static/2c8b1f22315d52bfaada2c27347674af/fed13/screen-mde.png 1400w,
/static/2c8b1f22315d52bfaada2c27347674af/5b79c/screen-mde.png 2100w,
/static/2c8b1f22315d52bfaada2c27347674af/a9195/screen-mde.png 2560w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆªå›¾ä¸ºåœ¨ Windows 10 ä¸Šè¿è¡Œçš„æ•ˆæœ&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/9ef094f703837e7c78add9c69ca7b7a2/a9195/screen-mde-night.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 53.63281250000001%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABc0lEQVQoz22Se2+CMBTFq9MMtVCoFGxB5KH4iMz5ac1MjEb3h5j4HXcohrjNX8jlNuH03Adkt9vtv/ZlWd5ut1Jz0yC53+/X6/V4PJ5OJ8TD4YD4rblcLufzmTjcDmOeLoSMOLNsxlhPYxiGZVlKKdd1J5rNZpNlGSGk1WohttttIoSbz7MkjVQglZK+70NjapB4nqfGYQwmkyRJpJS1GFRix3GGruDcHVDT6PX6/T6l9CFmzLbt1Anoe78xbKiOjm0rz51EKonh4VfmnjC1HC3QwWBKpdF9J/+oxL7nbT8/Vqt5UaziOGLarXZGjkLiJC6KAscXYswjz3MMBma0Rivxxi2YHFpN03Q8HiP/Kx4Oh8vlcjabcc7NJyCuyqYUQ+l2u6/LhvNisYAYa2jm3BAEwXq9RoLZdjqdtycqsRACJdWL+eWs42g0mk6n+AC3hGFYR/SIBHUR7nCz6bbq9/Ewy2QQS7ndbmGOf6aptt4ZzH8AhcdKi1MTbe8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;screen mde night&quot;
        title=&quot;&quot;
        src=&quot;/static/9ef094f703837e7c78add9c69ca7b7a2/84ad3/screen-mde-night.png&quot;
        srcset=&quot;/static/9ef094f703837e7c78add9c69ca7b7a2/687da/screen-mde-night.png 175w,
/static/9ef094f703837e7c78add9c69ca7b7a2/0ab4d/screen-mde-night.png 350w,
/static/9ef094f703837e7c78add9c69ca7b7a2/84ad3/screen-mde-night.png 700w,
/static/9ef094f703837e7c78add9c69ca7b7a2/ef8d3/screen-mde-night.png 1050w,
/static/9ef094f703837e7c78add9c69ca7b7a2/fed13/screen-mde-night.png 1400w,
/static/9ef094f703837e7c78add9c69ca7b7a2/5b79c/screen-mde-night.png 2100w,
/static/9ef094f703837e7c78add9c69ca7b7a2/a9195/screen-mde-night.png 2560w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ”¯æŒçš„åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å³æ—¶æ¸²æŸ“&lt;/li&gt;
&lt;li&gt;Markdown è¯­æ³•é«˜äº®ï¼ˆSyntax Highlightingï¼‰&lt;/li&gt;
&lt;li&gt;ç™½å¤©æ¨¡å¼å’Œå¤œé—´æ¨¡å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªå·²ç»ç‰ˆæœ¬åœ¨2017å¹´å…ƒæ—¦å‘å¸ƒäº†ï¼Œç°åœ¨æˆ‘åªæ‰“åŒ…äº† Windows win32 64 ä½ç‰ˆæœ¬ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥ä¸‹è½½æ¥è·‘ä¸€ä¸‹ã€‚è¿Ÿäº›æˆ‘ä¼šæ‰“åŒ… Linux ç‰ˆæœ¬ï¼Œè‡³äº Mac çš„è¯ï¼Œæˆ‘èº«è¾¹æ²¡æœ‰è®¾å¤‡è¿˜çœŸä¸å¥½æã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/vincentdchan/MDE/releases&quot;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®ç°åœ¨è¿™ä¸ªæ—¶ä»£ï¼Œå¥½ç”¨ï¼Œèƒ½ç”¨çš„ Markdown ç¼–è¾‘å™¨å·²ç»å¾ˆå¤šäº†ï¼Œæ¯”å¦‚æˆ‘å¾ˆå–œæ¬¢çš„ Typoraï¼ŒCMD Markdownï¼Œè¿˜æœ‰å„ç§ç¼–è¾‘å™¨åŠ ä¸Š Markdown æ’ä»¶ä¹Ÿå¾ˆå¥½ç”¨ï¼ŒåŠ ä¸Š Markdown è¯­æ³•æ¯”è¾ƒå°ä¼—ï¼Œæ‰€ä»¥è¯´è‡ªå·±æ’¸ä¸€ä¸ªå…¶å®æ„ä¹‰ä¸å¤§ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘è¿˜è¦å†™è¿™æ ·ä¸€ä¸ªç¼–è¾‘å™¨å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸€æ¥å…¶å®æ˜¯æˆ‘ä¸€ç›´å¾ˆå¥½å¥‡æˆ‘ä»¬å¹³æ—¶ç”¨çš„è¿™ä¹ˆå¤šç¼–è¾‘å™¨æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œè¿™æ–¹é¢çš„èµ„æ–™ä¹Ÿä¸å¤šï¼Œäºæ˜¯æ‰“ç®—è‡ªå·±ä»å¤´æ’¸ä¸€ä¸ªï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æŒæ¡ä¸€äº›çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;p&gt;äºŒæ¥æˆ‘æ˜¯å¹¿å·æŸé«˜æ ¡çš„ CS å­¦ç”Ÿï¼Œç½‘ä¸Šå¾ˆå¤šäººè¯´ç°åœ¨å­¦æ ¡å‡ºæ¥çš„å­¦ç”Ÿä»€ä¹ˆéƒ½åšä¸äº†ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿå†™ä¸ªèƒ½ç”¨çš„ä¸œè¥¿æ¥è¯æ˜ä¸€ä¸‹è‡ªå·±å¯¹å§&lt;/p&gt;
&lt;p&gt;ä¸‰æ¥ï¼Œè¿™ä¸ªç¨‹åºæ˜¯å¼€æºçš„ï¼Œå…è´¹æ— å¹¿å‘Šçš„ï¼Œå¸Œæœ›æœ‰å¿—åŒé“åˆçš„æœ‹å‹å¯ä»¥ä¸€èµ·å­¦ä¹ ï¼Œäº¤æµï¼Œæ‰€ä»¥æˆ‘ä¼šæŠŠæˆ‘å¼€å‘è¿‡ç¨‹çš„ä¸€äº›æƒ³æ³•å’Œå¿ƒå¾—éƒ½å†™å‡ºæ¥ï¼Œæˆ‘ä¼šåœ¨çŸ¥ä¹ä¸“æ å‘è¡¨ä¸€ç³»åˆ—å…³äºè¿™ä¸ªç¼–è¾‘å™¨çš„æ–‡ç« ï¼Œè¿™ä¸ªåªæ˜¯åºç« ï¼Œå¸Œæœ›æœ‰æœ‹å‹å¯ä»¥ä¸€èµ·äº¤æµ&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªåºç« ï¼Œæˆ‘ç®€å•ä»‹ç»ä¸€ä¸‹æˆ‘åšè¿™ä¸ªç¼–è¾‘å™¨éœ€è¦çš„ä¸€äº›ä¸œè¥¿ï¼Œæˆ‘çš„ç¼–è¾‘å™¨æ˜¯åŸºäº Electronï¼Œä¸»è¦æ˜¯çœ‹ä¸Šäº†è·¨å¹³å°çš„ç‰¹æ€§ï¼Œä»¥åŠæˆ‘å¯¹ Javascipt æ¯”è¾ƒç†Ÿæ‚‰ï¼Œå¯¹ Typescript æ¯”è¾ƒæ„Ÿå…´è¶£çš„åŸå› ï¼Œæˆ‘çš„ç¼–è¾‘å™¨æ˜¯ç”¨ Typescript + Electron å®ç°çš„ï¼Œæˆ‘çš„æ–‡ç« ä¸»è¦ä¹Ÿæ˜¯è®²è¿™ä¸ªï¼Œå¦‚æœæœ‰è¦åŠ¨æ‰‹çš„æœ‹å‹å¯ä»¥é€‰æ‹©è‡ªå·±å–œæ¬¢çš„æ¡†æ¶å’Œè¯­è¨€ï¼Œæ‰“é€ ä¸€ä¸ª Markdown ç¼–è¾‘å™¨çš„æ—…ç¨‹å°±è¦å¼€å§‹äº†ï¼Œä½ å‡†å¤‡å¥½äº†å—ï¼Ÿ&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Syntax Highlightingä¹‹åçš„è§†å›¾æ›´æ–°]]></title><link>https://diverse.space/2016/12/views-update-after-syntax-highlighting</link><guid isPermaLink="false">https://diverse.space/2016/12/views-update-after-syntax-highlighting</guid><pubDate>Fri, 16 Dec 2016 09:56:00 GMT</pubDate><content:encoded>&lt;p&gt;å‰ä¸€ç¯‡blogè®²è¿°äº†å¦‚ä½•ç»™ç¼–è¾‘å™¨åšSyntax Highlightingï¼Œå¯æ˜¯åšå®Œä¹‹åè¦æ€ä¹ˆæ ·ç»™è§†å›¾æ›´æ–°æ‰ä¼šåšåˆ°æ›´é«˜æ•ˆå‘¢&lt;/p&gt;
&lt;p&gt;æ¯•ç«Ÿæˆ‘ä»¬é‡‡ç”¨è¿™ç§Syntax Highlightingçš„æ–¹æ³•ï¼Œ å°±æ˜¯è¦ä¿è¯é«˜æ•ˆï¼Œå¦‚æœä¸èƒ½å¥½å¥½åˆ©ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„è¿™ç§æ–¹æ³•å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ï¼Œå½“ä¸€è¡Œæ”¹å˜äº†ä¹‹åï¼Œè¿™è¡Œä¸‹é¢çš„çŠ¶æ€å¯èƒ½å…¨éƒ¨éƒ½ä¼šæ”¹å˜ï¼Œæ‰€ä»¥è¿™ä¸€è¡ŒåŒ…æ‹¬ä¸‹é¢æ‰€æœ‰è¡Œéƒ½è¦é‡æ–°è¿›è¡ŒTokenizeï¼Œæ¯«æ— ç–‘é—®ï¼Œå¦‚æœæ–‡ä»¶å¾ˆå¤§ï¼Œå¦‚æœç”¨UIçº¿ç¨‹è¿›è¡ŒTokenizeï¼Œå¯èƒ½ä¼šé€ æˆå¡é¡¿ã€‚ä¸è¿‡å°±ç®—æ˜¯ä¸€ä¸ªå‡ åƒè¡Œçš„æ–‡ä»¶ï¼Œæ¯è¾“å…¥ä¸€æ¬¡ï¼Œè¿›è¡Œå…¨æ–‡Tokenizeï¼Œå…¨æ–‡æ‰«ä¸€éï¼Œä¹Ÿæ˜¯ç¬é—´å®Œæˆçš„äº‹æƒ…ï¼Œæˆ‘ä»¬å¤§å¯ä¸å¿…ä¸ºæ­¤æ“å¿ƒï¼Œä½†æ˜¯è°çŸ¥é“ä¼šä¸ä¼šæœ‰å…¶å®ƒæƒ…å†µï¼Œæ¯”å¦‚çªç„¶å‘ç”Ÿäº†GCï¼Œæˆ–è€…è¾“å…¥è€…æ‰‹é€Ÿå¤ªå¿«äº†ã€‚å½“ç„¶ï¼Œè¿™å±‚æˆ‘ä»¬æ˜¯ä¸çŸ¥é“çš„ï¼Œä½†æ˜¯æˆ‘æƒ³åˆ°äº†æ›´å¥½çš„åŠæ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€è¡Œå‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆè¿™ä¸€è¡Œè¦é©¬ä¸Šæ›´æ–°ï¼Œè¿™æ—¶è‚¯å®šçš„ï¼Œä¹Ÿå‡ ä¹ä¸ä¼šæ¶ˆè€—ä»€ä¹ˆæ—¶é—´ï¼Œå°±ç®—ä¸€è¡Œæœ‰å¥½å‡ ç™¾ä¸ªå­—ï¼Œä¹Ÿå‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œæ‰€ä»¥æˆ‘çš„ç¼–è¾‘å™¨åœ¨è¾“å…¥è¿™ä¸€è¡Œçš„æ—¶å€™ï¼Œä¼šé©¬ä¸Šè¿›è¡ŒTokenizeï¼Œé©¬ä¸Šè¿›è¡Œä¸Šè‰²ã€‚ä½†æ˜¯è¿™ä¸€è¡Œä¸‹é¢çš„è¡Œå´ä¸è¦æ±‚é©¬ä¸Šè¿›è¡Œæ›´æ–°ï¼Œå› ä¸ºå¦‚æœæ­£åœ¨è¾“å…¥è¿™ä¸€è¡Œï¼Œåªæ˜¯è¾“å…¥äº†ä¸€äº›æ­£å¸¸çš„å­—ç¬¦ï¼Œè€Œæ²¡æœ‰è§¦å‘ä»€ä¹ˆåŠ ç²—ä»€ä¹ˆçš„ï¼Œé‚£ä¹ˆä¸‹é¢çš„è¡Œå…¶å®æ— éœ€æ›´æ–°ï¼Œå°±ç®—è§¦å‘äº†ï¼Œæˆ‘ä»¬ä¹Ÿä¸è¦æ±‚é©¬ä¸Šè¿›è¡Œæ›´æ–°ï¼Œå¯¹å§ã€‚å¾ˆæ˜æ˜¾ä¸‹é¢è¡Œæ•°çš„æ›´æ–°å°±è¦å¼‚æ­¥è¿›è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/05ee6c32981bb80cd2f4c5820305f335/b109a/RenderLine.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 623px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 39.00481540930979%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhElEQVQoz2NgIBLU1NSAaRsbG+I0GBoagmlvb28wff78eYYTJ06A2WlpaWC6u7ub8f///0y9vb1s4eHhYq6urvx5eXniV69eLbl06ZIrTkOJABxQzODp6cl85MgRgdTUVEmwDMgVDx48YL5+/TrLv3//mIASLEBh5nPnzsmdPHlSRk5OjhXoIi6gGMuSJUtU3759OxGofsfTp0+3vHz5sjgoKIgTZI6SkpIg0PWYVgsLCwsAKdbjx4+brlu3Tg1JimvChAl+Hz58uPHixYsfr1+//vn8+fPNMTEx4hoaGrxOTk5cYFXHjh0TuXfvXsLNmzfLHj16FFtXV6d29uxZCaBXOK5cueJ4+/bt4vv372ceOHDACGZyVVUVu76+PjO6Y4yMjMCB7wC07SnQ1u9v3rx5sn37dp8LFy74zJo1y+7u3bsHnj17BnLJN2DAN4A0Ab3FCDMAxJ44cSIj1tgvKiriwRb6paWlXH5+fqwwPjAcGU6fPs0ADGMGYLjDDGYAhj2YDQAWw7b2V6zBHgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;RenderLine&quot;
        title=&quot;&quot;
        src=&quot;/static/05ee6c32981bb80cd2f4c5820305f335/b109a/RenderLine.png&quot;
        srcset=&quot;/static/05ee6c32981bb80cd2f4c5820305f335/995c0/RenderLine.png 175w,
/static/05ee6c32981bb80cd2f4c5820305f335/69d98/RenderLine.png 350w,
/static/05ee6c32981bb80cd2f4c5820305f335/b109a/RenderLine.png 623w&quot;
        sizes=&quot;(max-width: 623px) 100vw, 623px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹è¿™å¼ å›¾ï¼Œå°±æ˜¯ä¸€è¡Œçš„&lt;strong&gt;æ¸²æŸ“çŠ¶æ€&lt;/strong&gt;å›¾äº†&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Null -&gt; æ²¡æœ‰è¿›è¡Œæ¸²æŸ“&lt;/p&gt;
&lt;p&gt;Plain Text -&gt; æ¸²æŸ“äº†ï¼Œæ²¡æœ‰ä¸Šè‰²ï¼Œæ˜¯çº¯è‰²æ–‡å­—&lt;/p&gt;
&lt;p&gt;Colored -&gt; å·²ç»å®Œæˆäº†ä¸Šè‰²&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬æ¸²æŸ“æœ‰ä¸¤ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯ç«‹å³ï¼ˆImdï¼‰å’Œå»¶è¿Ÿï¼ˆLazyï¼‰æ›´æ–°ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æœ‰ä¸‹å›¾çš„è¡¨æ ¼&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;Null&lt;/th&gt;
&lt;th&gt;Plain Text&lt;/th&gt;
&lt;th&gt;Colored&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Imd&lt;/td&gt;
&lt;td&gt;é©¬ä¸Šåœ¨UIå±‚è¿›è¡Œæ¸²æŸ“ï¼Œè·³åˆ°ColoredçŠ¶æ€&lt;/td&gt;
&lt;td&gt;é©¬ä¸Šè¿›è¡Œä¸Šè‰²ï¼Œè·³åˆ°ColoredçŠ¶æ€&lt;/td&gt;
&lt;td&gt;ç«‹å³è¿›è¡Œé‡æ–°æ¸²æŸ“ï¼Œæ›´æ–°&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Lazy&lt;/td&gt;
&lt;td&gt;å…ˆæ¸²æŸ“æˆçº¯è‰²çš„å­—ç¬¦ï¼Œä¸è¿›è¡Œä¸Šè‰²ï¼Œè·³åˆ°PlainTextçŠ¶æ€&lt;/td&gt;
&lt;td&gt;è°ƒç”¨åå°çº¿ç¨‹è¿›è¡Œä¸Šè‰²ï¼Œä¸Šè‰²å®Œæˆåè°ƒç”¨Callbackï¼Œç„¶åæ›´æ–°UIï¼Œç„¶åè·³åˆ°ColoredçŠ¶æ€&lt;/td&gt;
&lt;td&gt;è°ƒç”¨åå°çº¿ç¨‹è¿›è¡Œé‡æ–°ä¸Šè‰²å’Œæ¸²æŸ“ï¼Œå®Œæˆåè°ƒç”¨Callbackæ›´æ–°UIå±‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt; æ‰€ä»¥å¦‚æœæ˜¯æ›´æ–°&lt;strong&gt;æ­£åœ¨ç¼–è¾‘&lt;/strong&gt;çš„è¡Œçš„è¯ï¼Œå°±è°ƒç”¨Imdæ¨¡å¼è¿›è¡Œæ¸²æŸ“å’Œæ›´æ–°ï¼Œå¦‚æœæ˜¯&lt;strong&gt;æ­£åœ¨ç¼–è¾‘ä¸‹é¢çš„è¡Œ&lt;/strong&gt;çš„è¯ï¼Œå°±è°ƒç”¨Lazyæ¸²æŸ“å’Œæ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt; å½“ç„¶ï¼Œç”±äºæˆ‘æ˜¯ç”¨NodeJSè¿›è¡Œå®ç°ï¼Œæ‰€ä»¥å°±æ²¡æœ‰åŠæ³•è°ƒç”¨åå°çº¿ç¨‹ï¼ˆThreadï¼‰ï¼Œåªèƒ½é€šè¿‡IPCè°ƒç”¨åå°è¿›ç¨‹ï¼ˆProcessï¼‰ï¼Œä¸è¿‡åŸç†æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
&lt;p&gt; ä½†æ˜¯å…³äºåå°æ›´æ–°æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åå°Tokenizeå®Œæˆä»¥åï¼Œç”¨æˆ·å·²ç»åˆæ›´æ–°äº†ï¼Œæ¯”å¦‚è¯´æˆ‘ç¬¬7è¡Œå®Œæˆäº†Tokenizeï¼Œä½†æ˜¯è¿™æ—¶å¯èƒ½ç”¨æˆ·åˆé‡æ–°è¾“å…¥äº†ç¬¬3è¡Œï¼Œè¿™æ—¶ç¬¬3è¡Œä¹‹åçš„è¡Œæ•°éƒ½ä¼šåœ¨åå°è¿›è¡ŒTokenizeæ“ä½œï¼Œå¯æ˜¯è¿™æ—¶åŸæ¥å·²ç»Tokenizeçš„ç¬¬7è¡Œçš„ç»“æœå·²ç»æ²¡æœ‰æ„ä¹‰äº†ï¼Œæ‰€ä»¥ä¸èƒ½è®©å®ƒæ›´æ–°UIå±‚ã€‚è¿™æ—¶æˆ‘ä»¬å¯èƒ½éœ€è¦ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼ˆPriority Queueï¼‰ï¼Œæ¥å¾—åˆ°ç›®å‰ç­‰å¾…Tokenizeçš„æœ€å°çš„è¡Œå·ã€‚&lt;/p&gt;
&lt;p&gt; ä»ç„¶ç”¨å›åˆšæ‰çš„ä¾‹å­ï¼Œå½“æˆ‘ä»¬ç¬¬7è¡Œå·²ç»Tokenizeå®Œæˆçš„æ—¶å€™ï¼Œå‡†å¤‡æ›´æ–°UIå±‚ï¼Œè¿™æ—¶ç¬¬3è¡Œè§¦å‘äº†è¾“å…¥ï¼Œç¬¬ä¸‰è¡Œæœ¬èº«ç«‹åˆ»å®Œæˆäº†æ¸²æŸ“ï¼Œè¿™æ—¶ç¬¬3è¡Œä¹‹åçš„è¡Œæ•°ï¼ˆ4..ï¼‰å…¨éƒ¨åŠ å…¥Priority Queueï¼Œè¿™æ—¶ç¬¬7è¡Œçš„callbackè°ƒç”¨Priority Queueçš„é˜Ÿåˆ—å¤´ï¼Œå¾—åˆ°å½“å‰æœ€å°çš„æ˜¯4ï¼Œä¹Ÿå°±æ˜¯ç¬¬4è¡Œæ­£åœ¨åå°è¿›è¡ŒTokenizeï¼Œæ‰€ä»¥ç¬¬7è¡ŒTokenizeçš„ç»“æœä¸ä¼šæ›´æ–°åˆ°è§†å›¾ã€‚å½“ç¬¬4è¡Œçš„Tokenizeå®Œæˆä¹‹åï¼Œè°ƒç”¨æ›´æ–°è§†å›¾çš„Callbackï¼Œè¿™æ—¶æ£€æŸ¥åˆ°å½“å‰Priority Queue çš„é˜Ÿåˆ—å¤´æ­£æ˜¯4ï¼Œç„¶åæ›´æ–°è§†å›¾ï¼ŒæŠŠ4åœ¨é˜Ÿåˆ—é‡Œé¢Popå‡ºæ¥ã€‚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[å¦‚ä½•å®ç°ç¼–è¾‘å™¨æ–‡æœ¬è¯­æ³•é«˜äº®ç€è‰²]]></title><link>https://diverse.space/2016/11/how-to-hightlight-syntax-for-editor</link><guid isPermaLink="false">https://diverse.space/2016/11/how-to-hightlight-syntax-for-editor</guid><pubDate>Sun, 06 Nov 2016 13:06:00 GMT</pubDate><content:encoded>&lt;p&gt;æœ€è¿‘æ­£åœ¨å°è¯•é€ ä¸€ä¸ªMarkdownç¼–è¾‘å™¨çš„è½®å­ &lt;a href=&quot;https://github.com/vincentdchan/MDE&quot;&gt;MDE&lt;/a&gt; ç°åœ¨ç®—æ˜¯å®ç°äº†ç®€å•çš„æ•°æ®ç»“æ„ï¼Œç”¨ chains of lineså®ç°äº†ï¼Œæ”¯æŒæ’å…¥ï¼Œåˆ é™¤ï¼Œæ›¿æ¢æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;è‡³äº Model è‡³è§†å›¾ï¼ˆViewï¼‰å±‚é¢çš„æ›´æ–°å°±ç®€å•äº†ï¼Œåªè¦åˆ¤æ–­å‡ºæ’å…¥ã€åˆ é™¤çš„é‚£å‡ è¡Œï¼Œå»æ›´æ–° DOM é‡Œé¢é‚£å‡ è¡Œå°±å¯ä»¥äº†ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯éå¸¸ç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰æ¯”è¾ƒæ£˜æ‰‹çš„ä¸€ä¸ªé—®é¢˜æ˜¯ç»™ &lt;strong&gt;Syntax Highlighting&lt;/strong&gt;ã€‚Syntax Highlighting æ˜¯ç¼–è¾‘å™¨å¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†ã€‚å› ä¸ºå®ƒéœ€è¦é€Ÿåº¦éå¸¸å¿«ï¼Œå¿…é¡»åœ¨è¾“å…¥ç¬é—´å°±å®Œæˆï¼Œè¿™æ ·ä¸ä¼šç»™ç”¨æˆ·å‘ç°æœ‰å¡é¡¿ã€‚è€Œä¸”å®ƒå¿…é¡»åœ¨è¾“å…¥ç¬é—´å®Œæˆã€‚æˆ‘æƒ³è¿‡ä¸€ç§åšæ³•å°±æ˜¯ï¼Œå…ˆæ˜¾ç¤ºæ²¡æœ‰ç€è‰²çš„æ–‡æœ¬ï¼Œç„¶ååœ¨åå°è¿›è¡Œç€è‰²ï¼Œç„¶åå†æ›´æ–°è§†å›¾(View)ã€‚ä½†æ˜¯æˆ‘è§‰å¾—è¿™æ ·çš„åšæ³•å°±ä½“éªŒéå¸¸å·®äº†ï¼Œç”¨æˆ·è¾“å…¥çš„æ—¶å€™ï¼Œæ–‡æœ¬æ²¡æœ‰è¢«ç€è‰²ï¼Œè€Œæ˜¯ç­‰ä¸€æ®µæ—¶é—´æ‰æœ‰ï¼Œä¼šè®©äººè§‰å¾—éå¸¸ä¸æµç•…ã€‚æ‰€ä»¥ Syntax Highlighting å¿…é¡»å†ç”¨æˆ·è¾“å…¥çš„ç¬é—´å®Œæˆã€‚å¦å¤–ï¼Œæˆ‘ç”¨å¾ˆå¤šåŸºäºWebçš„ç¼–è¾‘å™¨(Atom, Typora)éƒ½è§‰å¾—ä¸å¦‚ Native çš„ï¼ˆSublime Textï¼‰ä¹‹ç±»çš„æ¥å¾—å¿«ï¼Œè¿™æ ·å°±é€ æˆäº†ä½“éªŒä¸å¥½ï¼Œæ‰€ä»¥æˆ‘å†™çš„ Syntax Highlighting å¿…é¡»è¦å¿«ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘çš„ç¼–è¾‘å™¨åªæ”¯æŒ Markdown è¯­æ³•ï¼ŒæŒ‰é“ç†æ¥è¯´ Markdown è¯­æ³•ï¼ˆåŒ…å«HTMLï¼‰æ˜¯å±äº&lt;strong&gt;æœ‰é™è‡ªåŠ¨æœºï¼ˆFinite-Stateï¼‰&lt;/strong&gt;è¯­æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦å†™Lexer(Tokenizer)å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¿™æ ·æƒ³çš„è¯ï¼Œå°±ç®€å•äº†ï¼Œæœ‰é™è‡ªåŠ¨æœºè¯­æ³•ç›´æ¥ç”¨&lt;strong&gt;æ­£åˆ™è¡¨è¾¾å¼ï¼ˆRegular Expressionï¼‰&lt;/strong&gt;åšå°±å¥½äº†ï¼Œå¦‚æœä¸€è¡Œæœ‰æ›´æ–°ï¼Œå°±å¯¹è¿™ä¸€è¡Œè¿›è¡Œ&lt;strong&gt;é‡æ–° Tokenize&lt;/strong&gt;ï¼Œç„¶åå†æ›´æ–°è§†å›¾ï¼ˆViewï¼‰ï¼Œä¸€è¡Œæ¥è¯´ä¸€ä¸ä¼šè¶…è¿‡ 50 ä¸ªå­—ï¼Œå¦‚æœæ˜¯ DFA çš„è¯ï¼Œé€Ÿåº¦ä¼šå¾ˆå¿«ï¼ŒåŸºæœ¬ä¸ç”¨æ‹…å¿ƒé€Ÿåº¦é—®é¢˜ï¼Œå³ä½¿æ˜¯æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿä¸ä¼šæ…¢å¤šå°‘ï¼Œä½†æ˜¯è¿™å°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ¢è¡Œçš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-html&quot;&gt;&amp;#x3C;div
id = &quot;name&quot;&gt;&amp;#x3C;/div&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å› ä¸º Markdown è¯­æ³•æ˜¯å…¼å®¹ HTML çš„ï¼Œå‡è®¾ï¼Œæˆ‘ä»¬æœ‰ä¸€å¥ htmlï¼Œå®ƒçš„ tag åœ¨ç¬¬ n è¡Œï¼Œå®ƒçš„ attributeåœ¨ç¬¬ n+1ï¼Œå¦‚æœæˆ‘ä»¬åªå¯¹ä¸€è¡Œåšæ­£åˆ™è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆç¬¬ n+1 è¡Œçš„ attribute å°±æ— æ³•æ„ŸçŸ¥ä¸Šä¸€è¡Œçš„æ”¹å˜äº†ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨ä¸Šé¢å¾—ä¾‹å­ç¬¬äºŒè¡Œä¸Šé¢åŠ ä¸Š&lt;code&gt;&amp;#x3C;div&gt;&lt;/code&gt;è¿™æ ·ä¸€è¡Œï¼Œä¸‹é¢çš„è¯­æ³•é«˜äº®éƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚é‚£æ˜¯å¦æ„å‘³ç€ï¼Œæˆ‘ä»¬æ¯ä¸€æ¬¡æ”¹å˜ï¼Œéƒ½è¦å¯¹æ•´ä¸ªæ–‡æœ¬è¿›è¡Œ tokenize å‘¢ï¼Ÿå½“ç„¶è¿™æ ·è‚¯å®šæ˜¯ä¸åˆ‡å®é™…çš„ï¼Œä¸Šé¢è¯´è¿‡ï¼Œè¯­æ³•é«˜äº®å¿…é¡»æ˜¯å®æ—¶çš„ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œä½†æ˜¯ Syntax Highting ä¾ç„¶ä¸ä¸Šä¸‹æ–‡æœ‰å…³ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ CodeMirror çš„åšæ³•äº†ï¼š æ¯ä¸€è¡Œä¿å­˜ä¸€ä¸ª state&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åˆšæ‰è¯´åˆ°ï¼ŒSyntax Highting éœ€è¦ç”¨åˆ°ä¸Šä¸‹æ–‡çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸€è¡Œä¿å­˜ä¸€ä¸ª stateã€‚å½“æˆ‘ä»¬å¯¹å½“å‰è¡Œè¿›è¡Œ high lighting çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨å‰ä¸€è¡Œçš„ state çš„ã€‚ä»ç„¶ç”¨å›ä¸Šé¢çš„ä¾‹å­ï¼Œç¬¬ä¸€è¡Œé‡Œé¢æˆ‘ä»¬ tokenize äº†ï¼Œè¿›å…¥äº†ä¸€ä¸ªstate è¿™ä¸ª state å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ª tag è¿˜æ²¡æœ‰å®šä¹‰å®Œï¼Œä¾‹å¦‚ &lt;code&gt;state.finishTag = false&lt;/code&gt;  å½“æˆ‘ä»¬ç¬¬äºŒè¡Œä¿®æ”¹çš„æ—¶å€™ï¼Œå°±å¯ä»¥åˆ©ç”¨ä¸Šä¸€è¡Œçš„ stateï¼Œå¾—çŸ¥æˆ‘ä»¬ä»åœ¨ä¸€ä¸ªtagé‡Œé¢ï¼Œè¿™æ ·ï¼Œç¬¬äºŒè¡Œçš„ attribute å°±å¯ä»¥æ­£ç¡®ç€è‰²äº†ã€‚ç¬¬äºŒè¡Œå®Œæˆäº† tag ä¹‹å &lt;code&gt;state.finishTag = true&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä»ç„¶ç”¨å›ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœæŸä¸€è¡Œçš„ state æ”¹å˜äº†ï¼Œä¸‹é¢æ‰€æœ‰çš„å†…å®¹éƒ½å¿…é¡»è¿›è¡Œé‡æ–° tokenizeï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸‹ä¸€ä¸‹ï¼Œç¬¬ n è¡Œè¢«ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆä¸‹æ–‡çš„ä¿®æ”¹å…¶å®ä¸éœ€è¦å®æ—¶è¿›è¡Œä¿®æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªå·¥ä½œäº¤ç»™åå°ï¼Œç”¨åˆ«çš„ process æˆ–è€… thread è¿›è¡Œï¼Œå®Œæˆä»¥åå†æ›´æ–°è§†å›¾ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿è¯å½“å‰è¡Œçš„ç€è‰²æ˜¯å®æ—¶çš„å°±å¯ä»¥äº†ã€‚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ï¼ˆç¿»è¯‘ï¼‰ç”¨ Javascript åœ¨æµè§ˆå™¨é‡Œé¢è™šæ‹Ÿä¸€ä¸ªå¯ç¼–è¾‘çš„æ§ä»¶]]></title><link>https://diverse.space/2016/10/ï¼ˆç¿»è¯‘ï¼‰ç”¨Javascriptåœ¨æµè§ˆå™¨é‡Œé¢è™šæ‹Ÿä¸€ä¸ªå¯ç¼–è¾‘çš„æ§ä»¶</link><guid isPermaLink="false">https://diverse.space/2016/10/ï¼ˆç¿»è¯‘ï¼‰ç”¨Javascriptåœ¨æµè§ˆå™¨é‡Œé¢è™šæ‹Ÿä¸€ä¸ªå¯ç¼–è¾‘çš„æ§ä»¶</guid><pubDate>Fri, 21 Oct 2016 21:44:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;strong&gt;æ­¤æ–‡ç¿»è¯‘è‡ª &lt;a href=&quot;http://marijnhaverbeke.nl/&quot;&gt;Marijn Haverbeke&lt;/a&gt; çš„ &lt;a href=&quot;http://marijnhaverbeke.nl/blog/browser-input-reading.html&quot;&gt;Faking an editable control in browser JavaScript&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä½ å½“å‰çš„é—®é¢˜æ˜¯ï¼šä½ æ­£åœ¨å†™ä¸€ä¸ªå’Œæ–‡æœ¬è¾“å…¥æ§ä»¶ï¼ˆText intput Filedï¼‰ç›¸ä¼¼çš„Javascript æ§ä»¶â€”â€”å®ƒå¿…é¡»æ˜¯ focusable çš„ï¼Œè€Œä¸”è¦æ”¯æŒå¤åˆ¶å’Œç²˜è´´ï¼Œæ¥å—ä»»æ„ç±»å‹çš„è¾“å…¥ï¼Œä½†æ˜¯å®ƒåˆä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ§ä»¶ï¼Œå› ä¸ºä½ æƒ³å»è‡ªå·±ç”»ï¼Œè€Œä¸”å¯ä»¥å®Œå…¨æ§åˆ¶å®ƒçš„å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡æ–‡ç« é‡Œé¢ï¼Œæˆ‘ä¸æƒ³è®²ä»»ä½•å…³äºç”»ä¸€ä¸ªæŒ‡é’ˆï¼ˆCursorï¼‰ï¼Œç»´æŠ¤è‡ªå·±çš„ selection ä¹‹ç±»çš„ä¸œè¥¿ã€‚å½“ç„¶ï¼Œå¯¹äºå®ç°ä¸€ä¸ªå¯é çš„æ–‡æœ¬ç¼–è¾‘å™¨æ¥è¯´ï¼Œè¿™äº›ä¸œè¥¿éƒ½æ˜¯å¿…éœ€çš„ã€‚ä½†æ˜¯ä»–ä»¬å®ç°èµ·æ¥éƒ½ç›¸å¯¹ç®€å•ã€‚&lt;/p&gt;
&lt;h2&gt;éšè—çš„ Textarea&lt;/h2&gt;
&lt;p&gt;æˆ‘çš„è§£å†³æ–¹æ¡ˆçš„ç»“ç—‡åœ¨äºä¸€å¼€å§‹æˆ‘ä» ACE editor è·å¾—çš„çµæ„Ÿï¼Œè®©æˆ‘å›´ç€ä¸€ä¸ªéšè—çš„ textarea å›¢å›¢è½¬ã€‚è¿™å°±æ˜¯å½“ &lt;code&gt;textarea&lt;/code&gt; çœ‹èµ·æ¥æ˜¯ focused çš„æ—¶å€™ï¼Œæµè§ˆå™¨å°±è®¤ä¸ºå®ƒæ˜¯ focused çš„ã€‚å®ƒå°±åƒä¸€ä¸ªå¸¸è§„çš„ focusable çš„ä¸œè¥¿ï¼Œä½ å¯ä»¥èµ‹å€¼ä¸€ä¸ª &lt;code&gt;tabindex&lt;/code&gt; ç»™å®ƒï¼Œè®©å®ƒå¾—åˆ°æˆ–è€…å¤±å» focus çš„æ—¶å€™æ¥æ”¶ &lt;code&gt;focus&lt;/code&gt; å’Œ &lt;code&gt;blur&lt;/code&gt; äº‹ä»¶ï¼Œè¿™å…è®¸æˆ‘ä»¬å»æ›´æ–°ç¼–è¾‘å™¨çš„æ ·å¼ï¼ˆæ˜¾ç¤º/éšè—çš„æŒ‡é’ˆï¼Œå½©è‰²/é»‘ç™½çš„é€‰åŒºï¼‰æ¥åæ˜ å‡ºå®ƒæ˜¯å¦æ˜¯ focused çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œè¿™ä¸ª &lt;code&gt;textarea&lt;/code&gt; ä¸€å®šä¸èƒ½æ˜¯å¯è§çš„ã€‚å› ä¸ºå¦‚æœå½“ä½ è¾“å…¥çš„æ—¶å€™ï¼Œè¿™ä¸ª &lt;code&gt;textarea&lt;/code&gt; ä¸€ç›´è·Ÿç€ä½ ï¼Œè€Œä¸”è¿˜å¸¦ä¸Šå®ƒé‚£ä¸ªè‡ªå¸¦çš„ä¸€é—ªä¸€é—ªçš„å…‰æ ‡çš„æ—¶å€™ï¼Œè¿™ä¸ªç¼–è¾‘æ§ä»¶å°±ä¼šæ˜¾å¾—æ¯«æ— çœŸå®æ„Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ï¼Œå¦‚æœä½ ç»™ä½ çš„ç¼–è¾‘å™¨è®¾ç½® &lt;code&gt;display:none&lt;/code&gt; æˆ–è€… &lt;code&gt;visibility: hidden&lt;/code&gt; å±æ€§çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè§‰å¾—å®ƒä¸æ˜¯è¿™ä¸ªé¡µé¢çœŸæ­£çš„éƒ¨åˆ†ä»è€Œä¸ä¼šå» focus å®ƒã€‚CodeMirror è®© &lt;code&gt;textarea&lt;/code&gt; ï¼ˆå˜å°ï¼‰æ”¾åœ¨ä¸€ä¸ª &lt;code&gt;overflow: hidden; height : 0&lt;/code&gt; çš„å…ƒç´ ï¼ˆdivï¼‰é‡Œé¢ï¼Œè¿™å°±è®©å®ƒå³ä¸å¯è§ï¼Œä¹Ÿå¯ä»¥ focusï¼Œä»è€Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆå¦å¤–ï¼Œä½ éœ€è¦ä¸€ä¸ª &lt;code&gt;outline: none&lt;/code&gt; æ ·å¼ï¼Œå»é˜²æ­¢ä¸€äº›æµè§ˆå™¨åœ¨å®ƒ focused çš„æ—¶å€™æ˜¾ç¤ºä¸€åœˆå…‰ç¯ï¼Œä½†å´æŸäº›åŸå› æ²¡æœ‰è¢« &lt;code&gt;overflow: hidden&lt;/code&gt; ç¦æ­¢æ‰ï¼‰&lt;/p&gt;
&lt;p&gt;å¦å¤–ä¸€ä¸ªä¸å¹¸çš„ï¼ˆæˆ–è€…è¯´æ˜¯å¹¸è¿çš„ï¼Œå–å†³ä¸ä½ æ€ä¹ˆçœ‹ï¼‰åœ¨ç¼–è¾‘å™¨ä¸Šæ•ˆæœå°±æ˜¯æµè§ˆå™¨æ¯æ¬¡éƒ½ä¼šæ»šåŠ¨æ¥æé†’æˆ‘ä»¬ç¼–è¾‘å™¨æœ‰äº‹ä»¶å‘ç”Ÿï¼Œè¿™å°±æ„å‘³ç€ï¼Œå¦‚æœ &lt;code&gt;textarea&lt;/code&gt; ç®€å•åœ°æ”¾åœ¨ç¼–è¾‘å™¨åœ°é¡¶éƒ¨ï¼Œç„¶åä½ å°±ä¼šä¸åœåœ°æ»šåŠ¨åˆ°é¡¶éƒ¨å› ä¸ºä½ æ­£åœ¨ç¼–è¾‘ç¼–è¾‘å™¨åœ°æ­¥åœ°å†…å®¹ï¼Œæ¯å½“ä½ è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œçª—å£éƒ½ä¼šæ»šåŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;CodeMirror ç»™ &lt;code&gt;div&lt;/code&gt; å…ƒç´ è®¾ç½®äº†ç»å¯¹è·¯å¾„æ¥éšè— &lt;code&gt;textarea&lt;/code&gt; ï¼Œæ¯å½“æŒ‡é’ˆç§»åŠ¨çš„æ—¶å€™ï¼Œ &lt;code&gt;textarea&lt;/code&gt; ä¹Ÿä¼šè·Ÿç€ç§»åŠ¨ã€‚è¿™æ ·çš„è¯ï¼Œä¹‹å°±ä¼šå¸®åŠ©æ»šåŠ¨åˆ°çœŸæ­£çš„è§†å›¾ã€‚&lt;/p&gt;
&lt;h2&gt;ä¿æŒé€‰æ‹©åŒºåŸŸ&lt;/h2&gt;
&lt;p&gt;å½“ç”¨æˆ·é€‰æ‹©äº†ä¸€äº›æ–‡å­—ï¼Œç„¶åå¤åˆ¶æˆ–è€…å‰ªåˆ‡ï¼Œæ­£ç¡®çš„æ–‡å­—ä¼šè¢«æ”¾åœ¨ç²˜è´´æ¿é‡Œé¢ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ„å‘³ç€é€‰åŒºé‡Œé¢çš„æ–‡å­—è¦è¢«æ­£ç¡®åœ°æ”¾åœ¨ &lt;code&gt;textarea&lt;/code&gt; é‡Œé¢ï¼Œå’Œé€‰æ‹©å®ƒä»¬ã€‚è¾¾åˆ°è¿™ä¸ªç›®çš„æœ‰ä¸¤ç§æ–¹æ³•ã€‚ç¬¬ä¸€ç§ï¼Œè¢«ACEé‡‡ç”¨äº†ï¼Œå°±æ˜¯å»ç›‘å¬ &lt;code&gt;copy&lt;/code&gt; å’Œ &lt;code&gt;cut&lt;/code&gt; äº‹ä»¶ï¼ˆåœ¨çœŸæ­£å¤åˆ¶å’Œå‰ªåˆ‡ä¹‹å‰å°±ä¼šè¢«è§¦å‘ï¼‰ï¼Œä»…å½“è¿™æ ·åœ°äº‹ä»¶è§¦å‘çš„æ—¶å€™ï¼ŒæŠŠå½“å‰é€‰æ‹©åœ°æ–‡å­—æ’å…¥åˆ° &lt;code&gt;textarea&lt;/code&gt; é‡Œé¢ç„¶åé€‰æ‹©å®ƒã€‚&lt;/p&gt;
&lt;p&gt;CodeMirror çš„å®ç°æ–¹æ³•å¹¶æ²¡æœ‰é‚£ä¹ˆèªæ˜ï¼Œä¸è¿‡æ›´å®ç”¨ã€‚å®ƒå°±æ˜¯ç®€å•åœ°åœ¨æ¯ä¸€æ¬¡é€‰æ‹©çš„æ—¶å€™æŠŠå½“å‰é€‰æ‹©çš„æ–‡å­—å¤åˆ¶åˆ° &lt;code&gt;textarea&lt;/code&gt; é‡Œé¢ã€‚è¿™ç§åšæ³•çš„ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯å½“ä½ ä»ä» &lt;code&gt;textarea&lt;/code&gt; çš„ &lt;code&gt;value&lt;/code&gt; é‡Œé¢è·å¾—ï¼ˆgetï¼‰å’Œè®¾ç½®ï¼ˆsetï¼‰è®¸å¤šæ–‡å­—çš„æ—¶å€™ï¼Œé€Ÿåº¦ä¼šå¾ˆæ…¢ã€‚å¦‚æœä½ åœ¨ CodeMirror é‡Œé¢æ”¾ä¸€ä¸ªå¾ˆå¤§çš„æ–‡æ¡£ï¼Œç„¶åæŒ‰ &lt;code&gt;Ctrl-A&lt;/code&gt; æˆ–è€… &lt;code&gt;cmd-A&lt;/code&gt; ï¼ˆå…¨é€‰ï¼‰ï¼Œè¿™å°†ä¼šæœ‰ä¸€ä¸ªå¯ä»¥å¯Ÿè§‰çš„åœé¡¿ã€‚ï¼ˆåœ¨ä¸€äº›è€çš„æµè§ˆå™¨ä¸Šï¼Œå–å†³äºæ–‡æ¡£çš„å¤§å°ï¼Œè¿™çœ‹ä¸Šå»å¯èƒ½æ›´åƒæ•´ä¸ªæµè§ˆå™¨å¡ä½ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªçŸ­æš‚çš„åœé¡¿ï¼‰&lt;/p&gt;
&lt;p&gt;ä½†è¿™ä¸ªåšæ³•çš„ä¼˜åŠ¿å°±æ˜¯å®ƒé€‚ç”¨äº Opera æµè§ˆå™¨ï¼ŒOpera æµè§ˆå™¨ä¸ä¼šè§¦å‘ &lt;code&gt;copy&lt;/code&gt; å’Œ &lt;code&gt;cut&lt;/code&gt; äº‹ä»¶ï¼Œåœ¨ Linux ä¸ŠæŸäº›æµè§ˆå™¨ï¼Œè¿™ç§åšæ³•å¯ä»¥å’Œ X Windows çš„é€‰æ‹©ç²˜è´´æ¿å¾ˆå¥½çš„å…¼å®¹ã€‚CodeMirror ä¼šèŠ±æ›´å¤§ç²¾åŠ›å»ç¼©å° &lt;code&gt;textarea.value&lt;/code&gt; çš„æ¶ˆè€—ï¼Œä¾‹å¦‚å½“ä¸€ä¸ªé€‰åŒºæ‹–åŠ¨çš„æ—¶å€™ä¸å»æ›´æ–°ï¼Œåœ¨æ‹–åŠ¨å®Œæˆåæ‰å»æ›´æ–°ã€‚&lt;/p&gt;
&lt;h2&gt;æ„ŸçŸ¥è¾“å…¥&lt;/h2&gt;
&lt;p&gt;å› æ­¤éšè—çš„ &lt;code&gt;textarea&lt;/code&gt; åŒ…å«ç€å½“å‰é€‰åŒºï¼Œå®ƒçš„å†…å®¹è¢«é€‰å–äº†ã€‚è¿™æ„å‘³ç€å½“ç”¨æˆ·è¾“å…¥ä¸€äº›ä¸œè¥¿ï¼Œæˆ–è€…ç²˜è´´æ–‡å­—ï¼Œ&lt;code&gt;textarea&lt;/code&gt; å½“å‰å†…å®¹ä¼šè¢«æ’å…¥æ–‡å­—ï¼ˆå¦‚æœä¹‹å‰æœ‰é€‰æ‹©æ–‡å­—çš„è¯ï¼Œå°±ä¼šè¦†ç›–å®ƒä»¬ï¼‰ï¼Œç„¶åæ–‡å­—ä¼šè¢«æ’å…¥åˆ°çœŸæ­£çš„æ–‡æ¡£ä¸Šé¢æŒ‡é’ˆçš„ä½ç½®å½“ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡è°å‘Šè¯‰æˆ‘ä»¬è¾“å…¥å‘ç”Ÿäº†ï¼Ÿä¸€å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›‘å¬ &lt;code&gt;keypress&lt;/code&gt;, &lt;code&gt;paste&lt;/code&gt;, &lt;code&gt;input&lt;/code&gt;è¿™æ ·çš„äº‹ä»¶ã€‚è¿™äº›äº‹ä»¶ä¼šå‘Šè¯‰æˆ‘ä»¬æœ‰äº›äº‹æƒ…å‘ç”Ÿäº†ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªå»¶è¿Ÿï¼Œç„¶ååœ¨å‡ æ¯«ç§’ä¹‹åæ£€æŸ¥ &lt;code&gt;textarea&lt;/code&gt; çš„å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡è¿™å¹¶ä¸å®Œç¾çš„ã€‚Opera ä¸ä¼šè§¦å‘ &lt;code&gt;paste&lt;/code&gt; äº‹ä»¶â€”â€”å½“ä½ ä»èœå•ç²˜è´´æ—¶ï¼Œä¹Ÿä¸ä¼šæœ‰ä»»ä½•é¼ æ ‡äº‹ä»¶è¢«è§¦å‘ã€‚å¦å¤–ï¼Œåœ¨ä¸€äº›æµè§ˆå™¨ä¸Šé¢ï¼Œè¾“å…¥æ³•è¾“å…¥çš„æ—¶å€™ &lt;code&gt;textarea&lt;/code&gt; ä¸ä¼šè§¦å‘ä»»ä½•äº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¿…é¡»æ£€æµ‹ã€‚ç„¶è€Œå¦‚æœæˆ‘ä»¬æ£€æµ‹æ¬¡æ•°è¿‡å¤šä»è€Œæ¯æ¬¡ä» &lt;code&gt;textarea&lt;/code&gt; è¯»å–æ•°æ®ï¼ˆå¯èƒ½ä¼šå¾ˆå¤§ï¼‰ï¼Œé‚£ä¹ˆæ£€æµ‹çš„ä»£ä»·å¯èƒ½å°±å¾ˆæ˜‚è´µäº†ã€‚å¹¸è¿çš„æ˜¯ï¼Œå¦‚æœ &lt;code&gt;textarea&lt;/code&gt; æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å€¼ï¼ˆé€‰æ‹©çš„æ–‡å­—ï¼‰ï¼Œé‚£äº›æ–‡å­—ä¼šè¢«é€‰æ‹©ï¼ˆselectedï¼‰ï¼Œè€Œè¾“å…¥æ–‡å­—å°±ä¼šè¦†ç›–å®ƒä»¬ã€‚å› æ­¤ï¼Œå¦‚æœ &lt;code&gt;textarea&lt;/code&gt; æœ‰ä¸€ä¸ªé€‰åŒºï¼ˆæ£€æŸ¥çš„ä»£ä»·å¾ˆä½ï¼‰ï¼Œå®ƒçš„å€¼ä¸å¿…è¢«è¯»å‡ºã€‚è¿™å°±ä¼šè®©æ£€æµ‹çš„ä»£ä»·é™ä½ï¼Œä»è€Œå…è®¸ CodeMirror å»å½“ç¼–è¾‘å™¨focused çš„æ—¶å€™å¯†é›†åœ°æ£€æµ‹ä¹Ÿä¸ä¼šæ¶ˆè€—å¤ªå¤š CPUï¼ˆå½“ç¼–è¾‘å™¨å¤±å»èšç„¦ï¼Œåœæ­¢æ£€æµ‹ï¼‰ã€‚&lt;/p&gt;
&lt;h2&gt;å…³äºè¾“å…¥æ³•&lt;/h2&gt;
&lt;p&gt;æˆ‘åœ¨ä¸Šæ–‡æåˆ°è¿‡è¾“å…¥æ³•ã€‚æˆ‘ä¸æ˜¯è¿™æ–¹é¢çš„ä¸“å®¶ï¼Œå› ä¸ºæˆ‘ä¸è¯´ä»»ä½•éœ€è¦ç”¨åˆ°è¾“å…¥æ³•çš„è¯­è¨€ã€‚ä¸è¿‡ï¼Œè¿™å…è®¸äººä»¬åœ¨å†™å¾ˆé•¿çš„è„šæœ¬çš„æ—¶å€™ï¼Œç”¨ä¸€ç³»åˆ—å¿«æ·é”®å»è¾“å…¥å­—ç¬¦ã€‚è¿™å°±éœ€è¦å®ç°åœ¨ç¼–è¾‘å™¨å±•ç¤ºå½“å‰çš„è¾“å…¥æ³•æ­£åœ¨å€™é€‰çš„å­—ç¬¦ï¼ˆcompositionï¼‰ï¼Œç„¶ååœ¨è¾“å…¥æ³•è¾“å…¥å®Œæˆçš„æ—¶å€™ï¼Œç”¨çœŸæ­£çš„ç»“æœå»æ›¿ä»£å®ƒã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ CodeMirror åœ¨æ¯æ¬¡è¯»å…¥è¾“å…¥çš„æ—¶å€™éƒ½å»æ¸…ç©º &lt;code&gt;textarea&lt;/code&gt;ï¼Œè¿™å°±ä¼šç•™ä¸‹è¿˜æ²¡å®Œæˆçš„è¾“å…¥æ³•çš„è¾“å…¥ã€‚é‚£å®ƒçœŸæ­£çš„åšæ³•æ˜¯ï¼Œå½“æ²¡æœ‰é€‰åŒºå­˜åœ¨çš„æ—¶å€™ï¼ŒæŠŠå½“å‰è¾“å…¥ç•™åœ¨ &lt;code&gt;textarea&lt;/code&gt;ï¼Œç„¶åæŠŠå®ƒçš„å€¼ï¼ˆvalueï¼‰å­˜åœ¨åˆ«çš„åœ°æ–¹ã€‚ç„¶åä¸‹ä¸€æ¬¡æ£€æµ‹çš„æ—¶å€™ï¼Œå®ƒå°±ä¼šç”¨æ–°çš„å€¼å’Œå’Œæ—§çš„è¿›è¡Œæ¯”è¾ƒï¼ˆåˆ‡é™¤å…±åŒçš„å‰ç¼€å­—ç¬¦ï¼‰ï¼Œè¿™æ„å‘³ç€ä¹‹å‰çš„å€¼è¢«æ–°çš„å€¼æ›¿æ¢ï¼Œæ–°çš„å€¼åº”è¯¥æ›¿ä»£æ‰æ–‡æ¡£é‡Œé¢é‚£äº›æ—§çš„å€¼ã€‚&lt;/p&gt;
&lt;h2&gt;Drag and drop&lt;/h2&gt;
&lt;p&gt;ç°ä»£çš„æµè§ˆå™¨éƒ½æä¾›äº† &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/DragDrop/Drag_and_Drop&quot;&gt;drap and drop API&lt;/a&gt;ã€‚è¿™å°±ä¼šè®©æˆ‘ä»¬çš„ç¼–è¾‘å™¨æ›´åŠ æ–¹ä¾¿åœ°æ”¯æŒåœ¨ç¼–è¾‘å™¨é‡Œé¢æ”¾ç½®(drop)å†…å®¹ï¼Œæ‹‰å–å†…å®¹ç¦»å¼€ç¼–è¾‘å™¨ã€‚è¿™é‡Œé¢æœ‰ä¸€ç‚¹ç»†å¾®ä¹‹å¤„ï¼Œè¿™æ˜¯ CodeMirror çš„ &lt;code&gt;dragstart&lt;/code&gt; çš„handler:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-javascript&quot;&gt;on(node, &quot;dragstart&quot;, function(e) {
  // Set the dragged data to the currently selected text
  e.dataTransfer.setData(&quot;Text&quot;, editor.getSelection());

  // Use dummy image instead of default browsers image.
  if (e.dataTransfer.setDragImage)
    e.dataTransfer.setDragImage(document.createElement(&apos;img&apos;), 0, 0);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“ &lt;code&gt;setDrapImage&lt;/code&gt; æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼ŒæŠ‘åˆ¶äº†é»˜è®¤çš„æ‹‰åŠ¨çš„æ˜ åƒï¼Œé˜»æ­¢äº†ä¸€äº›æµè§ˆå™¨æ˜¾ç¤ºæ•´ä¸ªç¼–è¾‘å™¨éƒ½è¢«æ‹‰åŠ¨äº†ï¼Œå› ä¸ºå¤–éƒ¨å…ƒç´ è¢«è®¾ç½®æˆ &lt;code&gt;draggable=true&lt;/code&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ CodeMirror çš„ &lt;code&gt;mousedown&lt;/code&gt; handleré‡Œé¢ï¼Œæˆ‘ä¹Ÿåœ¨ä¸åœ¨é€‰åŒºï¼ˆselectionï¼‰é‡Œé¢çš„ç‚¹å‡»è°ƒç”¨äº† &lt;code&gt;preventDefault()&lt;/code&gt;ï¼Œè¿™æ ·æ‹‰åŠ¨äº§ç”Ÿçš„é€‰åŒºå°±ä¸ä¼šè§¦å‘ä¸‹ä¸€æ¬¡æ‹‰åŠ¨ï¼ˆdraggingï¼‰ã€‚åœ¨ Webkit å¼•æ“é‡Œé¢ï¼Œè¿™æ˜¯å¿…é¡»çš„ï¼Œå› æ­¤ï¼Œä½ ä¸ä»…åœ¨å¤„ç† &lt;code&gt;mousedown&lt;/code&gt; äº‹ä»¶çš„æ—¶å€™æŠŠ &lt;code&gt;draggable&lt;/code&gt; å±æ€§è®¾ç½®æˆçœŸï¼Œè¿˜è¦åœ¨ä¹‹åæŠŠå®ƒè®¾ç½®å›æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ç¼–è¾‘å™¨é‡Œé¢ &lt;code&gt;drop&lt;/code&gt; äº‹ä»¶çš„ handler æ”¯æŒä» &lt;code&gt;FileReader&lt;/code&gt; è¯»å–æ–‡ä»¶ï¼Œå¯ä»¥æ§åˆ¶è¢«æ‹‰è¿›ç¼–è¾‘å™¨çš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h2&gt;å…¨å±€èœå•&lt;/h2&gt;
&lt;p&gt;å…¨å±€èœå•å°±åƒè›‹ç³•ä¸Šçš„ç³–éœœä¸€æ ·ï¼Œä¸€ä¸ªå¥½çš„ç¼–è¾‘å™¨åœ¨è¢«å³é”®çš„æ—¶å€™åº”è¯¥è¡¨ç°æ­£å¸¸æ‰è¡Œã€‚å…¨å±€èœå•åº”è¯¥åŒ…å«å¯ä»¥å·¥ä½œçš„å¤åˆ¶ï¼Œå‰ªåˆ‡å’Œç²˜è´´æŒ‰é’®ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¹¸çš„æ˜¯ï¼Œ æµè§ˆå™¨æ²¡æœ‰æä¾› API å»æ“ä½œå…¨å±€èœå•ã€‚ä½ å¯ä»¥æ•æ‰ç‚¹å‡»äº‹ä»¶å’Œå±•ç¤ºä½ è‡ªå·±çš„èœå•ï¼Œä¸è¿‡è¿™æ ·å¹¶ä¸å¥½ï¼Œè€Œä¸”æ›´åçš„æ˜¯ï¼Œä½ æ²¡æœ‰æƒé™å»ä½¿ç”¨ç²˜è´´æ¿ï¼Œå³ä½¿æ˜¯æ­£ç¡®åœ°å®ç°å¤åˆ¶ã€ç²˜è´´ä½ ä¹Ÿåšä¸åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;å°±åƒæµè§ˆå™¨é¢†åŸŸä¸€è´¯åœ°é£æ ¼ä¸€æ ·ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæå·®åœ°å®ç°æ–¹æ³•å»å¼¥è¡¥APIçš„ä¸è¶³ã€‚è¿™æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡çŸ­æš‚åœ°ä¸éšè— &lt;code&gt;textarea&lt;/code&gt;ï¼ˆç»™å®ƒä¸€ä¸ªå¾ˆä½åœ°é€æ˜åº¦ï¼Œä»¥åŠæ²¡æœ‰è¾¹ç•Œæ¥ä¸è®©åˆ«äººå‘ç°å®ƒï¼‰æ¥å“åº”é¼ æ ‡ç‚¹å‡»äº‹ä»¶å’Œ &lt;code&gt;contextmenu&lt;/code&gt; äº‹ä»¶ï¼Œç„¶åæŠŠå®ƒæ”¾åœ¨é¼ æ ‡æŒ‡é’ˆä¸‹é¢ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸º &lt;code&gt;textarea&lt;/code&gt; å·²ç»åŒ…å«äº†å½“å‰åœ°é€‰åŒºåœ°å†…å®¹ï¼Œä»¥åŠï¼Œå¦‚æœå®ƒæœ‰ä¸€ä¸ªé€‰åŒºï¼Œå®ƒåœ°å·¦ä¸Šè§’ï¼ˆæˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨æŒ‡é’ˆä¸‹é¢ï¼‰ï¼Œå°±æ˜¯é€‰åŒºåœ°ä½ç½®ã€‚ç°åœ¨æµè§ˆå™¨å°±ä¼šç›¸ä¿¡æˆ‘ä»¬ç‚¹å‡»åœ¨ &lt;code&gt;textarea&lt;/code&gt; çš„é€‰åŒºä¸Šé¢ï¼Œç„¶åå°±ä¼šæä¾›æˆ‘ä»¬æƒ³è¦çš„èœå•ã€‚å³ä½¿è¿™ä¸ªç»“ç‚¹åœ¨å‡ æ¯«ç§’ä¹‹åéšè—äº†ï¼Œè¿™ä¸ªç‚¹å‡»ä¹Ÿä¼šå’Œå®ƒè”ç³»èµ·æ¥ï¼Œéšåçš„ç²˜è´´ä¹Ÿä¼šåº”ç”¨åˆ°æˆ‘ä»¬çš„ &lt;code&gt;textarea&lt;/code&gt; å½“ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ä»¶äº‹è¦æ³¨æ„çš„æ˜¯ï¼ŒFirefox åœ¨æ‰“å¼€å…¨å±€èœå•&lt;strong&gt;ä¹‹å&lt;/strong&gt;ä¼šè§¦å‘ &lt;code&gt;contextmenu&lt;/code&gt; äº‹ä»¶ï¼Œä¸è¿‡è¿™è¿˜æ˜¯è®©æˆ‘ä»¬å¤ªæ™šçŸ¥é“ &lt;code&gt;textarea&lt;/code&gt; è¢«ç‚¹å‡»äº†ã€‚å› æ­¤åœ¨é‚£ä¸ªæµè§ˆå™¨ä¸Šé¢ï¼Œæˆ‘ä»¬å°±è¹©è„šåœ°ä½¿ç”¨ &lt;code&gt;mousedown&lt;/code&gt; æ¥ä»£æ›¿å®ƒï¼ˆå³é”®æŒ‰ä¸‹åå°±ä¼šè¢«è§¦å‘ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºå…¨å±€èœå•æˆ‘ä»¬è¦å®ç°åœ°ç¬¬å››é¡¹å°±æ˜¯&lt;strong&gt;å…¨é€‰&lt;/strong&gt;ã€‚ä¸ºäº†åšåˆ°è¿™ä¸ªï¼Œæˆ‘ä»¬åœ¨å†…å®¹åœ°å¼€å¤´åŠ äº†ä¸€ä¸ªå‡çš„ã€æ²¡æœ‰è¢«é€‰æ‹©çš„ç©ºé—´ã€‚ç„¶åå®šæœŸè¿›è¡Œæ£€æŸ¥çœ‹çœ‹è¿™ä¸ªæ§ä»¶æ˜¯å¦è¢«é€‰æ‹©ã€‚å¦‚æœå®ƒè¢«é€‰æ‹©äº†ï¼ˆå‰©ä¸‹åœ°å†…å®¹å®Œå¥½æ— æŸï¼‰ï¼Œæˆ‘ä»¬å°±é€‰æ‹©ç¼–è¾‘å™¨é‡Œé¢æ‰€æœ‰å†…å®¹ã€‚å¦‚æœ &lt;code&gt;textarea&lt;/code&gt; åˆ«çš„ä¸œè¥¿æ”¹å˜äº†ï¼Œæˆ–è€…æ—¶é—´è¿‡å¾—å¤ªé•¿ï¼Œæˆ‘ä»¬å°±æ”¾å¼ƒã€‚&lt;/p&gt;
&lt;h2&gt;å¼¯è·¯&lt;/h2&gt;
&lt;p&gt;å¯¹äºæ²¡æœ‰è¾“å…¥çš„é”®ç›˜äº‹ä»¶ï¼Œä¾‹å¦‚æŒ‡é’ˆç§»åŠ¨æŒ‰é”®ï¼ŒCodeMirror ç®€å•åœ°å¤„ç†åŸå§‹çš„äº‹ä»¶ç„¶åå†…éƒ¨å±•ç°åˆé€‚çš„é€‰åŒºæ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹ CodeMirror ç‰ˆæœ¬ 2 é‡‡ç”¨äº†ä¸€ä¸ªä¸åŒçš„å®ç°æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•éå¸¸è®¨äººå–œæ¬¢ï¼Œä½†æ˜¯æœ€åå¹¶æ²¡æœ‰æˆåŠŸã€‚å®ƒä¸ä½†æŠŠé€‰åŒºæ”¾è¿› &lt;code&gt;textarea&lt;/code&gt;ï¼Œä¹ŸæŠŠé™„è¿‘çš„å‡ è¡Œæ”¾è¿›å»ï¼Œè®©æœ¬åœ°çš„æŒ‡é’ˆä¹Ÿå¯ä»¥è‡ªç”±åœ°ç§»åŠ¨ã€‚è¿™å°†ä¼šä¸ä»…ä» &lt;code&gt;textarea&lt;/code&gt; å¾—åˆ°è¾“å…¥ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°é€‰åŒºï¼ˆselectionï¼‰ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æœ‰ä¸€ä¸ªæœ‰ç‚¹å°±æ˜¯ä½¿ç”¨äº†æµè§ˆå™¨â€œæœ¬åœ°â€çš„æŒ‰é”®ç»‘å®šã€‚è¿™å¯¹äºä¸€äº›ç‰¹å®šçš„æŒ‰é”®ç»‘å®šæ¥è¯´æ˜¯å¯è¡Œçš„ï¼Œä¹ŸæŠŠä¸€äº›å¤æ‚çš„é€‰åŒºæ“ä½œäº¤ç»™äº†æµè§ˆå™¨ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æœ€ç»ˆæŠ›å¼ƒè¿™ä¸ªåšæ³•æ˜¯å› ä¸ºå®ƒéœ€è¦å¤ªå¤šçš„hackåšæ³•æ¥æ­£å¸¸å·¥ä½œï¼Œæ¯”å¦‚è¯´ï¼Œå½“ä½ åœ¨ &lt;code&gt;textarea&lt;/code&gt; é€‰æ‹©ä¸€æ®µæ–‡å­—çš„æ—¶å€™ï¼Œä½ ä¸èƒ½è®¾ç½®å¤–é“¾ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½ æŒ‰ä¸‹ &lt;em&gt;shift-left&lt;/em&gt; æˆ–è€…å…¶ä»– &lt;em&gt;shift&lt;/em&gt; ç§»åŠ¨çš„æ—¶å€™ï¼Œå¤–é“¾ä¸ä¼šç§»åŠ¨ã€‚æµè§ˆå™¨å‡è®¾å®ƒæ°¸è¿œåœ¨é€‰åŒºçš„å·¦è¾¹å½“æˆ‘ä»¬é€šè¿‡ &lt;code&gt;selectionStart&lt;/code&gt; å’Œ &lt;code&gt;selectionEnd&lt;/code&gt; è®¾ç½®é€‰åŒºçš„æ—¶å€™ã€‚ä¸ºäº†è®©é€‰åŒºå¯ä»¥æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬å¿…é¡»ç”¨å¾ˆå¤šç—›è‹¦å’Œè¹©è„šçš„åšæ³•ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œä¼¼ä¹å¾ˆå°‘ç”¨æˆ·ä¼šåœ¨ä»–ä»¬çš„æµè§ˆå™¨é‡Œé¢çœŸæ­£åœ°é‡æ–°é…ç½®æŒ‰é”®ç»‘å®šï¼ˆkeyboard bindingï¼‰ï¼Œæœ‰è¶£çš„æ˜¯ï¼Œç”¨æˆ·æ›´å–œæ¬¢ CodeMirror æä¾›è‡ªå®šä¹‰æŒ‰é”®ç»‘å®šè€Œä¸æ˜¯åœ¨ä»–ä»¬çš„æµè§ˆå™¨é‡Œé¢é‡æ–°å®šä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œæ§åˆ¶æˆ‘ä»¬è‡ªå®šä¹‰é”®ç›˜äº‹ä»¶çš„é¢å¤–çš„å¤æ‚åº¦ä¼¼ä¹æ²¡æœ‰ä¸Šé¢æ‰€è¿°çš„è¿™ç§åšæ³•çš„å¤æ‚åº¦å¤§ã€‚å› ä¸º CodeMirror ä½¿ç”¨ textarea åªåŒ…å«é€‰åŒºè¿™ç§åšæ³•ï¼Œè€Œä¸å¿…å»è§£å†³ &lt;code&gt;cursor-motion&lt;/code&gt; æŒ‰é’®äº‹ä»¶ã€‚&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ç¼–è¯‘åŸç†å­¦ä¹ ç¬”è®° 3ï¼šå®ç°ä¸€ä¸ªè™šæ‹Ÿæœº]]></title><link>https://diverse.space/2016/08/implement-a-vm</link><guid isPermaLink="false">https://diverse.space/2016/08/implement-a-vm</guid><pubDate>Sat, 13 Aug 2016 21:00:00 GMT</pubDate><content:encoded>&lt;p&gt;è‡³äº Lexer å’Œ Parser éƒ¨åˆ†ï¼Œæ•™ç¨‹å’Œç”¨æ³•å®åœ¨å¤ªå¤šï¼Œå®ç°èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥ä¹Ÿæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œè¿™é‡Œè¯´è¯´å¦‚ä½•å®ç°ä¸€ä¸ªè™šæ‹Ÿæœºï¼ˆVirtual Machineï¼‰&lt;/p&gt;
&lt;p&gt;è™šæ‹Ÿæœºçš„å®ç°æœ‰å¾ˆå¤šç§ï¼Œå¸¸è§çš„åˆ†ä¸º Stack Machine å’Œ Register Machine å‰è€…åŸºäºæ ˆï¼Œåè€…åŸºäºå¯„å­˜å™¨ã€‚
ç›®å‰æ¥è¯´ï¼ŒåŸºäºæ ˆçš„è™šæ‹Ÿæœºæ¯”è¾ƒå¤šï¼Œåƒï¼ˆCPython, JVM, .NETâ€¦ï¼‰éƒ½æ˜¯åŸºäºæ ˆçš„è™šæ‹Ÿæœºï¼ŒäºŒåŸºäºå¯„å­˜å™¨çš„è™šæ‹Ÿæœºä¸­æ¯”è¾ƒå‡ºåçš„å°±æ˜¯ Lua çš„å®˜æ–¹å®ç°äº†ï¼Œå®˜æ–¹ç§°è¿™æ˜¯æœ€æ—©çš„åŸºäºå¯„å­˜å™¨çš„è™šæ‹Ÿæœºï¼Œå…·ä½“å¦‚ä½•æˆ‘ä»¬å°±æ— æ³•è€ƒç©¶äº†ã€‚ä½†æ˜¯æœ¬æ–‡ä¸»è¦ä»‹ç»çš„æ˜¯åŸºäºæ ˆçš„è™šæ‹Ÿæœºï¼Œå› ä¸ºæ¯”è¾ƒå¥½å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢è¿™ä¸€è¡Œä»£ç &lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-javascript&quot;&gt;1 + 2 * 3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœç”¨ StackMachine æ¥è¡¨ç¤ºæ˜¯è¿™æ ·çš„&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;LOAD 1
LOAD 2
LOAD 3
MULTIPLE // result: 6
ADD  // result: 7
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ ·åº”è¯¥å¾ˆå¥½ç†è§£ï¼Œæ‰§è¡Œè¿™æ®µä»£ç åï¼Œæ ˆé¡¶çš„å€¼æ˜¯ 7ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¡¨è¾¾å¼çš„å€¼ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥åšä¸¤ä»¶äº‹æƒ…å°±å¥½å¥½äº†ï¼Œä¸€æ˜¯æŠŠè¯­æ³•æ ‘ç”Ÿæˆä¸€è¿ä¸²çš„æŒ‡ä»¤ï¼ŒäºŒæ˜¯æ‰§è¡Œè¿™äº›æŒ‡ä»¤&lt;/p&gt;
&lt;p&gt;è¯­æ³•æ ‘å¦‚ä½•ç”ŸæˆæŒ‡ä»¤å‘¢ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;+
| \
1  *
         |\
         2 3
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt; ç²—ç•¥åœ°ç”»ï¼Œè¯­æ³•æ ‘æ˜¯è¿™ä¸ªæ ·å­åœ°ï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾ï¼Œ&lt;strong&gt;ç”ŸæˆæŒ‡ä»¤åœ°è¿‡ç¨‹å°±æ˜¯ååºéå†è¯­æ³•æ ‘åœ°è¿‡ç¨‹&lt;/strong&gt;ã€‚ç†è§£è¿™å¥è¯ä¹‹åï¼Œå°±å¥½åšäº†ã€‚ä½†æ˜¯ä¹Ÿæœ‰å‡ ç‚¹è¦æ³¨æ„åœ°åœ°æ–¹ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨ä¸€ä¸ªå¸¸é‡è¡¨ï¼ŒæŠŠç”¨åˆ°åœ°å¸¸é‡ç»™å‚¨å­˜èµ·æ¥ï¼Œå¦‚æ•´å½¢ï¼Œå­—ç¬¦ä¸²ç­‰ç­‰ã€‚æ‰€ä»¥æˆ‘ä»¬è®¾è®¡æŒ‡ä»¤çš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´ LOAD_C  æŒ‡ä»¤å°±å¯ä»¥ä»å¸¸é‡è¡¨é‡Œé¢åŠ è½½ä¸€ä¸ªå€¼åˆ°æ ˆé¡¶ã€‚&lt;/p&gt;
&lt;p&gt; ä¸‹é¢çœ‹ä¸€ä¸‹æˆ‘æ­£åœ¨å®ç°çš„å“ˆè¯­è¨€é‡Œé¢çš„æŒ‡ä»¤é›†&lt;/p&gt;
&lt;pre style=&apos;color:#000020;background:#f6f8ff;&apos;&gt;&lt;span style=&apos;color:#004a43; &apos;&gt;#&lt;/span&gt;&lt;span style=&apos;color:#004a43; font-weight:bold; &apos;&gt;pragma&lt;/span&gt;&lt;span style=&apos;color:#7779bb; font-weight:bold; &apos;&gt; once&lt;/span&gt;

&lt;span style=&apos;color:#200080; font-weight:bold; &apos;&gt;namespace&lt;/span&gt; halang
&lt;span style=&apos;color:#406080; &apos;&gt;{&lt;/span&gt;
	&lt;span style=&apos;color:#200080; font-weight:bold; &apos;&gt;enum&lt;/span&gt; &lt;span style=&apos;color:#200080; font-weight:bold; &apos;&gt;class&lt;/span&gt; VM_CODE
	&lt;span style=&apos;color:#406080; &apos;&gt;{&lt;/span&gt;
		LOAD_C&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x00 A - load constant&lt;/span&gt;
		LOAD_V&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x01 A - load variable&lt;/span&gt;
		LOAD_G&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x02 A - load global variable&lt;/span&gt;
		LOAD_UPVAL&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;				&lt;span style=&apos;color:#595979; &apos;&gt;// 0x03 A - load upvalue&lt;/span&gt;
		STORE_V&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;				&lt;span style=&apos;color:#595979; &apos;&gt;// 0x04 A - store the top of stack to A&lt;/span&gt;
		STORE_G&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;				&lt;span style=&apos;color:#595979; &apos;&gt;// 0x05 A - store to the global value&lt;/span&gt;
		STORE_UPVAL&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;			&lt;span style=&apos;color:#595979; &apos;&gt;// 0x06 A - store to the upvalue table&lt;/span&gt;
		PUSH_INT&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;				&lt;span style=&apos;color:#595979; &apos;&gt;// 0x07 A - load A&lt;/span&gt;
		PUSH_BOOL&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;				&lt;span style=&apos;color:#595979; &apos;&gt;// 0x08 A - load A&lt;/span&gt;
		POP&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x09 A - Pop A&lt;/span&gt;
		CLOSURE&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;				&lt;span style=&apos;color:#595979; &apos;&gt;// 0x0a A - linked Function&apos;s upvalue to current env&lt;/span&gt;
		CALL&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x0b (A, B, C...) call function(A, B, C...)&lt;/span&gt;
		RETURN&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x0c A - if A != 0 return exp else return nothing&lt;/span&gt;
		IFNO&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x0d if not true, jump to the location.&lt;/span&gt;
		JMP&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x0e&lt;/span&gt;
		NOT&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x0f&lt;/span&gt;
		ADD&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x10 add the top two val&lt;/span&gt;
		SUB&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x11&lt;/span&gt;
		MUL&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x12&lt;/span&gt;
		DIV&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x13&lt;/span&gt;
		MOD&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x14&lt;/span&gt;
		POW&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x15&lt;/span&gt;
		GT&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt; LT&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x16 0x17&lt;/span&gt;
		GTEQ&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt; LTEQ&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;				&lt;span style=&apos;color:#595979; &apos;&gt;// 0x18 0x19&lt;/span&gt;
		EQ&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;						&lt;span style=&apos;color:#595979; &apos;&gt;// 0x1a&lt;/span&gt;
		OUT&lt;span style=&apos;color:#308080; &apos;&gt;,&lt;/span&gt;					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x1b&lt;/span&gt;
		STOP					&lt;span style=&apos;color:#595979; &apos;&gt;// 0x1c&lt;/span&gt;
	&lt;span style=&apos;color:#406080; &apos;&gt;}&lt;/span&gt;&lt;span style=&apos;color:#406080; &apos;&gt;;&lt;/span&gt;

&lt;span style=&apos;color:#406080; &apos;&gt;}&lt;/span&gt;&lt;span style=&apos;color:#406080; &apos;&gt;;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;è‡³äºè¿è¡Œï¼Œå¦‚ä½•å‚¨å­˜å˜é‡å‘¢ï¼Œæœ€ç®€å•çš„åšæ³•å°±æ˜¯ç”¨ Environment æ–¹æ³•ã€‚ç”¨ä¸€ä¸ªè¡¨æ¥å‚¨å­˜å˜é‡ï¼Œè¿™ä¸ªè¡¨å½“ç„¶å¯ä»¥ç”¨å“ˆå¸Œè¡¨ï¼ˆå˜é‡å-å˜é‡å€¼ï¼‰æ¥åšï¼Œä½†æ˜¯è¿™æ ·è¿˜ä¸å¤Ÿå¿«ã€‚å…¶å®æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ä¸€ä¸ªç¯å¢ƒé‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸€ä¸ªå˜é‡åç¼–ä¸€ä¸ªå·ï¼Œè¿™æ ·å­è¿™ä¸ªå˜é‡è¡¨å°±å¯ä»¥ç”¨æ•°ç»„ï¼ˆå˜é‡ç¼–å·-å˜é‡å€¼ï¼‰æ¥åšï¼Œè¿™æ ·å­ï¼Œè®¿é—®å˜é‡å’Œå‚¨å­˜å˜é‡çš„æ—¶å€™å°±å¿«å¾ˆå¤šäº†ã€‚&lt;/p&gt;
&lt;p&gt;é¡¹ç›® Github åœ°å€ï¼š&lt;a href=&quot;https://github.com/vincentdchan/halang&quot;&gt;https://github.com/vincentdchan/halang&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[æŠŠæ­£æ–¹ç³»ç»Ÿçš„è¯¾è¡¨å¯¼å‡ºæˆ ics æ–‡ä»¶]]></title><link>https://diverse.space/2016/08/export-zhengfang-course-to-ics</link><guid isPermaLink="false">https://diverse.space/2016/08/export-zhengfang-course-to-ics</guid><pubDate>Sat, 13 Aug 2016 18:27:00 GMT</pubDate><content:encoded>&lt;p&gt;æ–‡ç« çš„å¼€å§‹ï¼Œå…ˆä¸Šä¸€å¼ å›¾ï¼Œæ‰“å¼€ Siriï¼Œé—® Siriï¼šæ˜å¤©æœ‰ä»€ä¹ˆå®‰æ’ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/34fe8bc343db15fe0a4b39070b14a564/437fe/iphone-siri.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 178.0250347705146%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAkABQDASIAAhEBAxEB/8QAGQABAQEBAQEAAAAAAAAAAAAAAAIBBAMF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQIA/9oADAMBAAIQAxAAAAH4+1dTK0s3y7W93ODJMgP/xAAZEAEBAQADAAAAAAAAAAAAAAABABEQEiD/2gAIAQEAAQUCxwJsgmOG1uza+P/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BX//EABURAQEAAAAAAAAAAAAAAAAAAAEg/9oACAECAQE/AWv/xAAZEAACAwEAAAAAAAAAAAAAAAAQMQAgQZH/2gAIAQEABj8CmdKLLr//xAAeEAACAgICAwAAAAAAAAAAAAAAAREhMUFRcRBh8f/aAAgBAQABPyGHKuzmbBnNUKa0IlQEU4NL1yJv6Y15PeITJ5G5XVeP/9oADAMBAAIAAwAAABCMwA90D//EABkRAQEAAwEAAAAAAAAAAAAAAAEAEBEhMf/aAAgBAwEBPxB4R5JsgYx//8QAGBEAAgMAAAAAAAAAAAAAAAAAEBEBIUH/2gAIAQIBAT8QhQbGD//EAB4QAQACAgIDAQAAAAAAAAAAAAEAESExQWFRccGR/9oACAEBAAE/EEVSKkWpn7FafBDkSk0VoWAWDjlj6ErebhK01H0UuRX5OJXN3Z8nddwAxWaNk9wDlmiLkAoCipwT/9k=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;iphone siri&quot;
        title=&quot;&quot;
        src=&quot;/static/34fe8bc343db15fe0a4b39070b14a564/f3a32/iphone-siri.jpg&quot;
        srcset=&quot;/static/34fe8bc343db15fe0a4b39070b14a564/6ba01/iphone-siri.jpg 175w,
/static/34fe8bc343db15fe0a4b39070b14a564/b8ff8/iphone-siri.jpg 350w,
/static/34fe8bc343db15fe0a4b39070b14a564/f3a32/iphone-siri.jpg 700w,
/static/34fe8bc343db15fe0a4b39070b14a564/437fe/iphone-siri.jpg 719w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆ siri çŸ¥é“æˆ‘çš„è¯¾è¡¨ï¼Ÿå› ä¸ºæˆ‘æŠŠè¯¾è¡¨å¯¼å…¥äº† iPhone çš„æ—¥å†ä¸­å»äº†ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºä¸æƒ³å†ä½¿ç”¨è¶…çº§è¯¾ç¨‹è¡¨ç­‰è½¯ä»¶ï¼ŒåŠ ä¸Šåå†œå®ä¸æ€ä¹ˆå¥½çœ‹ï¼Œè€Œä¸”å¾ˆéº»çƒ¦çš„ç¼˜æ•…ï¼Œè‡ªå·±å†™äº†ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥æŠŠè¯¾ç¨‹è¡¨å¯¼å‡ºåˆ°&lt;em&gt;ics&lt;/em&gt; æ ¼å¼ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ–‡ä»¶å¯¼å…¥åˆ°ç³»ç»Ÿçš„è½¯ä»¶å½“ä¸­ï¼Œæ¯”å¦‚iPhoneè‡ªå¸¦çš„æ—¥å†, Outlook, Google CalendarÂ ç­‰ç­‰ä½ å¸¸ç”¨çš„æ—¥å†å·¥å…·â€¦â€¦å¯¼å…¥åˆ° iPhone æˆ–è€… Android æ‰‹æœºè‡ªå¸¦çš„æ—¥å†ä¹‹åï¼Œæ— è®ºæ˜¯æŸ¥çœ‹ï¼Œé€šçŸ¥ç”šè‡³ç±»ä¼¼ Siriï¼Œå°å¨œçš„å„ç§è¯­éŸ³åŠ©æ‰‹è¿›è¡ŒæŸ¥è¯¢ï¼Œéƒ½ä¼šåå†œå®æ–¹ä¾¿å¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ï¼Œè¿™ä¸ªæ’ä»¶æ˜¯å®‰è£…åœ¨ä½ çš„ç”µè„‘ä¸Šè¿›è¡Œå¯¼å‡ºï¼Œå®ƒçš„ä»£ç å®Œå…¨å¼€æ”¾ï¼Œæ‰˜ç®¡åœ¨ Githubï¼Œä½ æ— éœ€æ‹…å¿ƒå¯†ç æ³„æ¼ç­‰å®‰å…¨é—®é¢˜ï¼Œç›¸ååå†œå®ä½¿ç”¨ä½ çš„å¯†ç ç™»å½•æ•™åŠ¡ç³»ç»Ÿï¼Œä¼šä½¿äººå¤šäº†ä¸€å±‚ç–‘è™‘ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰æ¥è¯´ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ Chrome æˆ–è€… Tampermonkey æ’ä»¶æ¥ä½¿ç”¨æˆ‘åšçš„æ’ä»¶è¿›è¡Œå¯¼å‡ºã€‚&lt;/p&gt;
&lt;h2&gt;æ–¹æ³•ä¸€ï¼šTampermonkeyï¼ˆæ²¹çŒ´ï¼‰æ’ä»¶&lt;/h2&gt;
&lt;p&gt;Tempermonkey æ’ä»¶æ”¯æŒçš„æµè§ˆå™¨æœ‰:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Google Chrome&lt;/li&gt;
&lt;li&gt;Firefox&lt;/li&gt;
&lt;li&gt;Edge&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸Šæµè§ˆå™¨å®‰è£… Tampermonky æ’ä»¶ï¼Œå®‰è£…æ–¹æ³•è‡ªè¡Œæœç´¢ã€‚&lt;/p&gt;
&lt;p&gt;å®‰è£…å®Œæˆä¹‹åï¼Œå»åˆ°&lt;a href=&quot;https://greasyfork.org/zh-CN/scripts/27557-%E5%8D%8E%E5%86%9C%E6%AD%A3%E6%96%B9%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%87%BA%E5%B7%A5%E5%85%B7&quot;&gt;è¿™ä¸ªé“¾æ¥&lt;/a&gt;ç‚¹å‡»å®‰è£…ï¼Œå®‰è£…æˆåŠŸä¹‹åç™»å…¥ä½ çš„æ­£æ–¹ç³»ç»Ÿï¼Œå»ä¸ªäººè¯¾è¡¨å¯¼å‡ºé¡µé¢è®¾ç½®å¥½æ—¥æœŸä¹‹åå¯¼å‡ºå°±å¥½äº†ï¼Œç„¶åå¤§åŠŸå‘Šæˆã€‚&lt;/p&gt;
&lt;h2&gt;æ–¹æ³•äºŒï¼šChromeæ’ä»¶&lt;/h2&gt;
&lt;p&gt;ä¸‹è½½ä¸‹é¢çš„ Chrome æ’ä»¶&lt;strong&gt;ï¼ˆä»…åå†œçš„æ­£æ–¹ç³»ç»Ÿé€‚ç”¨ï¼‰&lt;/strong&gt;ï¼Œå®‰è£…æ–¹æ³•è¯·è‡ªè¡Œæœç´¢&lt;/p&gt;
&lt;p&gt;Github åœ°å€: &lt;a href=&quot;https://github.com/vincentdchan/ZhengFangToolkit&quot;&gt;https://github.com/vincentdchan/ZhengFangToolkit&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹è½½ &lt;a href=&quot;https://github.com/vincentdchan/ZhengFangToolkit/releases&quot;&gt;Chrome æ’ä»¶&lt;/a&gt;ï¼Œå¹¶å®‰è£…ï¼Œå®‰è£…æ–¹æ³•è¯·è‡ªè¡Œæœç´¢ï¼Œå®‰è£…å®Œæˆåï¼Œç™»å…¥æ­£æ–¹ç³»ç»Ÿï¼Œè¿›å…¥ä¸ªäººè¯¾è¡¨ï¼Œé€‰æ‹©å¥½æ­£ç¡®çš„å­¦å¹´å’Œæ­£ç¡®çš„å­¦æœŸï¼Œ&lt;strong&gt;æ£€æŸ¥ä¸€ä¸‹å¼€å­¦çš„ç¬¬ä¸€ä¸ªæ˜ŸæœŸä¸€æ˜¯å¦æ­£ç¡®&lt;/strong&gt;ï¼Œä¸ç„¶çš„çš„è¯ç”Ÿæˆçš„æ—¥å†å…¨éƒ¨éƒ½ä¼šé”™è¯¯çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d98ad8ec48ad285cd5a2f7bf98ac1546/b4857/zhengfang-tutorial1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 11.99294532627866%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAB2HAAAdhwGP5fFlAAAAeElEQVQI1w3LsQ7CIBRA0f7/P7m4OBgXo0GrFim8hwUe0BYhkg6S3PHczi0/Wls1fDcwUaBBE96a7qMVmji4yxMH8FMsD2kZ11PIIVW/1jZ2qWxuzs0JJIn22g9KG0DsX1wB5FwMzfsj2x3OJyZvI3G9fHxRLsdU/yDNbN1HFLYzAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;zhengfang tutorial1&quot;
        title=&quot;&quot;
        src=&quot;/static/d98ad8ec48ad285cd5a2f7bf98ac1546/84ad3/zhengfang-tutorial1.png&quot;
        srcset=&quot;/static/d98ad8ec48ad285cd5a2f7bf98ac1546/687da/zhengfang-tutorial1.png 175w,
/static/d98ad8ec48ad285cd5a2f7bf98ac1546/0ab4d/zhengfang-tutorial1.png 350w,
/static/d98ad8ec48ad285cd5a2f7bf98ac1546/84ad3/zhengfang-tutorial1.png 700w,
/static/d98ad8ec48ad285cd5a2f7bf98ac1546/ef8d3/zhengfang-tutorial1.png 1050w,
/static/d98ad8ec48ad285cd5a2f7bf98ac1546/b4857/zhengfang-tutorial1.png 1134w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ£€æŸ¥å®Œä¹‹åç‚¹å‡»&lt;strong&gt;å¯¼å‡ºè¯¾ç¨‹&lt;/strong&gt;ï¼Œæœ€åä¼šå‡ºç°ä¸€æ¡ä¸‹è½½é“¾æ¥ï¼Œä¸‹è½½é‚£ä¸ª ics æ–‡ä»¶å°±è¡Œäº†ã€‚
ç„¶åæŠŠ ics æ–‡ä»¶å¯¼å…¥åˆ°å„ç§è½¯ä»¶ä¸­å»ï¼Œå¯ä»¥çœ‹çœ‹æ•ˆæœå›¾&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/3bb2a6695261b8704875ddc3ba966dc5/366f4/zhengfang-ios.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.22188905547226%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHZbtUUJ//EABkQAAMAAwAAAAAAAAAAAAAAAAABEQIhMf/aAAgBAQABBQKMWyGTiXD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAAAMSD/2gAIAQEABj8CVcf/xAAbEAEAAgIDAAAAAAAAAAAAAAABABEQUSExof/aAAgBAQABPyHlofJdIxbaMFbnRj//2gAMAwEAAgADAAAAELPP/8QAFhEAAwAAAAAAAAAAAAAAAAAAEBFB/9oACAEDAQE/EIx//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAICAwAAAAAAAAAAAAAAAQARECExQdH/2gAIAQEAAT8Q2D0a30gTKjbRAvAjU6UESo8pj//Z&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;zhengfang ios&quot;
        title=&quot;&quot;
        src=&quot;/static/3bb2a6695261b8704875ddc3ba966dc5/f3a32/zhengfang-ios.jpg&quot;
        srcset=&quot;/static/3bb2a6695261b8704875ddc3ba966dc5/6ba01/zhengfang-ios.jpg 175w,
/static/3bb2a6695261b8704875ddc3ba966dc5/b8ff8/zhengfang-ios.jpg 350w,
/static/3bb2a6695261b8704875ddc3ba966dc5/f3a32/zhengfang-ios.jpg 700w,
/static/3bb2a6695261b8704875ddc3ba966dc5/61d28/zhengfang-ios.jpg 1050w,
/static/3bb2a6695261b8704875ddc3ba966dc5/366f4/zhengfang-ios.jpg 1334w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¼å…¥åˆ° iOS ä¹‹åçš„æ•ˆæœå›¾&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a14f27774672c79aaa49d4d4952ce537/a9195/zhengfang-win10.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 50.625%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAB2HAAAdhwGP5fFlAAACTklEQVQozy2R60tTYRzHJwVLHeRaKmvJcJUQMwJNcqaQFBQp2YXeBL0I6UX0HxS9KBRXKYGURL4MRc0i68W84GybeWnm3C3XKsnB3HbO2XbOec7OOc+ec+k5Gfz48OUH399Vp99Xri83luwp1ZdVRKPfFVVN0wLDQ1VVJUnaJZKVPCcWoJTnICsgjTzOqbrKKrOlxlayt7TMYAyGIkiWEUIizymyzAAOFhEAjCwhnmMVCXGAlRBiWRaKIq6r05cZDSbrfltzdW3DzJfQRJgbXs0+nN7pcRMj69TYBo31oznigWund57YIoCMICgURFFUFEVnsLUeaLhhauk2n765/C36k+QjSeCNU1+3wWaS/k3yWK9uA0+c8idAJg8gFHmehxBqZlN9l/ns3SrHbWvjtSlf9Ikv/3gu7XRneuYJLPrcRO98xrmg8ZmHTGQLilQURBGbZVnWHax1WE5cMh1ttx5vXwzEZ+PAtUl/ClOuGDMVImdizMcwOR3TMrM/GILmUBEWCry427mmrs3e1FlxuLntwq1wIvdyMTO0RL7wpYaWqEFv6vUKNehJvVomMYdXyD8EA0UBcByeXOtsPdJy0nG98tj5cx3dv1LMuzA9GaIng7ldfogwExu592F6PJCbijApmtcuLwj/d64219U3dR2yd7ZevBPcIsYCFI7RNWJ0PTviJ94Gc2/8mfFAdmRN00mKxWPjnfE7NbPl1GX7lft1jVfPdNxz+bcGFrNPPxPOhXS/h+xzpwe8lNOd7vdSWD/3UUlaUFWl+M+J//wXx7u0YDlaiYgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;zhengfang win10&quot;
        title=&quot;&quot;
        src=&quot;/static/a14f27774672c79aaa49d4d4952ce537/84ad3/zhengfang-win10.png&quot;
        srcset=&quot;/static/a14f27774672c79aaa49d4d4952ce537/687da/zhengfang-win10.png 175w,
/static/a14f27774672c79aaa49d4d4952ce537/0ab4d/zhengfang-win10.png 350w,
/static/a14f27774672c79aaa49d4d4952ce537/84ad3/zhengfang-win10.png 700w,
/static/a14f27774672c79aaa49d4d4952ce537/ef8d3/zhengfang-win10.png 1050w,
/static/a14f27774672c79aaa49d4d4952ce537/fed13/zhengfang-win10.png 1400w,
/static/a14f27774672c79aaa49d4d4952ce537/5b79c/zhengfang-win10.png 2100w,
/static/a14f27774672c79aaa49d4d4952ce537/a9195/zhengfang-win10.png 2560w&quot;
        sizes=&quot;(max-width: 700px) 100vw, 700px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯æˆ‘çš„è¯¾è¡¨å¯¼å…¥åˆ° Windows 10 è‡ªå¸¦æ—¥å†åçš„æ•ˆæœå›¾ï¼Œçœ‹èµ·æ¥æ•ˆæœè¿˜ä¸é”™&lt;/p&gt;
&lt;p&gt;æ²¹çŒ´æ’ä»¶å®‰è£…åœ°å€ï¼š&lt;a href=&quot;https://greasyfork.org/zh-CN/scripts/27557-%E5%8D%8E%E5%86%9C%E6%AD%A3%E6%96%B9%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%87%BA%E5%B7%A5%E5%85%B7&quot;&gt;https://greasyfork.org/zh-CN/scripts/27557-%E5%8D%8E%E5%86%9C%E6%AD%A3%E6%96%B9%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B%E5%AF%BC%E5%87%BA%E5%B7%A5%E5%85%B7&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Chrome æ’ä»¶ä¸‹è½½åœ°å€ï¼š&lt;a href=&quot;https://github.com/vincentdchan/ZhengFangToolkit/releases&quot;&gt;https://github.com/vincentdchan/ZhengFangToolkit/releases&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Github: &lt;a href=&quot;https://github.com/vincentdchan/ZhengFangToolkit&quot;&gt;https://github.com/vincentdchan/ZhengFangToolkit&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ç¼–è¯‘åŸç†å­¦ä¹ ç¬”è®° 2ï¼šèµ‹å€¼æ“ä½œ]]></title><link>https://diverse.space/2016/07/assign-operation</link><guid isPermaLink="false">https://diverse.space/2016/07/assign-operation</guid><pubDate>Thu, 14 Jul 2016 11:04:00 GMT</pubDate><content:encoded>&lt;p&gt;ä¸Šæ–‡ä¸­ï¼Œæåˆ°å¦‚æœè§£æä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ï¼Œå¹¶æŠŠå®ƒå˜æˆä¸€æ£µæ ‘ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªç¨‹åºç§°ä¸ºè§£é‡Šå™¨ï¼Œè¿™æ¬¡æˆ‘è¦ä¸ºè¿™ä¸ªè§£é‡Šå™¨åŠ ä¸€ä¸ªåŠŸèƒ½ï¼šèµ‹å€¼æ“ä½œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-javascript&quot;&gt;let a = 3 * 4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬è¦åŒºåˆ†å·¦å€¼(left-value)å’Œå³å€¼ï¼ˆright-value) å³å€¼æ˜¯ä¸´æ—¶ç»“æœï¼Œè€Œå·¦å€¼æ˜¯ä¸€ä¸ªå˜é‡ã€‚è‡³äºå³é¢æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¡¨è¾¾å¼å¦‚ä½•è§£æåœ¨ä¸Šä¸€ç¯‡æ–‡ç« å·²ç»è¯¦ç»†è¯´äº†ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å¤šè¯´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ebf402bbe50f54bc85cfda5122c0d625/115c7/parseLet.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 483px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 87.37060041407868%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACn0lEQVQ4y2NgQANv374F02fOnIGL/f//n2HOnDlg9q1btxhIBsiGzZgxQwTGXrBgAemGHT58GM5++PDh0s+fP/+/fft2A9SljHv37iXeMENDQ4ZLly4xgtjLli2T+vnz538QePPmzVOgEFj8woULYLVGRka4DQJJggwDgdLSUnCYgcCNGzf6nz59+hloSC4sLD08PBjCw8MZ2trawGpaWlrgesFg6dKlyN5lgrEVFBT4gBSflJQUP5DmNTY2FtLW1maDeR2ImSZPngxWizUYfv/+DTOM2dnZWQpoKy9yLOvq6rJbWlqKgixB1tfV1YVqkKKiItyLGzdutCsuLoa7n4uLi6G9vZ0xOTkZrn727NkqwKDY9ODBgw5bW1uwi5csWcKAksZAABgZxT9+/Pj/6dOnJ/v27bMDiX358oUxKysLHMbv3r1jAYk9evRo2n8oAOoJB4ldv36dGcPAa9euNf779+//hw8fPh88eNALJPb371/GmpoacKADEzxY082bN9NBhgEt/nj06FETkNi5c+eY4LGemJgIN/zQoUNu69evV4NaxIQcNFZWVoww9syZM0MmTJhgC81ZcHFPT08Ur8MNeP78OTOy6/fs2cMEYru7u3NYWFhIQpWxOjk5iYHEv379irB81apVcDbQ20ynT58G2/jt2zew2N27d+EuEBUVFZ40aRITzCIdHR1QSmCBJSWUhA2jkXPA/fv3wTYDw1QfmLjn9vb2gpINw6JFi+CRAAy/vlOnTgViGIoOgIaADVu+fLkxMJzAefDZs2c3gEkIXlgAS56NsBgHhn8s3ny9fft2MB0UFMQOdGk7MNm8AgZJMrJLTp486QTM53eB2XM1sCQSJ1hYrFy5Es4GukwYxtbU1IRHWEREBD+S9xkBv6xm4ZI7NxcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;parseLet&quot;
        title=&quot;&quot;
        src=&quot;/static/ebf402bbe50f54bc85cfda5122c0d625/115c7/parseLet.png&quot;
        srcset=&quot;/static/ebf402bbe50f54bc85cfda5122c0d625/aa027/parseLet.png 175w,
/static/ebf402bbe50f54bc85cfda5122c0d625/e4a2b/parseLet.png 350w,
/static/ebf402bbe50f54bc85cfda5122c0d625/115c7/parseLet.png 483w&quot;
        sizes=&quot;(max-width: 483px) 100vw, 483px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è§£æï¼ˆparsing)åï¼Œå¾—åˆ°çš„æ˜¯è¿™æ ·ä¸€æ£µæ ‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦å¦‚ä½•å®ç°èµ‹å€¼(Assign)æ“ä½œå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Environmentå®ç°ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªmapå“ˆå¸Œè¡¨å°±å¯ä»¥äº†&lt;/p&gt;
&lt;p&gt;æŠŠ3 + 4è®¡ç®—çš„ç»“æœæ”¾åˆ°aé‡Œé¢å°±è¡Œäº†ï¼Œevalå‡½æ•°é‡Œé¢å¯ä»¥è¿™æ ·å†™ï¼š&lt;/p&gt;
&lt;!-- HTML generated using hilite.me --&gt;
&lt;div style=&quot;background: #ffffff; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;&quot;&gt;
&lt;pre style=&quot;margin: 0; line-height: 125%;&quot;&gt;		&lt;span style=&quot;color: #008800; font-weight: bold;&quot;&gt;else&lt;/span&gt; &lt;span style=&quot;color: #0066bb; font-weight: bold;&quot;&gt;if&lt;/span&gt; (root&lt;span style=&quot;color: #333333;&quot;&gt;-&amp;gt;&lt;/span&gt;asAssignment())
		{
			&lt;span style=&quot;color: #008800; font-weight: bold;&quot;&gt;auto&lt;/span&gt; _node &lt;span style=&quot;color: #333333;&quot;&gt;=&lt;/span&gt; root&lt;span style=&quot;color: #333333;&quot;&gt;-&amp;gt;&lt;/span&gt;asAssignment();
			env.setValue(_node&lt;span style=&quot;color: #333333;&quot;&gt;-&amp;gt;&lt;/span&gt;Identifier(), _node&lt;span style=&quot;color: #333333;&quot;&gt;-&amp;gt;&lt;/span&gt;Expression());
			&lt;span style=&quot;color: #008800; font-weight: bold;&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;color: #0000dd; font-weight: bold;&quot;&gt;0&lt;/span&gt;;
		
&lt;/pre&gt;
&lt;/div&gt;
&amp;nbsp;
&lt;p&gt;è¿™é‡Œçš„envé‡Œé¢å…¶å®æ˜¯ä¸€ä¸ªMapè€Œå·²ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œé™„ä¸Šè¿™ä¸ªç¨‹åºçš„æºç ï¼š&lt;a href=&quot;https://github.com/vincentdchan/CalculatorParser&quot;&gt;https://github.com/vincentdchan/CalculatorParser&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ç¼–è¯‘åŸç†å­¦ä¹ ç¬”è®° 1ï¼šè§£ææ•°å­¦è¡¨è¾¾å¼]]></title><link>https://diverse.space/2016/07/parse-math-expression</link><guid isPermaLink="false">https://diverse.space/2016/07/parse-math-expression</guid><pubDate>Tue, 12 Jul 2016 22:50:00 GMT</pubDate><content:encoded>&lt;p&gt;è¯´åˆ°ç¼–è¯‘åŸç†ï¼Œæ˜¯è®¡ç®—æœºç§‘å­¦é‡Œé¢å¾ˆé‡è¦çš„ä¸€ä¸ªå­¦ç§‘ï¼Œä½ å¯ä»¥è¯´ç¼–è¯‘åŸç†æ— å¤„ä¸åœ¨ã€‚ä½†æ˜¯ä¸€èˆ¬äººå¾ˆå°‘å¯ä»¥æ¥è§¦åˆ°è¿™æ ·çš„ç†è®ºã€‚ç¼–è¯‘åŸç†åˆ†å‰ç«¯å’Œåç«¯ï¼Œå‰ç«¯åŒ…æ‹¬æ–‡æœ¬è§£æå’Œç±»å‹æ£€æŸ¥ï¼Œåç«¯åŒ…æ‹¬ä¼˜åŒ–å’Œä»£ç ç”Ÿæˆç­‰ç­‰ã€‚è¿™ç¯‡æ—¥å¿—é‡Œæˆ‘ä¸»è¦è®¨è®ºæ–‡æœ¬è§£æä¸­ä¸€ä¸ªæœ€ä¸ºç®€å•çš„éƒ¨åˆ†ï¼šæ•°å­¦è¡¨è¾¾å¼ã€‚&lt;/p&gt;
&lt;p&gt;æ•°å­¦è¡¨è¾¾å¼ï¼š &lt;code&gt;1 + 1 * 3 * 3 + 4 / 4 * 5&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¦æ±‚å‡ºè¿™ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œä¸ç¦è®©æˆ‘æƒ³èµ·äº†å½“æ—¶å­¦ä¹ æ•°æ®ç»“æ„æ—¶å€™çš„ä¹ é¢˜ï¼Œè¿™æ ·çš„è¡¨è¾¾å¼ç”¨æ ˆæ¥è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆè¦åˆ—å‡ºä¸€ä¸ªè¡¨ï¼ŒåŒ…æ‹¬å„ç§ç®—æœ¯ç¬¦çš„ä¼˜å…ˆçº§&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;center&quot;&gt;ç¬¦å·&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;ä¼˜å…ˆçº§&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;+&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;-&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;*&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;center&quot;&gt;/&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ ˆï¼Œä¸€ä¸ªæ“ä½œç¬¦çš„æ ˆåä¸º&lt;code&gt;OP_STACK&lt;/code&gt; ä¸€ä¸ªæ•°å­—çš„æ ˆï¼Œåä¸º&lt;code&gt;NUM_STACK&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä»¬çš„æ“ä½œç¬¦éƒ½æ˜¯è€³ç›®æ“ä½œç¬¦ï¼Œå°±æ˜¯æ“ä½œç¬¦å·¦å³éƒ½ä¸ºå€¼ï¼Œæ¯”å¦‚è¯´ &lt;code&gt;1 * 1&lt;/code&gt;é‡Œé¢ &lt;code&gt;1*&lt;/code&gt; æˆ–è€… &lt;code&gt;*1&lt;/code&gt; éƒ½æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä¸€ä¸ªç¬¦å·è¿™æ ·é—´éš”è¯»å…¥çš„ï¼Œè¿™æ ·å°±å¥½åŠäº†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æŠŠç¬¬ä¸€ä¸ªæ•°å­—å…¥&lt;code&gt;NUM_STACK&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;è¿™æ—¶ï¼Œè¯»å…¥(SHIFT)çš„æ˜¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œå¦‚æœ&lt;code&gt;OP_STACK&lt;/code&gt;é¡¶ä¸ºç©ºï¼Œåˆ™å…¥æ ˆ&lt;code&gt;OP_STACK&lt;/code&gt;ï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™å’Œ&lt;code&gt;OP_STACK&lt;/code&gt;æ ˆé¡¶æ¯”è¾ƒï¼Œå¦‚æœæ¯”&lt;code&gt;OP_STACK&lt;/code&gt;æ ˆé¡¶ä¼˜å…ˆçº§é«˜ï¼Œåˆ™å…¥æ ˆ&lt;code&gt;OP_STACK&lt;/code&gt;ï¼Œå¦åˆ™çš„æ‰§è¡ŒREDUCEæ“ä½œï¼Œ&lt;code&gt;OP_STACK&lt;/code&gt;æ ˆé¡¶æ“ä½œç¬¦å‡ºæ ˆï¼Œ&lt;code&gt;NUM_STACK&lt;/code&gt;å‡ºæ ˆä¸¤ä¸ªæ•°å­—ï¼Œç„¶åè¿ç®—ç»“æœï¼Œå†å°†ç»“æœå…¥æ ˆ&lt;code&gt;NUM_STACK&lt;/code&gt;ï¼Œå¾ªç¯æ“ä½œ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;right&quot;&gt;è¡¨è¾¾å¼&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;&lt;code&gt;NUM_STACK&lt;/code&gt;&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;&lt;code&gt;OP_STACK&lt;/code&gt;&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;å¯¹æ¯”ç»“æœ&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;å¯¹åº”çš„æ“ä½œ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code&gt;1+1*3*3+4&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;NUL&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;NUL&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;SHIFT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code&gt;*3*3+4/4*5&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1 1&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;+&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;SHIFT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code&gt;*3+4/4*5&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1 1 3&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;+ *&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;=&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;REDUCE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code&gt;*3+4/4*5&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1 3&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;+&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;SHIFT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code&gt;+4/4*5&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1 3 3&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;+ *&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;=&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;REDUCE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code&gt;+4/4*5&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1 9&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;+&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;=&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;REDUCE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code&gt;+4/4*5&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;10&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;NUL&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;SHIFT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code&gt;/4*5&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;10 4&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;+&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;SHIFT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code&gt;*5&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;10 4 4&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;+ /&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&gt;=&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;REDUCE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code&gt;*5&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;10 1&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;+&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;SHIFT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;NUL&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;10 1 5&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;+ *&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;REDUCE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;NUL&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;10 5&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;+&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;REDUCE&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align=&quot;right&quot;&gt;NUL&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;15&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;NUL&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è¿™æ ·é©¬ä¸Šæˆ‘ä»¬å°±ç®—å‡ºç»“æœäº†ï¼Œç„¶è€Œç¼–è¯‘æœ‰æ—¶å¹¶ä¸è¦æ±‚æˆ‘ä»¬é©¬ä¸Šç®—å‡ºç»“æœï¼Œæœ‰æ—¶åªéœ€è¦æˆ‘ä»¬ä¿å­˜è§£æçš„ç»“æœï¼Œä»¥ä¾¿ä»¥åè¿è¡Œï¼Œæˆ–è€…ç”Ÿæˆä»£ç ç­‰ç­‰æ“ä½œï¼Œè¯·çœ‹ä¸‹é¢çš„è¡¨è¾¾å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;a + b * c&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶æˆ‘ä»¬æ²¡åŠæ³•é©¬ä¸Šç®—å‡ºç»“æœï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå˜æˆä¸€æ£µæ ‘&lt;/p&gt;
&lt;p&gt;&lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/96cc5fce883cef1b318cfd3540f12ffd/7703e/parse-tree.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 346px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 74.85549132947978%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACcklEQVQ4y2NgQAOFhYUM////B7O3bNnCePHiRaa1a9cygvi3b99mcHFxYSAJwAwDamZEFj948CCYv2vXLgaSwdOnT8Gay8vLRY4ePWqXlJTED+Lv3r2bkWhDDA0NwfSqVavAmurr62WfP3/+9Pv37/8fPXp0LSYmRggkPnPmTLB8YGAgdoOMjIxA3gGzS0pKGE6cOMECYvf09Ig+fvz47ps3b/7fu3fvbGNjIy9I/P79+yzh4eFg9UuXLsU0sL+/H0zn5eWhiIuJiQlbWlpqTZs2zRVoqTpQiAVZPjg4GLd3m5qa4GxgoMd0dnaGApmsyGoWL14cd+bMmc1nz57Nhhk+Z84cTMNqa2thTE6ghi3AWP7/5cuX/zt27CiBxjoozPhev3799j8ULFmyxB4kt337diZYsIEwAzQm4UkF6Dqz48ePrz958uSEBQsWyIDETp06xQyigeJp586du3bkyJGZWVlZXLAIbGtrY4Q5DBiRBNMk2LDk5GSQAeJAzAHyiZKSkoy7u7soTN3Lly+Z4+PjIZzc3Fy4C/ft28cE8iIwUTPDFANdowakJJAtamhoAIUhGxDLAZOTHEw8OzsbwnBwcGDYs2cPmA2MVbAXEhMTxa5cuTLn7t27v+7cubMbKK4DTdxgy9atW2cBlDsLzATfgBHVpa+vz4PVmxMnTgQbGBoaKnb16tUVQE3/b968eQIoDk75QEvABi5cuNAJKHcNaOAfYNhOERcX58EZdsBEDM9ivb29yjD23r17weK/fv2CyTMBI0MeJg/MopiGTZ48GUwXFRUxAsOTCVZgAHMFmA1MPgxQrzMhRR6Th4cHmA0AFSMldi3KetsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;&lt;/span&gt;
    &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;&quot;
        alt=&quot;parse tree&quot;
        title=&quot;&quot;
        src=&quot;/static/96cc5fce883cef1b318cfd3540f12ffd/7703e/parse-tree.png&quot;
        srcset=&quot;/static/96cc5fce883cef1b318cfd3540f12ffd/45c13/parse-tree.png 175w,
/static/96cc5fce883cef1b318cfd3540f12ffd/7703e/parse-tree.png 346w&quot;
        sizes=&quot;(max-width: 346px) 100vw, 346px&quot;
      /&gt;
  &lt;/span&gt;
  &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶è¿™æ ·å°±å®¹æ˜“å¤šäº†ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦è¯´çš„è§£æ(parsing)ï¼Œå¦‚ä½•è§£æå‘¢ï¼Ÿæ–¹æ³•å…¶å®å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡è¦åšä¸€ç‚¹ç‚¹æ”¹åŠ¨ï¼Œæˆ‘ä»¬çŸ¥é“ä¹˜æ³•ä¼˜å…ˆçº§æ¯”è¾ƒé«˜ï¼Œå½“æˆ‘ä»¬è®¡ç®—b * cçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯çœŸçš„ç›¸ä¹˜ï¼Œæˆ‘ä»¬åªæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ç»“ç‚¹ï¼ŒæŠŠbå’Œcä½œä¸ºå­èŠ‚ç‚¹ï¼Œç„¶åæŠŠè¿™ä¸ªæ–°ç»“ç‚¹å…¥æ ˆï¼Œå°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰äº†è¿™ç§‘è¯­æ³•æ ‘ä¹‹åï¼Œå½“æˆ‘ä»¬çŸ¥é“a b cçš„å€¼ä¹‹åï¼Œå°±å¯ä»¥é€’å½’ç®—å‡ºç»“æœäº†ï¼Œæˆ‘ä»¬è¦è®¡ç®—æ ¹èŠ‚ç‚¹çš„ç»“æœï¼Œå°±è¦é¦–å…ˆè®¡ç®—å­èŠ‚ç‚¹çš„ç»“æœï¼Œæœ€åå›æº¯å¯å¾—ç­”æ¡ˆã€‚å½“ç„¶ï¼Œä»å¦ä¸€æ–¹é¢ï¼Œä½ å¯ä»¥é€šè¿‡è¿™æ£µæ ‘ç”Ÿæˆä¸­é—´ä»£ç ï¼Œæˆ–è€…æœºå™¨ç ï¼Œè¿™æ ·å°±ç¼–è¯‘å‡ºçœŸæ­£çš„ç¨‹åºäº†ã€‚&lt;/p&gt;</content:encoded></item></channel></rss>